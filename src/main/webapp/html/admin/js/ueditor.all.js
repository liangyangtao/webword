(function(){function Aa(h,f,c){var a;f=f.toLowerCase();return(a=h.__allListeners||c&&(h.__allListeners={}))&&(a[f]||c&&(a[f]=[]))}function ra(h,f,c,a,b,g){a=a&&h[f];var l;for(!a&&(a=h[c]);!a&&(l=(l||h).parentNode);){if(l.tagName=="BODY"||g&&!g(l))return null;a=l[c]}if(a&&b&&!b(a))return ra(a,f,c,false,b);return a}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var B=window.baidu||{};window.baidu=B;window.UE=B.editor=window.UE||{};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE._customizeUI={};
UE.version="1.4.3";var ea=UE.dom={},y=UE.browser=function(){var h=navigator.userAgent.toLowerCase(),f=window.opera,c={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(h),opera:!!f&&f.version,webkit:h.indexOf(" applewebkit/")>-1,mac:h.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"};c.gecko=navigator.product=="Gecko"&&!c.webkit&&!c.opera&&!c.ie;var a=0;if(c.ie){a=h.match(/(?:msie\s([\w.]+))/);var b=h.match(/(?:trident.*rv:([\w.]+))/);a=a&&b&&a[1]&&b[1]?Math.max(a[1]*1,b[1]*1):a&&a[1]?a[1]*
1:b&&b[1]?b[1]*1:0;c.ie11Compat=document.documentMode==11;c.ie9Compat=document.documentMode==9;c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode==8;c.ie7Compat=a==7&&!document.documentMode||document.documentMode==7;c.ie6Compat=a<7||c.quirks;c.ie9above=a>8;c.ie9below=a<9;c.ie11above=a>10;c.ie11below=a<11}if(c.gecko)if(b=h.match(/rv:([\d\.]+)/)){b=b[1].split(".");a=b[0]*1E4+(b[1]||0)*100+(b[2]||0)*1}if(/chrome\/(\d+\.\d)/i.test(h))c.chrome=+RegExp.$1;if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(h)&&
!/chrome/i.test(h))c.safari=+(RegExp.$1||RegExp.$2);if(c.opera)a=parseFloat(f.version());if(c.webkit)a=parseFloat(h.match(/ applewebkit\/(\d+)/)[1]);c.version=a;c.isCompatible=!c.mobile&&(c.ie&&a>=6||c.gecko&&a>=10801||c.opera&&a>=9.5||c.air&&a>=1||c.webkit&&a>=522||false);return c}(),fa=y.ie,Oa=y.opera,v=UE.utils={each:function(h,f,c){if(h!=null)if(h.length===+h.length)for(var a=0,b=h.length;a<b;a++){if(f.call(c,h[a],a,h)===false)return false}else for(a in h)if(h.hasOwnProperty(a))if(f.call(c,h[a],
a,h)===false)return false},makeInstance:function(h){var f=new Function;f.prototype=h;h=new f;f.prototype=null;return h},extend:function(h,f,c){if(f)for(var a in f)if(!c||!h.hasOwnProperty(a))h[a]=f[a];return h},extend2:function(h){for(var f=arguments,c=1;c<f.length;c++){var a=f[c];for(var b in a)h.hasOwnProperty(b)||(h[b]=a[b])}return h},inherits:function(h,f){var c=h.prototype;f=v.makeInstance(f.prototype);v.extend(f,c,true);h.prototype=f;return f.constructor=h},bind:function(h,f){return function(){return h.apply(f,
arguments)}},defer:function(h,f,c){var a;return function(){c&&clearTimeout(a);a=setTimeout(h,f)}},indexOf:function(h,f,c){var a=-1;c=this.isNumber(c)?c:0;this.each(h,function(b,g){if(g>=c&&b===f){a=g;return false}});return a},removeItem:function(h,f){for(var c=0,a=h.length;c<a;c++)if(h[c]===f){h.splice(c,1);c--}},trim:function(h){return h.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(h){if(!h)return{};h=v.isArray(h)?h:h.split(",");for(var f=0,c,a={};c=h[f++];)a[c.toUpperCase()]=a[c]=
1;return a},unhtml:function(h,f){return h?h.replace(f||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(c,a){return a?c:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[c]}):""},html:function(h){return h?h.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(f){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[f]}):""},cssStyleToDomStyle:function(){var h=document.createElement("div").style,f={"float":h.cssFloat!=undefined?"cssFloat":h.styleFloat!=undefined?
"styleFloat":"float"};return function(c){return f[c]||(f[c]=c.toLowerCase().replace(/-./g,function(a){return a.charAt(1).toUpperCase()}))}}(),loadFile:function(){function h(c,a){try{for(var b=0,g;g=f[b++];)if(g.doc===c&&g.url==(a.src||a.href))return g}catch(l){return null}}var f=[];return function(c,a,b){var g=h(c,a);if(g)if(g.ready)b&&b();else g.funs.push(b);else{f.push({doc:c,url:a.src||a.href,funs:[b]});if(c.body){if(!(a.id&&c.getElementById(a.id))){var l=c.createElement(a.tag);delete a.tag;for(e in a)l.setAttribute(e,
a[e]);l.onload=l.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){g=h(c,a);if(g.funs.length>0){g.ready=1;for(var d;d=g.funs.pop();)d()}l.onload=l.onreadystatechange=null}};l.onerror=function(){throw Error("The load "+(a.href||a.src)+" fails,check the url settings of file ueditor.config.js ");};c.getElementsByTagName("head")[0].appendChild(l)}}else{b=[];for(var e in a)e!="tag"&&b.push(e+'="'+a[e]+'"');c.write("<"+a.tag+" "+b.join(" ")+" ></"+a.tag+">")}}}}(),
isEmptyObject:function(h){if(h==null)return true;if(this.isArray(h)||this.isString(h))return h.length===0;for(var f in h)if(h.hasOwnProperty(f))return false;return true},fixColor:function(h,f){if(/color/i.test(h)&&/rgba?/.test(f)){h=f.split(",");if(h.length>3)return"";f="#";for(var c=0,a;a=h[c++];){a=parseInt(a.replace(/[^\d]/gi,""),10).toString(16);f+=a.length==1?"0"+a:a}f=f.toUpperCase()}return f},optCss:function(h){function f(b,g){if(!b)return"";var l=b.top,e=b.bottom,d=b.left,k=b.right,j="";if(!l||
!d||!e||!k)for(var n in b)j+=";"+g+"-"+n+":"+b[n]+";";else j+=";"+g+":"+(l==e&&e==d&&d==k?l:l==e&&d==k?l+" "+d:d==k?l+" "+d+" "+e:l+" "+k+" "+e+" "+d)+";";return j}var c,a;h=h.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(b,g,l,e){if(e.split(" ").length==1)switch(g){case "padding":!c&&(c={});c[l]=e;return"";case "margin":!a&&(a={});a[l]=e;return"";case "border":return e=="initial"?"":b}return b});h+=f(c,"padding")+f(a,"margin");return h.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,
";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(b,g){return g?g+";;":";"})},clone:function(h,f){var c;f=f||{};for(var a in h)if(h.hasOwnProperty(a)){c=h[a];if(typeof c=="object"){f[a]=v.isArray(c)?[]:{};v.clone(h[a],f[a])}else f[a]=c}return f},transUnitToPx:function(h){if(!/(pt|cm)/.test(h))return h;var f;h.replace(/([\d.]+)(\w+)/,function(c,a,b){h=a;f=b});switch(f){case "cm":h=parseFloat(h)*25;break;case "pt":h=Math.round(parseFloat(h)*96/72)}return h+(h?"px":"")},domReady:function(){function h(c){for(c.isReady=
true;c=f.pop();c());}var f=[];return function(c,a){a=a||window;var b=a.document;c&&f.push(c);if(b.readyState==="complete")h(b);else{b.isReady&&h(b);if(y.ie&&y.version!=11){(function(){if(!b.isReady){try{b.documentElement.doScroll("left")}catch(g){setTimeout(arguments.callee,0);return}h(b)}})();a.attachEvent("onload",function(){h(b)})}else{b.addEventListener("DOMContentLoaded",function(){b.removeEventListener("DOMContentLoaded",arguments.callee,false);h(b)},false);a.addEventListener("load",function(){h(b)},
false)}}}}(),cssRule:y.ie&&y.version!=11?function(h,f,c){var a,b;if(f===undefined||f&&f.nodeType&&f.nodeType==9){c=f&&f.nodeType&&f.nodeType==9?f:c||document;a=c.indexList||(c.indexList={});b=a[h];if(b!==undefined)return c.styleSheets[b].cssText}else{c=c||document;a=c.indexList||(c.indexList={});b=a[h];if(f===""){if(b!==undefined){c.styleSheets[b].cssText="";delete a[h];return true}return false}if(b!==undefined)sheetStyle=c.styleSheets[b];else{sheetStyle=c.createStyleSheet("",b=c.styleSheets.length);
a[h]=b}sheetStyle.cssText=f}}:function(h,f,c){var a;if(f===undefined||f&&f.nodeType&&f.nodeType==9){c=f&&f.nodeType&&f.nodeType==9?f:c||document;return(a=c.getElementById(h))?a.innerHTML:undefined}c=c||document;a=c.getElementById(h);if(f===""){if(a){a.parentNode.removeChild(a);return true}return false}if(a)a.innerHTML=f;else{a=c.createElement("style");a.id=h;a.innerHTML=f;c.getElementsByTagName("head")[0].appendChild(a)}},sort:function(h,f){f=f||function(e,d){return e.localeCompare(d)};for(var c=
0,a=h.length;c<a;c++)for(var b=c,g=h.length;b<g;b++)if(f(h[c],h[b])>0){var l=h[c];h[c]=h[b];h[b]=l}return h},serializeParam:function(h){var f=[];for(var c in h)if(!(c=="method"||c=="timeout"||c=="async"))if((typeof h[c]).toLowerCase()=="function"||(typeof h[c]).toLowerCase()=="object"){if(v.isArray(h[c]))for(var a=0;a<h[c].length;a++)f.push(encodeURIComponent(c)+"[]="+encodeURIComponent(h[c][a]))}else f.push(encodeURIComponent(c)+"="+encodeURIComponent(h[c]));return f.join("&")},formatUrl:function(h){h=
h.replace(/&&/g,"&");h=h.replace(/\?&/g,"?");h=h.replace(/&$/g,"");h=h.replace(/&#/g,"#");return h=h.replace(/&+/g,"&")},isCrossDomainUrl:function(h){var f=document.createElement("a");f.href=h;if(y.ie)f.href=f.href;return!(f.protocol==location.protocol&&f.hostname==location.hostname&&(f.port==location.port||f.port=="80"&&location.port==""||f.port==""&&location.port=="80"))},clearEmptyAttrs:function(h){for(var f in h)h[f]===""&&delete h[f];return h},str2json:function(h){if(!v.isString(h))return null;
return window.JSON?JSON.parse(h):(new Function("return "+v.trim(h||"")))()},json2str:function(){if(window.JSON)return JSON.stringify;else{var h={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},f=function(g){if(/["\\\x00-\x1f]/.test(g))g=g.replace(/["\\\x00-\x1f]/g,function(l){var e=h[l];if(e)return e;e=l.charCodeAt();return"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16)});return'"'+g+'"'},c=function(g){var l=["["],e=g.length,d,k,j;for(k=0;k<e;k++){j=
g[k];switch(typeof j){case "undefined":case "function":case "unknown":break;default:d&&l.push(",");l.push(v.json2str(j));d=1}}l.push("]");return l.join("")},a=function(g){return g<10?"0"+g:g},b=function(g){return'"'+g.getFullYear()+"-"+a(g.getMonth()+1)+"-"+a(g.getDate())+"T"+a(g.getHours())+":"+a(g.getMinutes())+":"+a(g.getSeconds())+'"'};return function(g){switch(typeof g){case "undefined":return"undefined";case "number":return isFinite(g)?String(g):"null";case "string":return f(g);case "boolean":return String(g);
default:if(g===null)return"null";else if(v.isArray(g))return c(g);else if(v.isDate(g))return b(g);else{var l=["{"],e=v.json2str,d,k;for(var j in g)if(Object.prototype.hasOwnProperty.call(g,j)){k=g[j];switch(typeof k){case "undefined":case "unknown":case "function":break;default:d&&l.push(",");d=1;l.push(e(j)+":"+e(k))}}l.push("}");return l.join("")}}}}}()};v.each(["String","Function","Array","Number","RegExp","Object","Date"],function(h){UE.utils["is"+h]=function(f){return Object.prototype.toString.apply(f)==
"[object "+h+"]"}});var Ba=UE.EventBase=function(){};Ba.prototype={addListener:function(h,f){h=v.trim(h).split(/\s+/);for(var c=0,a;a=h[c++];)Aa(this,a,true).push(f)},on:function(h,f){return this.addListener(h,f)},off:function(h,f){return this.removeListener(h,f)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(h,f){h=v.trim(h).split(/\s+/);for(var c=0,a;a=h[c++];)v.removeItem(Aa(this,a)||[],f)},fireEvent:function(){var h=arguments[0];h=v.trim(h).split(" ");
for(var f=0,c;c=h[f++];){var a=Aa(this,c),b,g,l;if(a)for(l=a.length;l--;)if(a[l]){g=a[l].apply(this,arguments);if(g===true)return g;if(g!==undefined)b=g}if(g=this["on"+c.toLowerCase()])b=g.apply(this,arguments)}return b}};var I=ea.dtd=function(){function h(M){for(var L in M)M[L.toUpperCase()]=M[L];return M}var f=v.extend2,c=h({isindex:1,fieldset:1}),a=h({input:1,button:1,select:1,textarea:1,label:1}),b=f(h({a:1}),a),g=f({iframe:1},b),l=h({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,
address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),e=h({ins:1,del:1,script:1,style:1}),d=f(h({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),e),k=f(h({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),d),j=f(h({p:1}),k);a=f(h({iframe:1}),k,a);k=h({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,
font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1});var n=f(h({a:0}),a),p=h({tr:1}),q=h({"#":1}),o=f(h({param:1}),k),r=f(h({form:1}),c,g,l,j),s=h({li:1,ol:1,ul:1}),t=h({style:1,script:1}),u=h({base:1,link:1,
meta:1,title:1});t=f(u,t);var x=h({head:1,body:1}),z=h({html:1}),F=h({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),D=h({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return h({$nonBodyContent:f(z,x,u),$block:F,$inline:n,$inlineWithA:f(h({a:1}),n),$body:f(h({script:1,style:1}),F),$cdata:h({script:1,
style:1}),$empty:D,$nonChild:h({iframe:1,textarea:1}),$listItem:h({dd:1,dt:1,li:1}),$list:h({ul:1,ol:1,dl:1}),$isNotEmpty:h({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:h({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:h({p:1,div:1}),$tableContent:h({caption:1,
col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:h({pre:1,script:1,style:1,textarea:1}),html:x,head:t,style:q,script:q,body:r,base:{},link:{},meta:{},title:q,col:{},tr:h({td:1,th:1}),img:{},embed:{},colgroup:h({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:r,td:r,br:{},th:r,center:r,kbd:n,button:f(j,l),basefont:{},h5:n,h4:n,samp:n,h6:n,ol:s,h1:n,h3:n,option:q,h2:n,form:f(c,g,l,j),select:h({optgroup:1,option:1}),font:n,ins:n,menu:s,abbr:n,label:n,table:h({thead:1,
col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:n,tfoot:p,cite:n,li:r,input:{},iframe:r,strong:n,textarea:q,noframes:r,big:n,small:n,span:h({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:n,dt:n,sub:n,optgroup:h({option:1}),param:{},bdo:n,"var":n,div:r,object:o,sup:n,dd:r,strike:n,area:{},dir:s,map:f(h({area:1,form:1,p:1}),c,e,l),applet:o,dl:h({dt:1,dd:1}),del:n,isindex:{},fieldset:f(h({legend:1}),k),thead:p,ul:s,acronym:n,b:n,a:f(h({a:1}),a),blockquote:f(h({td:1,tr:1,
tbody:1,li:1}),r),caption:n,i:n,u:n,tbody:p,s:n,address:f(g,j),tt:n,legend:n,q:n,pre:f(d,b),p:f(h({a:1}),n),em:n,dfn:n})}(),Ia=fa&&y.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},Pa=v.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group",
"table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),m=ea.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:fa&&y.version=="6"?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(h,f){if(h===f)return 0;var c,
a=[h],b=[f];for(c=h;c=c.parentNode;){if(c===f)return 10;a.push(c)}for(c=f;c=c.parentNode;){if(c===h)return 20;b.push(c)}a.reverse();b.reverse();if(a[0]!==b[0])return 1;for(f=-1;f++,a[f]===b[f];);h=a[f];for(f=b[f];h=h.nextSibling;)if(h===f)return 4;return 2},getNodeIndex:function(h,f){h=h;for(var c=0;h=h.previousSibling;)if(f&&h.nodeType==3)h.nodeType!=h.nextSibling.nodeType&&c++;else c++;return c},inDoc:function(h,f){return m.getPosition(h,f)==10},findParent:function(h,f,c){if(h&&!m.isBody(h))for(h=
c?h:h.parentNode;h;){if(!f||f(h)||m.isBody(h))return f&&!f(h)&&m.isBody(h)?null:h;h=h.parentNode}return null},findParentByTagName:function(h,f,c,a){f=v.listToMap(v.isArray(f)?f:[f]);return m.findParent(h,function(b){return f[b.tagName]&&!(a&&a(b))},c)},findParents:function(h,f,c,a){for(f=f&&(c&&c(h)||!c)?[h]:[];h=m.findParent(h,c);)f.push(h);return a?f:f.reverse()},insertAfter:function(h,f){return h.nextSibling?h.parentNode.insertBefore(f,h.nextSibling):h.parentNode.appendChild(f)},remove:function(h,
f){var c=h.parentNode;if(c){if(f&&h.hasChildNodes())for(;f=h.firstChild;)c.insertBefore(f,h);c.removeChild(h)}return h},getNextDomNode:function(h,f,c,a){return ra(h,"firstChild","nextSibling",f,c,a)},getPreDomNode:function(h,f,c,a){return ra(h,"lastChild","previousSibling",f,c,a)},isBookmarkNode:function(h){return h.nodeType==1&&h.id&&/^_baidu_bookmark_/i.test(h.id)},getWindow:function(h){h=h.ownerDocument||h;return h.defaultView||h.parentWindow},getCommonAncestor:function(h,f){if(h===f)return h;
for(var c=[h],a=[f],b=h,g=-1;b=b.parentNode;){if(b===f)return b;c.push(b)}for(b=f;b=b.parentNode;){if(b===h)return b;a.push(b)}c.reverse();for(a.reverse();g++,c[g]===a[g];);return g==0?null:c[g-1]},clearEmptySibling:function(h,f,c){function a(b,g){for(var l;b&&!m.isBookmarkNode(b)&&(m.isEmptyInlineElement(b)||!(new RegExp("[^\t\n\r"+m.fillChar+"]")).test(b.nodeValue));){l=b[g];m.remove(b);b=l}}!f&&a(h.nextSibling,"nextSibling");!c&&a(h.previousSibling,"previousSibling")},split:function(h,f){var c=
h.ownerDocument;if(y.ie&&f==h.nodeValue.length){c=c.createTextNode("");return m.insertAfter(h,c)}h=h.splitText(f);if(y.ie8){c=c.createTextNode("");m.insertAfter(h,c);m.remove(c)}return h},isWhitespace:function(h){return!(new RegExp("[^ \t\n\r"+m.fillChar+"]")).test(h.nodeValue)},getXY:function(h){for(var f=0,c=0;h.offsetParent;){c+=h.offsetTop;f+=h.offsetLeft;h=h.offsetParent}return{x:f,y:c}},on:function(h,f,c){var a=v.isArray(f)?f:v.trim(f).split(/\s+/),b=a.length;if(b)for(;b--;){f=a[b];if(h.addEventListener)h.addEventListener(f,
c,false);else{if(!c._d)c._d={els:[]};var g=f+c.toString(),l=v.indexOf(c._d.els,h);if(!c._d[g]||l==-1){l==-1&&c._d.els.push(h);c._d[g]||(c._d[g]=function(e){return c.call(e.srcElement,e||window.event)});h.attachEvent("on"+f,c._d[g])}}}h=null},un:function(h,f,c){var a=v.isArray(f)?f:v.trim(f).split(/\s+/),b=a.length;if(b)for(;b--;){f=a[b];if(h.removeEventListener)h.removeEventListener(f,c,false);else{var g=f+c.toString();try{h.detachEvent("on"+f,c._d?c._d[g]:c)}catch(l){}if(c._d&&c._d[g]){f=v.indexOf(c._d.els,
h);f!=-1&&c._d.els.splice(f,1);c._d.els.length==0&&delete c._d[g]}}}},isSameElement:function(h,f){if(h.tagName!=f.tagName)return false;var c=h.attributes,a=f.attributes;if(!fa&&c.length!=a.length)return false;for(var b,g,l=0,e=0,d=0;b=c[d++];){if(b.nodeName=="style"){b.specified&&l++;if(m.isSameStyle(h,f))continue;else return false}if(fa)if(b.specified){l++;g=a.getNamedItem(b.nodeName)}else continue;else g=f.attributes[b.nodeName];if(!g.specified||b.nodeValue!=g.nodeValue)return false}if(fa){for(d=
0;g=a[d++];)g.specified&&e++;if(l!=e)return false}return true},isSameStyle:function(h,f){var c=h.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),a=f.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(y.opera){c=h.style;a=f.style;if(c.length!=a.length)return false;for(var b in c)if(!/^(\d+|csstext)$/i.test(b))if(c[b]!=a[b])return false;return true}if(!c||!a)return c==a;c=c.split(";");a=a.split(";");if(c.length!=a.length)return false;for(h=0;f=c[h++];)if(v.indexOf(a,f)==
-1)return false;return true},isBlockElm:function(h){return h.nodeType==1&&(I.$block[h.tagName]||Pa[m.getComputedStyle(h,"display")])&&!I.$nonChild[h.tagName]},isBody:function(h){return h&&h.nodeType==1&&h.tagName.toLowerCase()=="body"},breakParent:function(h,f){var c,a=h,b=h,g,l;do{a=a.parentNode;if(g){c=a.cloneNode(false);c.appendChild(g);g=c;c=a.cloneNode(false);c.appendChild(l);l=c}else{g=a.cloneNode(false);l=g.cloneNode(false)}for(;c=b.previousSibling;)g.insertBefore(c,g.firstChild);for(;c=b.nextSibling;)l.appendChild(c);
b=a}while(f!==a);c=f.parentNode;c.insertBefore(g,f);c.insertBefore(l,f);c.insertBefore(h,l);m.remove(f);return h},isEmptyInlineElement:function(h){if(h.nodeType!=1||!I.$removeEmpty[h.tagName])return 0;for(h=h.firstChild;h;){if(m.isBookmarkNode(h))return 0;if(h.nodeType==1&&!m.isEmptyInlineElement(h)||h.nodeType==3&&!m.isWhitespace(h))return 0;h=h.nextSibling}return 1},trimWhiteTextNode:function(h){function f(c){for(var a;(a=h[c])&&a.nodeType==3&&m.isWhitespace(a);)h.removeChild(a)}f("firstChild");
f("lastChild")},mergeChild:function(h,f,c){f=m.getElementsByTagName(h,h.tagName.toLowerCase());for(var a=0,b;b=f[a++];)if(!(!b.parentNode||m.isBookmarkNode(b)))if(b.tagName.toLowerCase()=="span"){if(h===b.parentNode){m.trimWhiteTextNode(h);if(h.childNodes.length==1){h.style.cssText=b.style.cssText+";"+h.style.cssText;m.remove(b,true);continue}}b.style.cssText=h.style.cssText+";"+b.style.cssText;if(c){var g=c.style;if(g){g=g.split(";");for(var l=0,e;e=g[l++];)b.style[v.cssStyleToDomStyle(e.split(":")[0])]=
e.split(":")[1]}}m.isSameStyle(b,h)&&m.remove(b,true)}else m.isSameElement(h,b)&&m.remove(b,true)},getElementsByTagName:function(h,f,c){if(c&&v.isString(c)){var a=c;c=function(k){return m.hasClass(k,a)}}f=v.trim(f).replace(/[ ]{2,}/g," ").split(" ");for(var b=[],g=0,l;l=f[g++];){l=h.getElementsByTagName(l);for(var e=0,d;d=l[e++];)if(!c||c(d))b.push(d)}return b},mergeToParent:function(h){for(var f=h.parentNode;f&&I.$removeEmpty[f.tagName];){if(f.tagName==h.tagName||f.tagName=="A"){m.trimWhiteTextNode(f);
if(f.tagName=="SPAN"&&!m.isSameStyle(f,h)||f.tagName=="A"&&h.tagName=="SPAN")if(f.childNodes.length>1||f!==h.parentNode){h.style.cssText=f.style.cssText+";"+h.style.cssText;f=f.parentNode;continue}else{f.style.cssText+=";"+h.style.cssText;if(f.tagName=="A")f.style.textDecoration="underline"}if(f.tagName!="A"){f===h.parentNode&&m.remove(h,true);break}}f=f.parentNode}},mergeSibling:function(h,f,c){function a(b,g,l){var e;if((e=l[b])&&!m.isBookmarkNode(e)&&e.nodeType==1&&m.isSameElement(l,e)){for(;e.firstChild;)g==
"firstChild"?l.insertBefore(e.lastChild,l.firstChild):l.appendChild(e.firstChild);m.remove(e)}}!f&&a("previousSibling","firstChild",h);!c&&a("nextSibling","lastChild",h)},unSelectable:fa&&y.ie9below||y.opera?function(h){h.onselectstart=function(){return false};h.onclick=h.onkeyup=h.onkeydown=function(){return false};h.unselectable="on";h.setAttribute("unselectable","on");for(var f=0,c;c=h.all[f++];)switch(c.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:c.unselectable=
"on";h.setAttribute("unselectable","on")}}:function(h){h.style.MozUserSelect=h.style.webkitUserSelect=h.style.msUserSelect=h.style.KhtmlUserSelect="none"},removeAttributes:function(h,f){f=v.isArray(f)?f:v.trim(f).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,a;a=f[c++];){a=Ia[a]||a;switch(a){case "className":h[a]="";break;case "style":h.style.cssText="";var b=h.getAttributeNode("style");!y.ie&&b&&h.removeAttributeNode(b)}h.removeAttribute(a)}},createElement:function(h,f,c){return m.setAttributes(h.createElement(f),
c)},setAttributes:function(h,f){for(var c in f)if(f.hasOwnProperty(c)){var a=f[c];switch(c){case "class":h.className=a;break;case "style":h.style.cssText=h.style.cssText+";"+a;break;case "innerHTML":h[c]=a;break;case "value":h.value=a;break;default:h.setAttribute(Ia[c]||c,a)}}return h},getComputedStyle:function(h,f){if("width height top left".indexOf(f)>-1)return h["offset"+f.replace(/^\w/,function(b){return b.toUpperCase()})]+"px";if(h.nodeType==3)h=h.parentNode;if(y.ie&&y.version<9&&f=="font-size"&&
!h.style.fontSize&&!I.$empty[h.tagName]&&!I.$nonChild[h.tagName]){f=h.ownerDocument.createElement("span");f.style.cssText="padding:0;border:0;font-family:simsun;";f.innerHTML=".";h.appendChild(f);var c=f.offsetHeight;h.removeChild(f);f=null;return c+"px"}try{c=m.getStyle(h,f)||(window.getComputedStyle?m.getWindow(h).getComputedStyle(h,"").getPropertyValue(f):(h.currentStyle||h.style)[v.cssStyleToDomStyle(f)])}catch(a){return""}return v.transUnitToPx(v.fixColor(f,c))},removeClasses:function(h,f){f=
v.isArray(f)?f:v.trim(f).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,a,b=h.className;a=f[c++];)b=b.replace(new RegExp("\\b"+a+"\\b"),"");if(b=v.trim(b).replace(/[ ]{2,}/g," "))h.className=b;else m.removeAttributes(h,["class"])},addClass:function(h,f){if(h){f=v.trim(f).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,a,b=h.className;a=f[c++];)(new RegExp("\\b"+a+"\\b")).test(b)||(b+=" "+a);h.className=v.trim(b)}},hasClass:function(h,f){if(v.isRegExp(f))return f.test(h.className);f=v.trim(f).replace(/[ ]{2,}/g,
" ").split(" ");for(var c=0,a=h.className;h=f[c++];)if(!(new RegExp("\\b"+h+"\\b","i")).test(a))return false;return c-1==f.length},preventDefault:function(h){h.preventDefault?h.preventDefault():(h.returnValue=false)},removeStyle:function(h,f){if(y.ie){if(f=="color")f="(^|;)"+f;h.style.cssText=h.style.cssText.replace(new RegExp(f+"[^:]*:[^;]+;?","ig"),"")}else h.style.removeProperty?h.style.removeProperty(f):h.style.removeAttribute(v.cssStyleToDomStyle(f));h.style.cssText||m.removeAttributes(h,["style"])},
getStyle:function(h,f){h=h.style[v.cssStyleToDomStyle(f)];return v.fixColor(f,h)},setStyle:function(h,f,c){h.style[v.cssStyleToDomStyle(f)]=c;v.trim(h.style.cssText)||this.removeAttributes(h,"style")},setStyles:function(h,f){for(var c in f)f.hasOwnProperty(c)&&m.setStyle(h,c,f[c])},removeDirtyAttr:function(h){for(var f=0,c,a=h.getElementsByTagName("*");c=a[f++];)c.removeAttribute("_moz_dirty");h.removeAttribute("_moz_dirty")},getChildCount:function(h,f){var c=0;h=h.firstChild;for(f=f||function(){return 1};h;){f(h)&&
c++;h=h.nextSibling}return c},isEmptyNode:function(h){return!h.firstChild||m.getChildCount(h,function(f){return!m.isBr(f)&&!m.isBookmarkNode(f)&&!m.isWhitespace(f)})==0},clearSelectedArr:function(h){for(var f;f=h.pop();)m.removeAttributes(f,["class"])},scrollToView:function(h,f,c){var a=function(){var b=f.document,g=b.compatMode=="CSS1Compat";return{width:(g?b.documentElement.clientWidth:b.body.clientWidth)||0,height:(g?b.documentElement.clientHeight:b.body.clientHeight)||0}}().height;c=a*-1+c;c+=
h.offsetHeight||0;h=m.getXY(h);c+=h.y;h=function(b){if("pageXOffset"in b)return{x:b.pageXOffset||0,y:b.pageYOffset||0};else{b=b.document;return{x:b.documentElement.scrollLeft||b.body.scrollLeft||0,y:b.documentElement.scrollTop||b.body.scrollTop||0}}}(f).y;if(c>h||c<h-a)f.scrollTo(0,c+(c<0?-20:20))},isBr:function(h){return h.nodeType==1&&h.tagName=="BR"},isFillChar:function(h,f){if(h.nodeType!=3)return false;h=h.nodeValue;if(f)return(new RegExp("^"+m.fillChar)).test(h);return!h.replace(new RegExp(m.fillChar,
"g"),"").length},isStartInblock:function(h){h=h.cloneRange();var f=0,c=h.startContainer,a;if(c.nodeType==1&&c.childNodes[h.startOffset]){c=c.childNodes[h.startOffset];for(var b=c.previousSibling;b&&m.isFillChar(b);){c=b;b=b.previousSibling}}if(this.isFillChar(c,true)&&h.startOffset==1){h.setStartBefore(c);c=h.startContainer}for(;c&&m.isFillChar(c);){a=c;c=c.previousSibling}if(a){h.setStartBefore(a);c=h.startContainer}for(c.nodeType==1&&m.isEmptyNode(c)&&h.startOffset==1&&h.setStart(c,0).collapse(true);!h.startOffset;){c=
h.startContainer;if(m.isBlockElm(c)||m.isBody(c)){f=1;break}b=h.startContainer.previousSibling;var g;if(b){for(;b&&m.isFillChar(b);){g=b;b=b.previousSibling}g?h.setStartBefore(g):h.setStartBefore(h.startContainer)}else h.setStartBefore(h.startContainer)}return f&&!m.isBody(h.startContainer)?1:0},isEmptyBlock:function(h,f){if(h.nodeType!=1)return 0;f=f||new RegExp("[ \u00a0\t\r\n"+m.fillChar+"]","g");if(h[y.ie?"innerText":"textContent"].replace(f,"").length>0)return 0;for(var c in I.$isNotEmpty)if(h.getElementsByTagName(c).length)return 0;
return 1},setViewportOffset:function(h,f){var c=parseInt(h.style.left)|0,a=parseInt(h.style.top)|0,b=h.getBoundingClientRect(),g=f.left-b.left;f=f.top-b.top;if(g)h.style.left=c+g+"px";if(f)h.style.top=a+f+"px"},fillNode:function(h,f){h=y.ie?h.createTextNode(m.fillChar):h.createElement("br");f.innerHTML="";f.appendChild(h)},moveChild:function(h,f,c){for(;h.firstChild;)c&&f.firstChild?f.insertBefore(h.lastChild,f.firstChild):f.appendChild(h.firstChild)},hasNoAttributes:function(h){return y.ie?/^<\w+\s*?>/.test(h.outerHTML):
h.attributes.length==0},isCustomeNode:function(h){return h.nodeType==1&&h.getAttribute("_ue_custom_node_")},isTagNode:function(h,f){return h.nodeType==1&&(new RegExp("\\b"+h.tagName+"\\b","i")).test(f)},filterNodeList:function(h,f,c){var a=[];if(!v.isFunction(f)){var b=f;f=function(g){return v.indexOf(v.isArray(b)?b:b.split(" "),g.tagName.toLowerCase())!=-1}}v.each(h,function(g){f(g)&&a.push(g)});return a.length==0?null:a.length==1||!c?a[0]:a},isInNodeEndBoundary:function(h,f){var c=h.startContainer;
if(c.nodeType==3&&h.startOffset!=c.nodeValue.length)return 0;if(c.nodeType==1&&h.startOffset!=c.childNodes.length)return 0;for(;c!==f;){if(c.nextSibling)return 0;c=c.parentNode}return 1},isBoundaryNode:function(h,f){for(var c;!m.isBody(h);){c=h;h=h.parentNode;if(c!==h[f])return false}return true},fillHtml:y.ie11below?"&nbsp;":"<br/>"},oa=new RegExp(m.fillChar,"g");(function(){function h(j){j.collapsed=j.startContainer&&j.endContainer&&j.startContainer===j.endContainer&&j.startOffset==j.endOffset}
function f(j){return!j.collapsed&&j.startContainer.nodeType==1&&j.startContainer===j.endContainer&&j.endOffset-j.startOffset==1}function c(j,n,p,q){if(n.nodeType==1&&(I.$empty[n.tagName]||I.$nonChild[n.tagName])){p=m.getNodeIndex(n)+(j?0:1);n=n.parentNode}if(j){q.startContainer=n;q.startOffset=p;q.endContainer||q.collapse(true)}else{q.endContainer=n;q.endOffset=p;q.startContainer||q.collapse(false)}h(q);return q}function a(j,n){var p=j.startContainer,q=j.endContainer,o=j.startOffset,r=j.endOffset,
s=j.document,t=s.createDocumentFragment(),u,x;if(p.nodeType==1)p=p.childNodes[o]||(u=p.appendChild(s.createTextNode("")));if(q.nodeType==1)q=q.childNodes[r]||(x=q.appendChild(s.createTextNode("")));if(p===q&&p.nodeType==3){t.appendChild(s.createTextNode(p.substringData(o,r-o)));if(n){p.deleteData(o,r-o);j.collapse(true)}return t}for(var z,F,D=t,M=m.findParents(p,true),L=m.findParents(q,true),Q=0;M[Q]==L[Q];)Q++;for(var S=Q,R;R=M[S];S++){z=R.nextSibling;if(R==p){if(!u)if(j.startContainer.nodeType==
3){D.appendChild(s.createTextNode(p.nodeValue.slice(o)));n&&p.deleteData(o,p.nodeValue.length-o)}else D.appendChild(!n?p.cloneNode(true):p)}else{F=R.cloneNode(false);D.appendChild(F)}for(;z;){if(z===q||z===L[S])break;R=z.nextSibling;D.appendChild(!n?z.cloneNode(true):z);z=R}D=F}D=t;if(!M[Q]){D.appendChild(M[Q-1].cloneNode(false));D=D.firstChild}for(S=Q;o=L[S];S++){z=o.previousSibling;if(o==q){if(!x&&j.endContainer.nodeType==3){D.appendChild(s.createTextNode(q.substringData(0,r)));n&&q.deleteData(0,
r)}}else{F=o.cloneNode(false);D.appendChild(F)}if(S!=Q||!M[Q])for(;z;){if(z===p)break;o=z.previousSibling;D.insertBefore(!n?z.cloneNode(true):z,D.firstChild);z=o}D=F}if(n)j.setStartBefore(!L[Q]?L[Q-1]:!M[Q]?M[Q-1]:L[Q]).collapse(true);u&&m.remove(u);x&&m.remove(x);return t}function b(j,n){try{if(d&&m.inDoc(d,j))if(d.nodeValue.replace(oa,"").length)d.nodeValue=d.nodeValue.replace(oa,"");else{var p=d.parentNode;for(m.remove(d);p&&m.isEmptyInlineElement(p)&&(y.safari?!(m.getPosition(p,n)&m.POSITION_CONTAINS):
!p.contains(n));){d=p.parentNode;m.remove(p);p=d}}}catch(q){}}function g(j,n){var p;for(j=j[n];j&&m.isFillChar(j);){p=j[n];m.remove(j);j=p}}var l=0,e=m.fillChar,d,k=ea.Range=function(j){this.startContainer=this.startOffset=this.endContainer=this.endOffset=null;this.document=j;this.collapsed=true};k.prototype={cloneContents:function(){return this.collapsed?null:a(this,0)},deleteContents:function(){var j;this.collapsed||a(this,1);if(y.webkit){j=this.startContainer;if(j.nodeType==3&&!j.nodeValue.length){this.setStartBefore(j).collapse(true);
m.remove(j)}}return this},extractContents:function(){return this.collapsed?null:a(this,2)},setStart:function(j,n){return c(true,j,n,this)},setEnd:function(j,n){return c(false,j,n,this)},setStartAfter:function(j){return this.setStart(j.parentNode,m.getNodeIndex(j)+1)},setStartBefore:function(j){return this.setStart(j.parentNode,m.getNodeIndex(j))},setEndAfter:function(j){return this.setEnd(j.parentNode,m.getNodeIndex(j)+1)},setEndBefore:function(j){return this.setEnd(j.parentNode,m.getNodeIndex(j))},
setStartAtFirst:function(j){return this.setStart(j,0)},setStartAtLast:function(j){return this.setStart(j,j.nodeType==3?j.nodeValue.length:j.childNodes.length)},setEndAtFirst:function(j){return this.setEnd(j,0)},setEndAtLast:function(j){return this.setEnd(j,j.nodeType==3?j.nodeValue.length:j.childNodes.length)},selectNode:function(j){return this.setStartBefore(j).setEndAfter(j)},selectNodeContents:function(j){return this.setStart(j,0).setEndAtLast(j)},cloneRange:function(){return(new k(this.document)).setStart(this.startContainer,
this.startOffset).setEnd(this.endContainer,this.endOffset)},collapse:function(j){if(j){this.endContainer=this.startContainer;this.endOffset=this.startOffset}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset}this.collapsed=true;return this},shrinkBoundary:function(j){function n(o){return o.nodeType==1&&!m.isBookmarkNode(o)&&!I.$empty[o.tagName]&&!I.$nonChild[o.tagName]}for(var p,q=this.collapsed;this.startContainer.nodeType==1&&(p=this.startContainer.childNodes[this.startOffset])&&
n(p);)this.setStart(p,0);if(q)return this.collapse(true);if(!j)for(;this.endContainer.nodeType==1&&this.endOffset>0&&(p=this.endContainer.childNodes[this.endOffset-1])&&n(p);)this.setEnd(p,p.childNodes.length);return this},getCommonAncestor:function(j,n){var p=this.startContainer,q=this.endContainer;if(p===q){if(j&&f(this)){p=p.childNodes[this.startOffset];if(p.nodeType==1)return p}return n&&p.nodeType==3?p.parentNode:p}return m.getCommonAncestor(p,q)},trimBoundary:function(j){this.txtToElmBoundary();
var n=this.startContainer,p=this.startOffset,q=this.collapsed,o=this.endContainer;if(n.nodeType==3){if(p==0)this.setStartBefore(n);else if(p>=n.nodeValue.length)this.setStartAfter(n);else{var r=m.split(n,p);if(n===o)this.setEnd(r,this.endOffset-p);else if(n.parentNode===o)this.endOffset+=1;this.setStartBefore(r)}if(q)return this.collapse(true)}if(!j){p=this.endOffset;o=this.endContainer;if(o.nodeType==3)if(p==0)this.setEndBefore(o);else{p<o.nodeValue.length&&m.split(o,p);this.setEndAfter(o)}}return this},
txtToElmBoundary:function(j){function n(p,q){var o=p[q+"Container"],r=p[q+"Offset"];if(o.nodeType==3)if(r)r>=o.nodeValue.length&&p["set"+q.replace(/(\w)/,function(s){return s.toUpperCase()})+"After"](o);else p["set"+q.replace(/(\w)/,function(s){return s.toUpperCase()})+"Before"](o)}if(j||!this.collapsed){n(this,"start");n(this,"end")}return this},insertNode:function(j){var n=j,p=1;if(j.nodeType==11){n=j.firstChild;p=j.childNodes.length}this.trimBoundary(true);var q=this.startContainer,o=q.childNodes[this.startOffset];
o?q.insertBefore(j,o):q.appendChild(j);if(n.parentNode===this.endContainer)this.endOffset+=p;return this.setStartBefore(n)},setCursor:function(j,n){return this.collapse(!j).select(n)},createBookmark:function(j,n){var p,q=this.document.createElement("span");q.style.cssText="display:none;line-height:0px;";q.appendChild(this.document.createTextNode("\u200d"));q.id="_baidu_bookmark_start_"+(n?"":l++);if(!this.collapsed){p=q.cloneNode(true);p.id="_baidu_bookmark_end_"+(n?"":l++)}this.insertNode(q);p&&
this.collapse().insertNode(p).setEndBefore(p);this.setStartAfter(q);return{start:j?q.id:q,end:p?j?p.id:p:null,id:j}},moveToBookmark:function(j){var n=j.id?this.document.getElementById(j.start):j.start;j=j.end&&j.id?this.document.getElementById(j.end):j.end;this.setStartBefore(n);m.remove(n);if(j){this.setEndBefore(j);m.remove(j)}else this.collapse(true);return this},enlarge:function(j,n){var p=m.isBody,q,o=this.document.createTextNode("");if(j){q=this.startContainer;if(q.nodeType==1)if(q.childNodes[this.startOffset])j=
q=q.childNodes[this.startOffset];else{q.appendChild(o);j=q=o}else j=q;for(;;){if(m.isBlockElm(q)){for(q=j;(j=q.previousSibling)&&!m.isBlockElm(j);)q=j;this.setStartBefore(q);break}j=q;q=q.parentNode}q=this.endContainer;if(q.nodeType==1){(j=q.childNodes[this.endOffset])?q.insertBefore(o,j):q.appendChild(o);j=q=o}else j=q;for(;;){if(m.isBlockElm(q)){for(q=j;(j=q.nextSibling)&&!m.isBlockElm(j);)q=j;this.setEndAfter(q);break}j=q;q=q.parentNode}o.parentNode===this.endContainer&&this.endOffset--;m.remove(o)}if(!this.collapsed){for(;this.startOffset==
0;){if(n&&n(this.startContainer))break;if(p(this.startContainer))break;this.setStartBefore(this.startContainer)}for(;this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length);){if(n&&n(this.endContainer))break;if(p(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},enlargeToBlockElm:function(j){for(;!m.isBlockElm(this.startContainer);)this.setStartBefore(this.startContainer);if(!j)for(;!m.isBlockElm(this.endContainer);)this.setEndAfter(this.endContainer);
return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!m.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!m.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},
applyInlineStyle:function(j,n,p){if(this.collapsed)return this;this.trimBoundary().enlarge(false,function(Q){return Q.nodeType==1&&m.isBlockElm(Q)}).adjustmentBoundary();for(var q=this.createBookmark(),o=q.end,r=function(Q){return Q.nodeType==1?Q.tagName.toLowerCase()!="br":!m.isWhitespace(Q)},s=m.getNextDomNode(q.start,false,r),t,u,x=this.cloneRange();s&&m.getPosition(s,o)&m.POSITION_PRECEDING;)if(s.nodeType==3||I[j][s.tagName]){x.setStartBefore(s);for(t=s;t&&(t.nodeType==3||I[j][t.tagName])&&t!==
o;){u=t;t=m.getNextDomNode(t,t.nodeType==1,null,function(Q){return I[j][Q.tagName]})}s=x.setEndAfter(u).extractContents();var z;if(p&&p.length>0){var F;F=z=p[0].cloneNode(false);for(var D=1,M;M=p[D++];){z.appendChild(M.cloneNode(false));z=z.firstChild}z=z}else z=x.document.createElement(j);n&&m.setAttributes(z,n);z.appendChild(s);z.tagName=="SPAN"&&n&&n.style&&v.each(z.getElementsByTagName("span"),function(Q){Q.style.cssText=Q.style.cssText+";"+n.style});x.insertNode(p?F:z);var L;if(j=="span"&&n.style&&
/text\-decoration/.test(n.style)&&(L=m.findParentByTagName(z,"a",true))){m.setAttributes(L,n);m.remove(z,true);z=L}else{m.mergeSibling(z);m.clearEmptySibling(z)}m.mergeChild(z,n);s=m.getNextDomNode(z,false,r);m.mergeToParent(z);if(t===o)break}else s=m.getNextDomNode(s,true,r);return this.moveToBookmark(q)},removeInlineStyle:function(j){if(this.collapsed)return this;j=v.isArray(j)?j:[j];this.shrinkBoundary().adjustmentBoundary();for(var n=this.startContainer,p=this.endContainer;;){if(n.nodeType==1){if(v.indexOf(j,
n.tagName.toLowerCase())>-1)break;if(n.tagName.toLowerCase()=="body"){n=null;break}}n=n.parentNode}for(;;){if(p.nodeType==1){if(v.indexOf(j,p.tagName.toLowerCase())>-1)break;if(p.tagName.toLowerCase()=="body"){p=null;break}}p=p.parentNode}var q=this.createBookmark(),o,r;if(n){r=this.cloneRange().setEndBefore(q.start).setStartBefore(n);o=r.extractContents();r.insertNode(o);m.clearEmptySibling(n,true);n.parentNode.insertBefore(q.start,n)}if(p){r=this.cloneRange().setStartAfter(q.end).setEndAfter(p);
o=r.extractContents();r.insertNode(o);m.clearEmptySibling(p,false,true);p.parentNode.insertBefore(q.end,p.nextSibling)}for(n=m.getNextDomNode(q.start,false,function(s){return s.nodeType==1});n&&n!==q.end;){p=m.getNextDomNode(n,true,function(s){return s.nodeType==1});v.indexOf(j,n.tagName.toLowerCase())>-1&&m.remove(n,true);n=p}return this.moveToBookmark(q)},getClosedNode:function(){var j;if(!this.collapsed){var n=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(f(n))if((n=n.startContainer.childNodes[n.startOffset])&&
n.nodeType==1&&(I.$empty[n.tagName]||I.$nonChild[n.tagName]))j=n}return j},select:y.ie?function(j,n){var p;this.collapsed||this.shrinkBoundary();var q=this.getClosedNode();if(q&&!n){try{p=this.document.body.createControlRange();p.addElement(q);p.select()}catch(o){}return this}n=this.createBookmark();q=n.start;p=this.document.body.createTextRange();p.moveToElementText(q);p.moveStart("character",1);if(this.collapsed){if(!j&&this.startContainer.nodeType!=3){j=this.document.createTextNode(e);var r=this.document.createElement("span");
r.appendChild(this.document.createTextNode(e));q.parentNode.insertBefore(r,q);q.parentNode.insertBefore(j,q);b(this.document,j);d=j;g(r,"previousSibling");g(q,"nextSibling");p.moveStart("character",-1);p.collapse(true)}}else{q=this.document.body.createTextRange();j=n.end;q.moveToElementText(j);p.setEndPoint("EndToEnd",q)}this.moveToBookmark(n);r&&m.remove(r);try{p.select()}catch(s){}return this}:function(j){function n(o){function r(s,t,u){if(s.nodeType==3&&s.nodeValue.length<t)o[u+"Offset"]=s.nodeValue.length}
r(o.startContainer,o.startOffset,"start");r(o.endContainer,o.endOffset,"end")}var p=m.getWindow(this.document),q=p.getSelection();y.gecko?this.document.body.focus():p.focus();if(q){q.removeAllRanges();if(this.collapsed&&!j){j=p=this.startContainer;if(p.nodeType==1)j=p.childNodes[this.startOffset];if(!(p.nodeType==3&&this.startOffset)&&(j?!j.previousSibling||j.previousSibling.nodeType!=3:!p.lastChild||p.lastChild.nodeType!=3)){j=this.document.createTextNode(e);this.insertNode(j);b(this.document,j);
g(j,"previousSibling");g(j,"nextSibling");d=j;this.setStart(j,y.webkit?1:0).collapse(true)}}p=this.document.createRange();if(this.collapsed&&y.opera&&this.startContainer.nodeType==1)if(j=this.startContainer.childNodes[this.startOffset]){for(;j&&m.isBlockElm(j);)if(j.nodeType==1&&j.childNodes[0])j=j.childNodes[0];else break;j&&this.setStartBefore(j).collapse(true)}else(j=this.startContainer.lastChild)&&m.isBr(j)&&this.setStartBefore(j).collapse(true);n(this);p.setStart(this.startContainer,this.startOffset);
p.setEnd(this.endContainer,this.endOffset);q.addRange(p)}return this},scrollToView:function(j,n){j=j?window:m.getWindow(this.document);var p=this.document.createElement("span");p.innerHTML="&nbsp;";this.cloneRange().insertNode(p);m.scrollToView(p,j,n);m.remove(p);return this},inFillChar:function(){var j=this.startContainer;if(this.collapsed&&j.nodeType==3&&j.nodeValue.replace(new RegExp("^"+m.fillChar),"").length+1==j.nodeValue.length)return true;return false},createAddress:function(j,n){function p(r){for(var s=
r?o.startContainer:o.endContainer,t=m.findParents(s,true,function(F){return!m.isBody(F)}),u=[],x=0,z;z=t[x++];)u.push(m.getNodeIndex(z,n));t=0;if(n)if(s.nodeType==3){for(s=s.previousSibling;s&&s.nodeType==3;){t+=s.nodeValue.replace(oa,"").length;s=s.previousSibling}t+=r?o.startOffset:o.endOffset}else if(s=s.childNodes[r?o.startOffset:o.endOffset])t=m.getNodeIndex(s,n);else{s=r?o.startContainer:o.endContainer;for(r=s.firstChild;r;)if(m.isFillChar(r))r=r.nextSibling;else{t++;if(r.nodeType==3)for(;r&&
r.nodeType==3;)r=r.nextSibling;else r=r.nextSibling}}else t=r?m.isFillChar(s)?0:o.startOffset:o.endOffset;if(t<0)t=0;u.push(t);return u}var q={},o=this;q.startAddress=p(true);if(!j)q.endAddress=o.collapsed?[].concat(q.startAddress):p();return q},moveToAddress:function(j,n){function p(o,r){for(var s=q.document.body,t,u,x=0,z,F=o.length;x<F;x++){z=o[x];t=s;s=s.childNodes[z];if(!s){u=z;break}}if(r)s?q.setStartBefore(s):q.setStart(t,u);else s?q.setEndBefore(s):q.setEnd(t,u)}var q=this;p(j.startAddress,
true);!n&&j.endAddress&&p(j.endAddress);return q},equals:function(j){for(var n in this)if(this.hasOwnProperty(n))if(this[n]!==j[n])return false;return true},traversal:function(j,n){if(this.collapsed)return this;for(var p=this.createBookmark(),q=p.end,o=m.getNextDomNode(p.start,false,n);o&&o!==q&&m.getPosition(o,q)&m.POSITION_PRECEDING;){var r=m.getNextDomNode(o,false,n);j(o);o=r}return this.moveToBookmark(p)}}})();(function(){function h(a,b){var g=m.getNodeIndex;a=a.duplicate();a.collapse(b);b=a.parentElement();
if(!b.hasChildNodes())return{container:b,offset:0};for(var l=b.children,e,d=a.duplicate(),k=0,j=l.length-1,n=-1;k<=j;){n=Math.floor((k+j)/2);e=l[n];d.moveToElementText(e);var p=d.compareEndPoints("StartToStart",a);if(p>0)j=n-1;else if(p<0)k=n+1;else return{container:b,offset:g(e)}}if(n==-1){d.moveToElementText(b);d.setEndPoint("StartToStart",a);a=d.text.replace(/(\r\n|\r)/g,"\n").length;l=b.childNodes;if(!a){e=l[l.length-1];return{container:e,offset:e.nodeValue.length}}for(g=l.length;a>0;)a-=l[--g].nodeValue.length;
return{container:l[g],offset:-a}}d.collapse(p>0);d.setEndPoint(p>0?"StartToStart":"EndToStart",a);a=d.text.replace(/(\r\n|\r)/g,"\n").length;if(!a)return I.$empty[e.tagName]||I.$nonChild[e.tagName]?{container:b,offset:g(e)+(p>0?0:1)}:{container:e,offset:p>0?0:e.childNodes.length};for(;a>0;)try{l=e;e=e[p>0?"previousSibling":"nextSibling"];a-=e.nodeValue.length}catch(q){return{container:b,offset:g(l)}}return{container:e,offset:p>0?-a:e.nodeValue.length+a}}function f(a,b){if(a.item)b.selectNode(a.item(0));
else{var g=h(a,true);b.setStart(g.container,g.offset);if(a.compareEndPoints("StartToEnd",a)!=0){g=h(a,false);b.setEnd(g.container,g.offset)}}return b}function c(a){var b;try{b=a.getNative().createRange()}catch(g){return null}var l=b.item?b.item(0):b.parentElement();if((l.ownerDocument||l)===a.document)return b;return null}(ea.Selection=function(a){var b=this;b.document=a;if(y.ie9below){a=m.getWindow(a).frameElement;m.on(a,"beforedeactivate",function(){b._bakIERange=b.getIERange()});m.on(a,"activate",
function(){try{!c(b)&&b._bakIERange&&b._bakIERange.select()}catch(g){}b._bakIERange=null})}a=a=null}).prototype={rangeInBody:function(a,b){a=y.ie9below||b?a.item?a.item():a.parentElement():a.startContainer;return a===this.document.body||m.inDoc(a,this.document)},getNative:function(){var a=this.document;try{return!a?null:y.ie9below?a.selection:m.getWindow(a).getSelection()}catch(b){return null}},getIERange:function(){var a=c(this);if(!a)if(this._bakIERange)return this._bakIERange;return a},cache:function(){this.clear();
this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var a=this.getStart();if(a)return m.findParents(a,true,null,true);return[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(y.ie9below){var a=c(this);return!!(a&&this.rangeInBody(a))}else return!!this.getNative().rangeCount}catch(b){return false}},
getRange:function(){function a(k){for(var j=b.document.body.firstChild,n=k.collapsed;j&&j.firstChild;){k.setStart(j,0);j=j.firstChild}k.startContainer||k.setStart(b.document.body,0);n&&k.collapse(true)}var b=this;if(b._cachedRange!=null)return this._cachedRange;var g=new B.editor.dom.Range(b.document);if(y.ie9below){var l=b.getIERange();if(l)try{f(l,g)}catch(e){a(g)}else a(g)}else{var d=b.getNative();if(d&&d.rangeCount){l=d.getRangeAt(0);d=d.getRangeAt(d.rangeCount-1);g.setStart(l.startContainer,
l.startOffset).setEnd(d.endContainer,d.endOffset);g.collapsed&&m.isBody(g.startContainer)&&!g.startOffset&&a(g)}else{if(this._bakRange&&m.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;a(g)}}return this._bakRange=g},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var a=y.ie9below?this.getIERange():this.getRange(),b,g;if(y.ie9below){if(!a)return this.document.body.firstChild;if(a.item)return a.item(0);b=a.duplicate();b.text.length>0&&b.moveStart("character",
1);b.collapse(1);b=b.parentElement();for(g=a=a.parentElement();a=a.parentNode;)if(a==b){b=g;break}}else{a.shrinkBoundary();b=a.startContainer;if(b.nodeType==1&&b.hasChildNodes())b=b.childNodes[Math.min(b.childNodes.length-1,a.startOffset)];if(b.nodeType==3)return b.parentNode}return b},getText:function(){var a;if(this.isFocus()&&(a=this.getNative())){a=y.ie9below?a.createRange():a.getRangeAt(0);return y.ie9below?a.text:a.toString()}return""},clearRange:function(){this.getNative()[y.ie9below?"empty":
"removeAllRanges"]()}}})();(function(){function h(l,e){var d;if(e.textarea)if(v.isString(e.textarea))for(var k=0,j,n=m.getElementsByTagName(l,"textarea");j=n[k++];){if(j.id=="ueditor_textarea_"+e.options.textarea){d=j;break}}else d=e.textarea;if(!d){l.appendChild(d=m.createElement(document,"textarea",{name:e.options.textarea,id:"ueditor_textarea_"+e.options.textarea,style:"display:none"}));e.textarea=d}!d.getAttribute("name")&&d.setAttribute("name",e.options.textarea);d.value=e.hasContents()?e.options.allHtmlEnabled?
e.getAllHtml():e.getContent(null,null,true):""}function f(l){for(var e in l)return e}function c(l){l.langIsReady=true;l.fireEvent("langReady")}var a=0,b,g=UE.Editor=function(l){var e=this;e.uid=a++;Ba.call(e);e.commands={};e.options=v.extend(v.clone(l||{}),UEDITOR_CONFIG,true);e.shortcutkeys={};e.inputRules=[];e.outputRules=[];e.setOpt(g.defaultOptions(e));e.loadServerConfig();if(v.isEmptyObject(UE.I18N))v.loadFile(document,{src:e.options.langPath+e.options.lang+"/"+e.options.lang+".js",tag:"script",
type:"text/javascript",defer:"defer"},function(){UE.plugin.load(e);c(e)});else{e.options.lang=f(UE.I18N);UE.plugin.load(e);c(e)}UE.instants["ueditorInstant"+e.uid]=e};g.prototype={registerCommand:function(l,e){this.commands[l]=e},ready:function(l){if(l)this.isReady?l.apply(this):this.addListener("ready",l)},setOpt:function(l,e){var d={};if(v.isString(l))d[l]=e;else d=l;v.extend(this.options,d,true)},getOpt:function(l){return this.options[l]},destroy:function(){this.fireEvent("destroy");var l=this.container.parentNode,
e=this.textarea;if(e)e.style.display="";else{e=document.createElement("textarea");l.parentNode.insertBefore(e,l)}e.style.width=this.iframe.offsetWidth+"px";e.style.height=this.iframe.offsetHeight+"px";e.value=this.getContent();e.id=this.key;l.innerHTML="";m.remove(l);l=this.key;for(var d in this)this.hasOwnProperty(d)&&delete this[d];UE.delEditor(l)},render:function(l){var e=this.options,d=function(k){return parseInt(m.getComputedStyle(l,k))};if(v.isString(l))l=document.getElementById(l);if(l){e.minFrameWidth=
e.initialFrameWidth?e.initialFrameWidth:(e.initialFrameWidth=l.offsetWidth);if(e.initialFrameHeight)e.minFrameHeight=e.initialFrameHeight;else e.initialFrameHeight=e.minFrameHeight=l.offsetHeight;l.style.width=/%$/.test(e.initialFrameWidth)?"100%":e.initialFrameWidth-d("padding-left")-d("padding-right")+"px";l.style.height=/%$/.test(e.initialFrameHeight)?"100%":e.initialFrameHeight-d("padding-top")-d("padding-bottom")+"px";l.style.zIndex=e.zIndex;d=(fa&&y.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:90%;padding-top:3px;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}</style>"+
(e.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+v.unhtml(e.iframeCssUrl)+"'/>":"")+(e.initialStyle?"<style>"+e.initialStyle+"</style>":"")+"<script type='text/javascript' src='apps/zhutree/js/treeIframe.js?time="+strTime+"'><\/script><script type='text/javascript' src='common/js/global.js?time="+strTime+"'><\/script></head><body class='view'  onload='pageload()'></body><script type='text/javascript' "+(fa?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+
this.uid+"'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);<\/script></html>";l.appendChild(m.createElement(document,"iframe",{id:"ueditor_"+this.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(e.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+d+'");document.close();}())'}));l.style.overflow="visible";
setTimeout(function(){if(/%$/.test(e.initialFrameWidth))e.minFrameWidth=e.initialFrameWidth=l.offsetWidth;if(/%$/.test(e.initialFrameHeight)){e.minFrameHeight=e.initialFrameHeight=l.offsetHeight;l.style.height=e.initialFrameHeight+"px"}})}},_setup:function(l){var e=this,d=e.options;if(fa){l.body.disabled=true;l.body.contentEditable=true;l.body.disabled=false}else l.body.contentEditable=true;l.body.spellcheck=false;e.document=l;e.window=l.defaultView||l.parentWindow;e.iframe=e.window.frameElement;
e.body=l.body;e.selection=new ea.Selection(l);var k;if(y.gecko&&(k=this.selection.getNative()))k.removeAllRanges();this._initEvents();for(var j=this.iframe.parentNode;!m.isBody(j);j=j.parentNode)if(j.tagName=="FORM"){e.form=j;e.options.autoSyncData?m.on(e.window,"blur",function(){h(j,e)}):m.on(j,"submit",function(){h(this,e)});break}if(d.initialContent)if(d.autoClearinitialContent){var n=e.execCommand;e.execCommand=function(){e.fireEvent("firstBeforeExecCommand");return n.apply(e,arguments)};this._setDefaultContent(d.initialContent)}else this.setContent(d.initialContent,
false,true);if(m.isEmptyNode(e.body))e.body.innerHTML="<p>"+(y.ie?"":"<br/>")+"</p>";d.focus&&setTimeout(function(){e.focus(e.options.focusInEnd);!e.options.autoClearinitialContent&&e._selectionChange()},0);if(!e.container)e.container=this.iframe.parentNode;d.fullscreen&&e.ui&&e.ui.setFullScreen(true);try{e.document.execCommand("2D-position",false,false)}catch(p){}try{e.document.execCommand("enableInlineTableEditing",false,false)}catch(q){}try{e.document.execCommand("enableObjectResizing",false,false)}catch(o){}e._bindshortcutKeys();
e.isReady=1;e.fireEvent("ready");d.onready&&d.onready.call(e);y.ie9below||m.on(e.window,["blur","focus"],function(r){if(r.type=="blur"){e._bakRange=e.selection.getRange();try{e._bakNativeRange=e.selection.getNative().getRangeAt(0);e.selection.getNative().removeAllRanges()}catch(s){e._bakNativeRange=null}}else try{e._bakRange&&e._bakRange.select()}catch(t){}});if(y.gecko&&y.version<=10902){e.body.contentEditable=false;setTimeout(function(){e.body.contentEditable=true},100);setInterval(function(){e.body.style.height=
e.iframe.offsetHeight-20+"px"},100)}!d.isShow&&e.setHide();d.readonly&&e.setDisabled()},sync:function(l){(l=l?document.getElementById(l):m.findParent(this.iframe.parentNode,function(e){return e.tagName=="FORM"},true))&&h(l,this)},setHeight:function(l,e){if(l!==parseInt(this.iframe.parentNode.style.height))this.iframe.parentNode.style.height=l+"px";!e&&(this.options.minFrameHeight=this.options.initialFrameHeight=l);this.body.style.height=l+"px";!e&&this.trigger("setHeight")},addshortcutkey:function(l,
e){var d={};if(e)d[l]=e;else d=l;v.extend(this.shortcutkeys,d)},_bindshortcutKeys:function(){var l=this,e=this.shortcutkeys;l.addListener("keydown",function(d,k){d=k.keyCode||k.which;for(var j in e)for(var n=e[j].split(","),p=0,q;q=n[p++];){q=q.split(":");var o=q[0];q=q[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(o.toLowerCase())||/^(\d+)$/.test(o))if((RegExp.$1=="ctrl"?k.ctrlKey||k.metaKey:0)&&(RegExp.$2!=""?k[RegExp.$2.slice(1)+"Key"]:1)&&d==RegExp.$3||d==RegExp.$1){l.queryCommandState(j,q)!=-1&&l.execCommand(j,
q);m.preventDefault(k)}}})},getContent:function(l,e,d,k,j){if(l&&v.isFunction(l)){e=l;l=""}if(e?!e():!this.hasContents())return"";this.fireEvent("beforegetcontent");e=UE.htmlparser(this.body.innerHTML,k);this.filterOutputRule(e);this.fireEvent("aftergetcontent",l,e);return e.toHtml(j)},getAllHtml:function(){var l=[];this.fireEvent("getAllHtml",l);if(y.ie&&y.version>8){var e="";v.each(this.document.styleSheets,function(d){e+=d.href?'<link rel="stylesheet" type="text/css" href="'+d.href+'" />':"<style>"+
d.cssText+"</style>"});v.each(this.document.getElementsByTagName("script"),function(d){e+=d.outerHTML})}return"<html><head>"+(this.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+this.options.charset+'"/>':"")+(e||this.document.getElementsByTagName("head")[0].innerHTML)+l.join("\n")+"</head><body "+(fa&&y.version<9?'class="view"':"")+">"+this.getContent(null,null,true)+"</body></html>"},getPlainTxt:function(){var l=new RegExp(m.fillChar,"g"),e=this.body.innerHTML.replace(/[\n\r]/g,
"");e=e.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(d,k,j){return I.$block[j]?"\n":k?k:""});return e.replace(l,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){return this.body[y.ie?"innerText":"textContent"].replace(new RegExp(m.fillChar,"g"),"").replace(/\u00a0/g," ")},setContent:function(l,e,d){function k(p){return p.tagName=="DIV"&&p.getAttribute("cdata_tag")}this.fireEvent("beforesetcontent",
l);l=UE.htmlparser(l);this.filterInputRule(l);l=l.toHtml();this.body.innerHTML=(e?this.body.innerHTML:"")+l;if(this.options.enterTag=="p"){e=this.body.firstChild;if(!e||e.nodeType==1&&(I.$cdata[e.tagName]||k(e)||m.isCustomeNode(e))&&e===this.body.lastChild)this.body.innerHTML="<p>"+(y.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else for(var j=this.document.createElement("p");e;){for(;e&&(e.nodeType==3||e.nodeType==1&&I.p[e.tagName]&&!I.$cdata[e.tagName]);){l=e.nextSibling;j.appendChild(e);e=l}if(j.firstChild)if(e){e.parentNode.insertBefore(j,
e);j=this.document.createElement("p")}else{this.body.appendChild(j);break}e=e.nextSibling}}this.fireEvent("aftersetcontent");this.fireEvent("contentchange");!d&&this._selectionChange();this._bakRange=this._bakIERange=this._bakNativeRange=null;var n;if(y.gecko&&(n=this.selection.getNative()))n.removeAllRanges();this.options.autoSyncData&&this.form&&h(this.form,this)},focus:function(l){try{var e=this.selection.getRange();if(l){var d=this.body.lastChild;if(d&&d.nodeType==1&&!I.$empty[d.tagName]){m.isEmptyBlock(d)?
e.setStartAtFirst(d):e.setStartAtLast(d);e.collapse(true)}e.setCursor(true)}else{if(!e.collapsed&&m.isBody(e.startContainer)&&e.startOffset==0)(d=this.body.firstChild)&&d.nodeType==1&&!I.$empty[d.tagName]&&e.setStartAtFirst(d).collapse(true);e.select(true)}this.fireEvent("focus selectionchange")}catch(k){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var l=this.selection.getNative();if(l.empty&&y.ie){var e=document.body.createTextRange();e.moveToElementText(document.body);
e.collapse(true);e.select();l.empty()}else l.removeAllRanges()},_initEvents:function(){var l=this,e=l.document,d=l.window;l._proxyDomEvent=v.bind(l._proxyDomEvent,l);m.on(e,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],l._proxyDomEvent);m.on(d,["focus","blur"],l._proxyDomEvent);m.on(l.body,"drop",function(k){y.gecko&&k.stopPropagation&&k.stopPropagation();l.fireEvent("contentchange")});m.on(e,["mouseup","keydown"],function(k){k.type==
"keydown"&&(k.ctrlKey||k.metaKey||k.shiftKey||k.altKey)||k.button!=2&&l._selectionChange(250,k)})},_proxyDomEvent:function(l){if(this.fireEvent("before"+l.type.replace(/^on/,"").toLowerCase())===false)return false;if(this.fireEvent(l.type.replace(/^on/,""),l)===false)return false;return this.fireEvent("after"+l.type.replace(/^on/,"").toLowerCase())},_selectionChange:function(l,e){var d=this,k=false,j,n;if(y.ie&&y.version<9&&e&&e.type=="mouseup")if(!this.selection.getRange().collapsed){k=true;j=e.clientX;
n=e.clientY}clearTimeout(b);b=setTimeout(function(){if(d.selection&&d.selection.getNative()){var p;if(k&&d.selection.getNative().type=="None"){p=d.document.body.createTextRange();try{p.moveToPoint(j,n)}catch(q){p=null}}var o;if(p){o=d.selection.getIERange;d.selection.getIERange=function(){return p}}d.selection.cache();if(o)d.selection.getIERange=o;if(d.selection._cachedRange&&d.selection._cachedStartElement){d.fireEvent("beforeselectionchange");d.fireEvent("selectionchange",!!e);d.fireEvent("afterselectionchange");
d.selection.clear()}}},l||50)},_callCmdFn:function(l,e){var d=e[0].toLowerCase(),k;k=(d=this.commands[d]||UE.commands[d])&&d[l];if((!d||!k)&&l=="queryCommandState")return 0;else if(k)return k.apply(this,e)},execCommand:function(l){l=l.toLowerCase();var e,d=this.commands[l]||UE.commands[l];if(!d||!d.execCommand)return null;if(!d.notNeedUndo&&!this.__hasEnterExecCommand){this.__hasEnterExecCommand=true;if(this.queryCommandState.apply(this,arguments)!=-1){this.fireEvent("saveScene");this.fireEvent.apply(this,
["beforeexeccommand",l].concat(arguments));e=this._callCmdFn("execCommand",arguments);this.fireEvent.apply(this,["afterexeccommand",l].concat(arguments));this.fireEvent("saveScene")}this.__hasEnterExecCommand=false}else{e=this._callCmdFn("execCommand",arguments);!this.__hasEnterExecCommand&&!d.ignoreContentChange&&!this._ignoreContentChange&&this.fireEvent("contentchange")}!this.__hasEnterExecCommand&&!d.ignoreContentChange&&!this._ignoreContentChange&&this._selectionChange();return e},queryCommandState:function(){return this._callCmdFn("queryCommandState",
arguments)},queryCommandValue:function(){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(l){if(l)for(var e=0,d;d=l[e++];)if(this.document.getElementsByTagName(d).length>0)return true;if(!m.isEmptyBlock(this.body))return true;l=["div"];for(e=0;d=l[e++];){d=m.getElementsByTagName(this.document,d);for(var k=0,j;j=d[k++];)if(m.isCustomeNode(j))return true}return false},reset:function(){this.fireEvent("reset")},setEnabled:function(){var l;if(this.body.contentEditable=="false"){this.body.contentEditable=
true;l=this.selection.getRange();try{l.moveToBookmark(this.lastBk);delete this.lastBk}catch(e){l.setStartAtFirst(this.body).collapse(true)}l.select(true);if(this.bkqueryCommandState){this.queryCommandState=this.bkqueryCommandState;delete this.bkqueryCommandState}if(this.bkqueryCommandValue){this.queryCommandValue=this.bkqueryCommandValue;delete this.bkqueryCommandValue}this.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(l){var e=this;l=l?v.isArray(l)?
l:[l]:[];if(e.body.contentEditable=="true"){if(!e.lastBk)e.lastBk=e.selection.getRange().createBookmark(true);e.body.contentEditable=false;e.bkqueryCommandState=e.queryCommandState;e.bkqueryCommandValue=e.queryCommandValue;e.queryCommandState=function(d){if(v.indexOf(l,d)!=-1)return e.bkqueryCommandState.apply(e,arguments);return-1};e.queryCommandValue=function(d){if(v.indexOf(l,d)!=-1)return e.bkqueryCommandValue.apply(e,arguments);return null};e.fireEvent("selectionchange")}},disable:function(l){return this.setDisabled(l)},
_setDefaultContent:function(){function l(){var e=this;if(e.document.getElementById("initContent")){e.body.innerHTML="<p>"+(fa?"":"<br/>")+"</p>";e.removeListener("firstBeforeExecCommand focus",l);setTimeout(function(){e.focus();e._selectionChange()},0)}}return function(e){this.body.innerHTML='<p id="initContent">'+e+"</p>";this.addListener("firstBeforeExecCommand focus",l)}}(),setShow:function(){var l=this.selection.getRange();if(this.container.style.display=="none"){try{l.moveToBookmark(this.lastBk);
delete this.lastBk}catch(e){l.setStartAtFirst(this.body).collapse(true)}setTimeout(function(){l.select(true)},100);this.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){if(!this.lastBk)this.lastBk=this.selection.getRange().createBookmark(true);this.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(l){var e=UE.I18N[this.options.lang];if(!e)throw Error("not import language file");l=(l||"").split(".");for(var d=0,k;k=l[d++];){e=
e[k];if(!e)break}return e},getContentLength:function(l,e){var d=this.getContent(false,false,true).length;if(l){e=(e||[]).concat(["hr","img","iframe"]);d=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;l=0;for(var k;k=e[l++];)d+=this.document.getElementsByTagName(k).length}return d},addInputRule:function(l){this.inputRules.push(l)},filterInputRule:function(l){for(var e=0,d;d=this.inputRules[e++];)d.call(this,l)},addOutputRule:function(l){this.outputRules.push(l)},filterOutputRule:function(l){for(var e=
0,d;d=this.outputRules[e++];)d.call(this,l)},getActionUrl:function(l){l=this.getOpt(l)||l;var e=this.getOpt("imageUrl"),d=this.getOpt("serverUrl");if(!d&&e)d=e.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2");if(d){d=d+(d.indexOf("?")==-1?"?":"&")+"action="+(l||"");return v.formatUrl(d)}else return""}};v.inherits(g,Ba)})();UE.Editor.defaultOptions=function(h){h=h.options.UEDITOR_HOME_URL;return{isShow:true,initialContent:"",initialStyle:"",autoClearinitialContent:false,iframeCssUrl:h+"themes/iframe.css",
textarea:"editorValue",focus:false,focusInEnd:true,autoClearEmptyNode:true,fullscreen:false,readonly:false,zIndex:999,imagePopup:true,enterTag:"p",customDomain:false,lang:"zh-cn",langPath:h+"lang/",theme:"default",themePath:h+"themes/",allHtmlEnabled:false,scaleEnabled:false,tableNativeEditInFF:false,autoSyncData:true,fileNameFormat:"{time}{rand:6}"}};(function(){UE.Editor.prototype.loadServerConfig=function(){function h(c){console&&console.error(c)}var f=this;setTimeout(function(){try{f.options.imageUrl&&
f.setOpt("serverUrl",f.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var c=f.getActionUrl("config"),a=v.isCrossDomainUrl(c);f._serverConfigLoaded=false;c&&UE.ajax.request(c,{method:"GET",dataType:a?"jsonp":"",onsuccess:function(g){try{var l=a?g:eval("("+g.responseText+")");v.extend(f.options,l);f.fireEvent("serverConfigLoaded");f._serverConfigLoaded=true}catch(e){h(f.getLang("loadconfigFormatError"))}},onerror:function(){h(f.getLang("loadconfigHttpError"))}})}catch(b){h(f.getLang("loadconfigError"))}})};
UE.Editor.prototype.isServerConfigLoaded=function(){return this._serverConfigLoaded||false};UE.Editor.prototype.afterConfigReady=function(h){if(h&&v.isFunction(h)){var f=this,c=function(){h.apply(f,arguments);f.removeListener("serverConfigLoaded",c)};f.isServerConfigLoaded()?h.call(f,"serverConfigLoaded"):f.addListener("serverConfigLoaded",c)}}})();UE.ajax=function(){function h(e){var d=[];for(var k in e)if(!(k=="method"||k=="timeout"||k=="async"||k=="dataType"||k=="callback"))if(!(e[k]==undefined||
e[k]==null))if((typeof e[k]).toLowerCase()=="function"||(typeof e[k]).toLowerCase()=="object"){if(v.isArray(e[k]))for(var j=0;j<e[k].length;j++)d.push(encodeURIComponent(k)+"[]="+encodeURIComponent(e[k][j]))}else d.push(encodeURIComponent(k)+"="+encodeURIComponent(e[k]));return d.join("&")}function f(e,d){var k=l(),j=false,n={method:"POST",timeout:5E3,async:true,data:{},onsuccess:function(){},onerror:function(){}};if(typeof e==="object"){d=e;e=d.url}if(k&&e){var p=d?v.extend(n,d):n;d=h(p);v.isEmptyObject(p.data)||
(d+=(d?"&":"")+h(p.data));var q=setTimeout(function(){if(k.readyState!=4){j=true;k.abort();clearTimeout(q)}},p.timeout);n=p.method.toUpperCase();e=e+(e.indexOf("?")==-1?"?":"&")+(n=="POST"?"":d+"&noCache="+ +new Date);k.open(n,e,p.async);k.onreadystatechange=function(){if(k.readyState==4)!j&&k.status==200?p.onsuccess(k):p.onerror(k)};if(n=="POST"){k.setRequestHeader("Content-Type","application/x-www-form-urlencoded");k.send(d)}else k.send(null)}}function c(e,d){function k(F,D,M){F.setAttribute("type",
"text/javascript");F.setAttribute("defer","defer");M&&F.setAttribute("charset",M);F.setAttribute("src",D);document.getElementsByTagName("head")[0].appendChild(F)}function j(F){return function(){try{if(F)q.onerror&&q.onerror();else try{clearTimeout(u);n.apply(window,arguments)}catch(D){}}catch(M){q.onerror&&q.onerror.call(window,M)}finally{q.oncomplete&&q.oncomplete.apply(window,arguments);p.parentNode&&p.parentNode.removeChild(p);window[s]=null;try{delete window[s]}catch(L){}}}}var n=d.onsuccess||
function(){},p=document.createElement("SCRIPT"),q=d||{},o=q.charset,r=q.jsonp||"callback",s,t=q.timeOut||0,u,x=new RegExp("(\\?|&)"+r+"=([^&]*)"),z;if(v.isFunction(n)){s="bd__editor__"+Math.floor(Math.random()*2147483648).toString(36);window[s]=j(0)}else if(v.isString(n))s=n;else if(z=x.exec(e))s=z[2];e=e.replace(x,"$1"+r+"="+s);if(e.search(x)<0)e+=(e.indexOf("?")<0?"?":"&")+r+"="+s;r=h(d);v.isEmptyObject(d.data)||(r+=(r?"&":"")+h(d.data));if(r)e=e.replace(/\?/,"?"+r+"&");p.onerror=j(1);if(t)u=setTimeout(j(1),
t);k(p,e,o)}var a="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP");a="ActiveXObject('Msxml2.XMLHTTP')"}catch(b){try{new ActiveXObject("Microsoft.XMLHTTP");a="ActiveXObject('Microsoft.XMLHTTP')"}catch(g){}}var l=new Function("return new "+a);return{request:function(e,d){d&&d.dataType=="jsonp"?c(e,d):f(e,d)},getJSONP:function(e,d,k){c(e,{data:d,oncomplete:k})}}}();UE.filterWord=function(){function h(a){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/ig.test(a)}function f(a){return a=
a.replace(/[\d.]+\w+/g,function(b){return v.transUnitToPx(b)})}function c(a){return a.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?--\>/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(b){if(y.opera)return"";try{if(/Bitmap/i.test(b))return"";var g=b.match(/width:([ \d.]*p[tx])/i)[1],l=b.match(/height:([ \d.]*p[tx])/i)[1],e=b.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+f(g)+'" height="'+f(l)+'" src="'+e+'" />'}catch(d){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,
"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(b,g,l,e){return g=="class"&&e=="MsoListParagraph"?b:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(b,g,l){return l.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(b,g,l,e){b=[];
e=e.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(n){return v.transUnitToPx(n)}).split(/;\s*/g);l=0;for(var d;d=e[l];l++){var k,j=d.split(":");if(j.length==2){d=j[0].toLowerCase();k=j[1].toLowerCase();if(!(/^(background)\w*/.test(d)&&k.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(d)&&/^0\w+$/.test(k))){switch(d){case "mso-padding-alt":case "mso-padding-top-alt":case "mso-padding-right-alt":case "mso-padding-bottom-alt":case "mso-padding-left-alt":case "mso-margin-alt":case "mso-margin-top-alt":case "mso-margin-right-alt":case "mso-margin-bottom-alt":case "mso-margin-left-alt":case "mso-height":case "mso-width":case "mso-vertical-align-alt":/<table/.test(g)||
(b[l]=d.replace(/^mso-|-alt$/g,"")+":"+f(k));continue;case "horiz-align":b[l]="text-align:"+k;continue;case "vert-align":b[l]="vertical-align:"+k;continue;case "font-color":case "mso-foreground":b[l]="color:"+k;continue;case "mso-background":case "mso-highlight":b[l]="background:"+k;continue;case "mso-default-height":b[l]="min-height:"+f(k);continue;case "mso-default-width":b[l]="min-width:"+f(k);continue;case "mso-padding-between-alt":b[l]="border-collapse:separate;border-spacing:"+f(k);continue;
case "text-line-through":if(k=="single"||k=="double")b[l]="text-decoration:line-through";continue;case "mso-zero-height":if(k=="yes")b[l]="display:none";continue;case "margin":if(!/[1-9]/.test(k))continue}/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(d)||/text\-indent|padding|margin/.test(d)&&/\-[\d.]+/.test(k)||(b[l]=d+":"+j[1])}}}return g+(b.length?' style="'+b.join(";").replace(/;{2,}/g,
";")+'"':"")})}return function(a){return h(a)?c(a):a}}();(function(){function h(o,r,s){o.push(q);return r+(s?1:-1)}function f(o,r){for(var s=0;s<r;s++)o.push(p)}function c(o,r,s,t){switch(o.type){case "root":for(var u=0,x;x=o.children[u++];){if(s&&x.type=="element"&&!I.$inlineWithA[x.tagName]&&u>1){h(r,t,true);f(r,t)}c(x,r,s,t)}break;case "text":a(o,r);break;case "element":b(o,r,s,t);break;case "comment":g(o,r,s)}return r}function a(o,r){o.parentNode.tagName=="pre"?r.push(o.data):r.push(n[o.parentNode.tagName]?
v.html(o.data):o.data.replace(/[ ]{2}/g," &nbsp;"))}function b(o,r,s,t){var u="";if(o.attrs){u=[];var x=o.attrs;for(var z in x)u.push(z+(x[z]!==undefined?'="'+(j[z]?v.html(x[z]).replace(/["]/g,function(){return"&quot;"}):v.unhtml(x[z]))+'"':""));u=u.join(" ")}r.push("<"+o.tagName+(u?" "+u:"")+(I.$empty[o.tagName]?"/":"")+">");if(s&&!I.$inlineWithA[o.tagName]&&o.tagName!="pre")if(o.children&&o.children.length){t=h(r,t,true);f(r,t)}if(o.children&&o.children.length)for(u=0;x=o.children[u++];){if(s&&
x.type=="element"&&!I.$inlineWithA[x.tagName]&&u>1){h(r,t);f(r,t)}c(x,r,s,t)}if(!I.$empty[o.tagName]){if(s&&!I.$inlineWithA[o.tagName]&&o.tagName!="pre")if(o.children&&o.children.length){t=h(r,t);f(r,t)}r.push("</"+o.tagName+">")}}function g(o,r){r.push("<!--"+o.data+"--\>")}function l(o,r){var s;if(o.type=="element"&&o.getAttr("id")==r)return o;if(o.children&&o.children.length)for(var t=0;s=o.children[t++];)if(s=l(s,r))return s}function e(o,r,s){o.type=="element"&&o.tagName==r&&s.push(o);if(o.children&&
o.children.length)for(var t=0,u;u=o.children[t++];)e(u,r,s)}function d(o,r){if(o.children&&o.children.length)for(var s=0,t;t=o.children[s];){d(t,r);if(t.parentNode){t.children&&t.children.length&&r(t);t.parentNode&&s++}}else r(o)}var k=UE.uNode=function(o){this.type=o.type;this.data=o.data;this.tagName=o.tagName;this.parentNode=o.parentNode;this.attrs=o.attrs||{};this.children=o.children},j={href:1,src:1,_src:1,_href:1,cdata_data:1},n={style:1,script:1},p="    ",q="\n";k.createElement=function(o){return/[<>]/.test(o)?
UE.htmlparser(o).children[0]:new k({type:"element",children:[],tagName:o})};k.createText=function(o,r){return new UE.uNode({type:"text",data:r?o:v.unhtml(o||"")})};k.prototype={toHtml:function(o){var r=[];c(this,r,o,0);return r.join("")},innerHTML:function(o){if(this.type!="element"||I.$empty[this.tagName])return this;if(v.isString(o)){if(this.children)for(var r=0,s;s=this.children[r++];)s.parentNode=null;this.children=[];o=UE.htmlparser(o);for(r=0;s=o.children[r++];){this.children.push(s);s.parentNode=
this}return this}else{o=new UE.uNode({type:"root",children:this.children});return o.toHtml()}},innerText:function(o,r){if(this.type!="element"||I.$empty[this.tagName])return this;if(o){if(this.children)for(var s=0,t;t=this.children[s++];)t.parentNode=null;this.children=[];this.appendChild(k.createText(o,r));return this}else return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){if(this.type=="element")return"";return this.data},firstChild:function(){return this.children?this.children[0]:
null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var o=this.parentNode,r=0,s;s=o.children[r];r++)if(s===this)return r==0?null:o.children[r-1]},nextSibling:function(){for(var o=this.parentNode,r=0,s;s=o.children[r++];)if(s===this)return o.children[r]},replaceChild:function(o,r){if(this.children){o.parentNode&&o.parentNode.removeChild(o);for(var s=0,t;t=this.children[s];s++)if(t===r){this.children.splice(s,1,o);r.parentNode=null;
o.parentNode=this;return o}}},appendChild:function(o){if(this.type=="root"||this.type=="element"&&!I.$empty[this.tagName]){if(!this.children)this.children=[];o.parentNode&&o.parentNode.removeChild(o);for(var r=0,s;s=this.children[r];r++)if(s===o){this.children.splice(r,1);break}this.children.push(o);o.parentNode=this;return o}},insertBefore:function(o,r){if(this.children){o.parentNode&&o.parentNode.removeChild(o);for(var s=0,t;t=this.children[s];s++)if(t===r){this.children.splice(s,0,o);o.parentNode=
this;return o}}},insertAfter:function(o,r){if(this.children){o.parentNode&&o.parentNode.removeChild(o);for(var s=0,t;t=this.children[s];s++)if(t===r){this.children.splice(s+1,0,o);o.parentNode=this;return o}}},removeChild:function(o,r){if(this.children)for(var s=0,t;t=this.children[s];s++)if(t===o){this.children.splice(s,1);t.parentNode=null;if(r&&t.children&&t.children.length)for(o=0;r=t.children[o];o++){this.children.splice(s+o,0,r);r.parentNode=this}return t}},getAttr:function(o){return this.attrs&&
this.attrs[o.toLowerCase()]},setAttr:function(o,r){if(o){if(!this.attrs)this.attrs={};if(v.isObject(o))for(var s in o)if(o[s])this.attrs[s.toLowerCase()]=o[s];else delete this.attrs[s];else if(r)this.attrs[o.toLowerCase()]=r;else delete this.attrs[o]}else delete this.attrs},getIndex:function(){for(var o=this.parentNode,r=0,s;s=o.children[r];r++)if(s===this)return r;return-1},getNodeById:function(o){var r;if(this.children&&this.children.length)for(var s=0;r=this.children[s++];)if(r=l(r,o))return r},
getNodesByTagName:function(o){o=v.trim(o).replace(/[ ]{2,}/g," ").split(" ");var r=[],s=this;v.each(o,function(t){if(s.children&&s.children.length)for(var u=0,x;x=s.children[u++];)e(x,t,r)});return r},getStyle:function(o){var r=this.getAttr("style");if(!r)return"";if((o=r.match(new RegExp("(^|;)\\s*"+o+":([^;]+)","i")))&&o[0])return o[2];return""},setStyle:function(o,r){function s(x,z){t=t.replace(new RegExp("(^|;)\\s*"+x+":([^;]+;?)","gi"),"$1");if(z)t=x+":"+v.unhtml(z)+";"+t}var t=this.getAttr("style");
t||(t="");if(v.isObject(o))for(var u in o)s(u,o[u]);else s(o,r);this.setAttr("style",v.trim(t))},traversal:function(o){this.children&&this.children.length&&d(this,o);return this}}})();UE.htmlparser=function(h,f){function c(u,x){if(n[u.tagName]){var z=k.createElement(n[u.tagName]);u.appendChild(z);z.appendChild(k.createText(x))}else u.appendChild(k.createText(x))}function a(u,x,z){var F;if(F=j[x]){for(var D=u,M;D.type!="root";){if(v.isArray(F)?v.indexOf(F,D.tagName)!=-1:F==D.tagName){u=D;M=true;break}D=
D.parentNode}M||(u=a(u,v.isArray(F)?F[0]:F))}F=new k({parentNode:u,type:"element",tagName:x.toLowerCase(),children:I.$empty[x]?null:[]});if(z){for(D={};M=l.exec(z);)D[M[1].toLowerCase()]=d[M[1].toLowerCase()]?M[2]||M[3]||M[4]:v.unhtml(M[2]||M[3]||M[4]);F.attrs=D}u.children.push(F);return I.$empty[x]?u:F}function b(u,x){u.children.push(new k({type:"comment",data:x,parentNode:u}))}var g=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\>)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,l=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,
e={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};h=h.replace(new RegExp(m.fillChar,"g"),"");f||(h=h.replace(new RegExp("[\\r\\t\\n"+(f?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(f?"":" ")+"]*","g"),function(u,x){if(x&&e[x.toLowerCase()])return u.replace(/(^[\n\r]+)|([\n\r]+$)/g,"");return u.replace(new RegExp("^[\\r\\n"+(f?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(f?"":" ")+"]+$"),"")}));for(var d={href:1,
src:1},k=UE.uNode,j={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},n={ol:"li",ul:"li"},p,q=0,o=0,r=new k({type:"root",children:[]}),s=r;p=g.exec(h);){q=p.index;try{q>o&&c(s,h.slice(o,q));if(p[3])if(I.$cdata[s.tagName])c(s,p[0]);else s=a(s,p[3].toLowerCase(),p[4]);else if(p[1]){if(s.type!="root")if(I.$cdata[s.tagName]&&!I.$cdata[p[1]])c(s,p[0]);else{for(q=s;s.type=="element"&&s.tagName!=p[1].toLowerCase();){s=
s.parentNode;if(s.type=="root"){s=q;throw"break";}}s=s.parentNode}}else p[2]&&b(s,p[2])}catch(t){}o=g.lastIndex}o<h.length&&c(s,h.slice(o));return r};UE.filterNode=function(){function h(f,c){switch(f.type){case "text":break;case "element":var a;if(a=c[f.tagName])if(a==="-")f.parentNode.removeChild(f);else if(v.isFunction(a)){var b=f.parentNode,g=f.getIndex();a(f);if(f.parentNode){if(f.children)for(a=0;g=f.children[a];){h(g,c);g.parentNode&&a++}}else for(a=g;g=b.children[a];){h(g,c);g.parentNode&&
a++}}else{if((a=a.$)&&f.attrs){g={};var l;for(b in a){l=f.getAttr(b);if(b=="style"&&v.isArray(a[b])){var e=[];v.each(a[b],function(d){var k;if(k=f.getStyle(d))e.push(d+":"+k)});l=e.join(";")}if(l)g[b]=l}f.attrs=g}if(f.children)for(a=0;g=f.children[a];){h(g,c);g.parentNode&&a++}}else if(I.$cdata[f.tagName])f.parentNode.removeChild(f);else{b=f.parentNode;g=f.getIndex();f.parentNode.removeChild(f,true);for(a=g;g=b.children[a];){h(g,c);g.parentNode&&a++}}break;case "comment":f.parentNode.removeChild(f)}}
return function(f,c){if(v.isEmptyObject(c))return f;var a;if(a=c["-"])v.each(a.split(" "),function(g){c[g]="-"});a=0;for(var b;b=f.children[a];){h(b,c);b.parentNode&&a++}return f}}();UE.plugin=function(){var h={};return{register:function(f,c,a,b){if(a&&v.isFunction(a)){b=a;a=null}h[f]={optionName:a||f,execFn:c,afterDisabled:b}},load:function(f){v.each(h,function(c){var a=c.execFn.call(f);if(f.options[c.optionName]!==false)a&&v.each(a,function(b,g){switch(g.toLowerCase()){case "shortcutkey":f.addshortcutkey(b);
break;case "bindevents":v.each(b,function(l,e){f.addListener(e,l)});break;case "bindmultievents":v.each(v.isArray(b)?b:[b],function(l){var e=v.trim(l.type).split(/\s+/);v.each(e,function(d){f.addListener(d,l.handler)})});break;case "commands":v.each(b,function(l,e){f.commands[e]=l});break;case "outputrule":f.addOutputRule(b);break;case "inputrule":f.addInputRule(b);break;case "defaultoptions":f.setOpt(b)}});else c.afterDisabled&&c.afterDisabled.call(f)});v.each(UE.plugins,function(c){c.call(f)})},
run:function(f,c){(f=h[f])&&f.exeFn.call(c)}}}();var Ca=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78},pa=UE.LocalStorage=function(){function h(){var a=document.createElement("div");a.style.display="none";if(!a.addBehavior)return null;a.addBehavior("#default#userdata");return{getItem:function(b){var g=
null;try{document.body.appendChild(a);a.load(c);g=a.getAttribute(b);document.body.removeChild(a)}catch(l){}return g},setItem:function(b,g){document.body.appendChild(a);a.setAttribute(b,g);a.save(c);document.body.removeChild(a)},removeItem:function(b){document.body.appendChild(a);a.removeAttribute(b);a.save(c);document.body.removeChild(a)}}}var f=window.localStorage||h()||null,c="localStorage";return{saveLocalData:function(a,b){if(f&&b){f.setItem(a,b);return true}return false},getLocalData:function(a){if(f)return f.getItem(a);
return null},removeItem:function(a){f&&f.removeItem(a)}}}();(function(){UE.Editor.prototype.setPreferences=function(h,f){var c={};if(v.isString(h))c[h]=f;else c=h;if((h=pa.getLocalData("ueditor_preference"))&&(h=v.str2json(h)))v.extend(h,c);else h=c;h&&pa.saveLocalData("ueditor_preference",v.json2str(h))};UE.Editor.prototype.getPreferences=function(h){var f=pa.getLocalData("ueditor_preference");if(f&&(f=v.str2json(f)))return h?f[h]:f;return null};UE.Editor.prototype.removePreferences=function(h){var f=
pa.getLocalData("ueditor_preference");if(f&&(f=v.str2json(f))){f[h]=undefined;delete f[h]}f&&pa.saveLocalData("ueditor_preference",v.json2str(f))}})();UE.plugins.defaultfilter=function(){var h=this;h.setOpt({allowDivTransToP:true,disabledTableInTable:true});h.addInputRule(function(f){function c(g){for(;g&&g.type=="element";){if(g.tagName=="td")return true;g=g.parentNode}return false}var a=this.options.allowDivTransToP,b;f.traversal(function(g){if(g.type=="element")if(!I.$cdata[g.tagName]&&h.options.autoClearEmptyNode&&
I.$inline[g.tagName]&&!I.$empty[g.tagName]&&(!g.attrs||v.isEmptyObject(g.attrs)))if(g.firstChild()){if(g.tagName=="span"&&(!g.attrs||v.isEmptyObject(g.attrs)))g.parentNode.removeChild(g,true)}else g.parentNode.removeChild(g);else switch(g.tagName){case "style":case "script":g.setAttr({cdata_tag:g.tagName,cdata_data:g.innerHTML()||"",_ue_custom_node_:"true"});g.tagName="div";g.innerHTML("");break;case "a":if(b=g.getAttr("href"))g.setAttr("_href",b);break;case "img":if(b=g.getAttr("src"))if(/^data:/.test(b)){g.parentNode.removeChild(g);
break}g.setAttr("_src",g.getAttr("src"));break;case "span":if(y.webkit&&(b=g.getStyle("white-space")))if(/nowrap|normal/.test(b)){g.setStyle("white-space","");h.options.autoClearEmptyNode&&v.isEmptyObject(g.attrs)&&g.parentNode.removeChild(g,true)}(b=g.getAttr("id"))&&/^_baidu_bookmark_/i.test(b)&&g.parentNode.removeChild(g);break;case "p":if(b=g.getAttr("align")){g.setAttr("align");g.setStyle("text-align",b)}v.each(g.children,function(d){if(d.type=="element"&&d.tagName=="p"){var k=d.nextSibling();
g.parentNode.insertAfter(d,g);for(d=d;k;){var j=k.nextSibling();g.parentNode.insertAfter(k,d);d=k;k=j}return false}});g.firstChild()||g.innerHTML(y.ie?"&nbsp;":"<br/>");break;case "div":if(g.getAttr("cdata_tag"))break;if((b=g.getAttr("class"))&&/^line number\d+/.test(b))break;if(!a)break;for(var l,e=UE.uNode.createElement("p");l=g.firstChild();)if(l.type=="text"||!UE.dom.dtd.$block[l.tagName])e.appendChild(l);else if(e.firstChild()){g.parentNode.insertBefore(e,g);e=UE.uNode.createElement("p")}else g.parentNode.insertBefore(l,
g);e.firstChild()&&g.parentNode.insertBefore(e,g);g.parentNode.removeChild(g);break;case "dl":g.tagName="ul";break;case "dt":case "dd":g.tagName="li";break;case "li":l=g.getAttr("class");if(!l||!/list\-/.test(l))g.setAttr();l=g.getNodesByTagName("ol ul");UE.utils.each(l,function(d){g.parentNode.insertAfter(d,g)});break;case "td":case "th":case "caption":if(!g.children||!g.children.length)g.appendChild(y.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"));break;case "table":if(h.options.disabledTableInTable&&
c(g)){g.parentNode.insertBefore(UE.uNode.createText(g.innerText()),g);g.parentNode.removeChild(g)}}})});h.addOutputRule(function(f){var c;f.traversal(function(a){if(a.type=="element")if(h.options.autoClearEmptyNode&&I.$inline[a.tagName]&&!I.$empty[a.tagName]&&(!a.attrs||v.isEmptyObject(a.attrs)))if(a.firstChild()){if(a.tagName=="span"&&(!a.attrs||v.isEmptyObject(a.attrs)))a.parentNode.removeChild(a,true)}else a.parentNode.removeChild(a);else switch(a.tagName){case "div":if(c=a.getAttr("cdata_tag")){a.tagName=
c;a.appendChild(UE.uNode.createText(a.getAttr("cdata_data")));a.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""})}break;case "a":if(c=a.getAttr("_href"))a.setAttr({href:v.html(c),_href:""});break;case "span":(c=a.getAttr("id"))&&/^_baidu_bookmark_/i.test(c)&&a.parentNode.removeChild(a);break;case "img":if(c=a.getAttr("_src"))a.setAttr({src:a.getAttr("_src"),_src:""})}})})};UE.commands.inserthtml={execCommand:function(h,f,c){var a=this,b;if(f)if(a.fireEvent("beforeinserthtml",f)!==true){b=
a.selection.getRange();h=b.document.createElement("div");h.style.display="inline";if(!c){c=UE.htmlparser(f);a.options.filterRules&&UE.filterNode(c,a.options.filterRules);a.filterInputRule(c);f=c.toHtml()}h.innerHTML=v.trim(f);if(!b.collapsed){c=b.startContainer;m.isFillChar(c)&&b.setStartBefore(c);c=b.endContainer;m.isFillChar(c)&&b.setEndAfter(c);b.txtToElmBoundary();if(b.endContainer&&b.endContainer.nodeType==1)(c=b.endContainer.childNodes[b.endOffset])&&m.isBr(c)&&b.setEndAfter(c);if(b.startOffset==
0){c=b.startContainer;if(m.isBoundaryNode(c,"firstChild")){c=b.endContainer;if(b.endOffset==(c.nodeType==3?c.nodeValue.length:c.childNodes.length)&&m.isBoundaryNode(c,"lastChild")){a.body.innerHTML="<p>"+(y.ie?"":"<br/>")+"</p>";b.setStart(a.body.firstChild,0).collapse(true)}}}!b.collapsed&&b.deleteContents();if(b.startContainer.nodeType==1){c=b.startContainer.childNodes[b.startOffset];var g;if(c&&m.isBlockElm(c)&&(g=c.previousSibling)&&m.isBlockElm(g)){for(b.setEnd(g,g.childNodes.length).collapse();c.firstChild;)g.appendChild(c.firstChild);
m.remove(c)}}}var l,e,d=0,k;if(b.inFillChar()){c=b.startContainer;if(m.isFillChar(c)){b.setStartBefore(c).collapse(true);m.remove(c)}else if(m.isFillChar(c,true)){c.nodeValue=c.nodeValue.replace(oa,"");b.startOffset--;b.collapsed&&b.collapse(true)}}var j=m.findParentByTagName(b.startContainer,"li",true);if(j){for(var n;c=h.firstChild;){for(;c&&(c.nodeType==3||!m.isBlockElm(c)||c.tagName=="HR");){n=c.nextSibling;b.insertNode(c).collapse();l=c;c=n}if(c)if(/^(ol|ul)$/i.test(c.tagName)){for(;c.firstChild;){l=
c.firstChild;m.insertAfter(j,c.firstChild);j=j.nextSibling}m.remove(c)}else{n=c.nextSibling;g=a.document.createElement("li");m.insertAfter(j,g);g.appendChild(c);l=c;c=n;j=g}}j=m.findParentByTagName(b.startContainer,"li",true);m.isEmptyBlock(j)&&m.remove(j);l&&b.setStartAfter(l).collapse(true).select(true)}else{for(;c=h.firstChild;){if(d){for(l=a.document.createElement("p");c&&(c.nodeType==3||!I.$block[c.tagName]);){k=c.nextSibling;l.appendChild(c);c=k}if(l.firstChild)c=l}b.insertNode(c);k=c.nextSibling;
if(!d&&c.nodeType==m.NODE_ELEMENT&&m.isBlockElm(c))if((l=m.findParent(c,function(o){return m.isBlockElm(o)}))&&l.tagName.toLowerCase()!="body"&&!(I[l.tagName][c.nodeName]&&c.parentNode===l)){if(I[l.tagName][c.nodeName])for(e=c.parentNode;e!==l;){g=e;e=e.parentNode}else g=l;m.breakParent(c,g||e);g=c.previousSibling;m.trimWhiteTextNode(g);g.childNodes.length||m.remove(g);if(!y.ie&&(n=c.nextSibling)&&m.isBlockElm(n)&&n.lastChild&&!m.isBr(n.lastChild))n.appendChild(a.document.createElement("br"));d=1}n=
c.nextSibling;if(!h.firstChild&&n&&m.isBlockElm(n)){b.setStart(n,0).collapse(true);break}b.setEndAfter(c).collapse()}c=b.startContainer;k&&m.isBr(k)&&m.remove(k);if(m.isBlockElm(c)&&m.isEmptyNode(c))if(k=c.nextSibling){m.remove(c);k.nodeType==1&&I.$block[k.tagName]&&b.setStart(k,0).collapse(true).shrinkBoundary()}else try{c.innerHTML=y.ie?m.fillChar:"<br/>"}catch(p){b.setStartBefore(c);m.remove(c)}try{b.select(true)}catch(q){}}setTimeout(function(){b=a.selection.getRange();b.scrollToView(a.autoHeightEnabled,
a.autoHeightEnabled?m.getXY(a.iframe).y:0);a.fireEvent("afterinserthtml",f)},200)}}};UE.plugins.autotypeset=function(){function h(p,q){if(!p||p.nodeType==3)return 0;if(m.isBr(p))return 1;if(p&&p.parentNode&&j[p.tagName.toLowerCase()]){if(n&&n.contains(p)||p.getAttribute("pagebreak"))return 0;return q?!m.isEmptyBlock(p):m.isEmptyBlock(p,new RegExp("[\\s"+m.fillChar+"]","g"))}}function f(p){if(!p.style.cssText){m.removeAttributes(p,["style"]);p.tagName.toLowerCase()=="span"&&m.hasNoAttributes(p)&&m.remove(p,
true)}}function c(p,q){if(q){if(!e.pasteFilter)return;p=this.document.createElement("div");p.innerHTML=q.html}else p=this.document.body;for(var o=m.getElementsByTagName(p,"*"),r=0,s;s=o[r++];)if(this.fireEvent("excludeNodeinautotype",s)!==true){if(e.clearFontSize&&s.style.fontSize){m.removeStyle(s,"font-size");f(s)}if(e.clearFontFamily&&s.style.fontFamily){m.removeStyle(s,"font-family");f(s)}if(h(s)){if(e.mergeEmptyline)for(var t=s.nextSibling,u,x=m.isBr(s);h(t);){u=t;t=u.nextSibling;if(x&&(!t||t&&
!m.isBr(t)))break;m.remove(u)}if(e.removeEmptyline&&m.inDoc(s,p)&&!k[s.parentNode.tagName.toLowerCase()]){if(m.isBr(s))if((t=s.nextSibling)&&!m.isBr(t))continue;m.remove(s);continue}}if(h(s,true)&&s.tagName!="SPAN"){if(e.indent)s.style.textIndent=e.indentValue;if(e.textAlign)s.style.textAlign=e.textAlign}if(e.removeClass&&s.className&&!d[s.className.toLowerCase()]){if(n&&n.contains(s))continue;m.removeAttributes(s,["class"])}if(e.imageBlockLine&&s.tagName.toLowerCase()=="img"&&!s.getAttribute("emotion"))if(q){x=
s;switch(e.imageBlockLine){case "left":case "right":case "none":t=x.parentNode;for(var z;I.$inline[t.tagName]||t.tagName=="A";)t=t.parentNode;u=t;if(u.tagName=="P"&&m.getStyle(u,"text-align")=="center")if(!m.isBody(u)&&m.getChildCount(u,function(F){return!m.isBr(F)&&!m.isWhitespace(F)})==1){z=u.previousSibling;t=u.nextSibling;if(z&&t&&z.nodeType==1&&t.nodeType==1&&z.tagName==t.tagName&&m.isBlockElm(z)){for(z.appendChild(u.firstChild);t.firstChild;)z.appendChild(t.firstChild);m.remove(u);m.remove(t)}else m.setStyle(u,
"text-align","")}m.setStyle(x,"float",e.imageBlockLine);break;case "center":if(this.queryCommandValue("imagefloat")!="center"){t=x.parentNode;m.setStyle(x,"float","none");for(u=x;t&&m.getChildCount(t,function(F){return!m.isBr(F)&&!m.isWhitespace(F)})==1&&(I.$inline[t.tagName]||t.tagName=="A");){u=t;t=t.parentNode}t=this.document.createElement("p");m.setAttributes(t,{style:"text-align:center"});u.parentNode.insertBefore(t,u);t.appendChild(u);m.setStyle(u,"float","")}}}else{this.selection.getRange().selectNode(s).select();
this.execCommand("imagefloat",e.imageBlockLine)}e.removeEmptyNode&&e.removeTagNames[s.tagName.toLowerCase()]&&m.hasNoAttributes(s)&&m.isEmptyBlock(s)&&m.remove(s)}if(e.tobdc){o=UE.htmlparser(p.innerHTML);o.traversal(function(F){if(F.type=="text")F.data=b(F.data)});p.innerHTML=o.toHtml()}if(e.bdc2sb){o=UE.htmlparser(p.innerHTML);o.traversal(function(F){if(F.type=="text")F.data=a(F.data)});p.innerHTML=o.toHtml()}if(q)q.html=p.innerHTML}function a(p){for(var q="",o=0;o<p.length;o++){var r=p.charCodeAt(o);
q+=r>=65281&&r<=65373?String.fromCharCode(p.charCodeAt(o)-65248):r==12288?String.fromCharCode(p.charCodeAt(o)-12288+32):p.charAt(o)}return q}function b(p){p=v.html(p);for(var q="",o=0;o<p.length;o++)q+=p.charCodeAt(o)==32?String.fromCharCode(12288):p.charCodeAt(o)<127?String.fromCharCode(p.charCodeAt(o)+65248):p.charAt(o);return q}function g(){var p=l.getPreferences("autotypeset");v.extend(l.options.autotypeset,p)}this.setOpt({autotypeset:{mergeEmptyline:true,removeClass:true,removeEmptyline:false,
textAlign:"left",imageBlockLine:"center",pasteFilter:false,clearFontSize:false,clearFontFamily:false,removeEmptyNode:false,removeTagNames:v.extend({div:1},I.$removeEmpty),indent:false,indentValue:"2em",bdc2sb:false,tobdc:false}});var l=this,e=l.options.autotypeset,d={selectTdClass:1,pagebreak:1,anchorclass:1},k={li:1},j={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1},n;if(e){g();e.pasteFilter&&l.addListener("beforepaste",c);l.commands.autotypeset={execCommand:function(){l.removeListener("beforepaste",
c);e.pasteFilter&&l.addListener("beforepaste",c);c.call(l)}}}};UE.plugin.register("autosubmit",function(){return{shortcutkey:{autosubmit:"ctrl+13"},commands:{autosubmit:{execCommand:function(){var h=m.findParentByTagName(this.iframe,"form",false);if(h)if(this.fireEvent("beforesubmit")!==false){this.sync();h.submit()}}}}}});UE.plugin.register("background",function(){function h(e){var d={};e=e.split(";");v.each(e,function(k){var j=k.indexOf(":"),n=v.trim(k.substr(0,j)).toLowerCase();n&&(d[n]=v.trim(k.substr(j+
1)||""))});return d}function f(e){if(e){var d=[];for(var k in e)e.hasOwnProperty(k)&&d.push(k+":"+e[k]+"; ");v.cssRule(a,d.length?"body{"+d.join("")+"}":"",c.document)}else v.cssRule(a,"",c.document)}var c=this,a="editor_background",b,g=/body[\s]*\{(.+)\}/i,l=c.hasContents;c.hasContents=function(){if(c.queryCommandValue("background"))return true;return l.apply(c,arguments)};return{bindEvents:{getAllHtml:function(e,d){e=this.body;var k=m.getComputedStyle(e,"background-image"),j="";j=k.indexOf(c.options.imagePath)>
0?k.substring(k.indexOf(c.options.imagePath),k.length-1).replace(/"|\(|\)/ig,""):k!="none"?k.replace(/url\("?|"?\)/ig,""):"";k='<style type="text/css">body{';e={"background-color":m.getComputedStyle(e,"background-color")||"#ffffff","background-image":j?"url("+j+")":"","background-repeat":m.getComputedStyle(e,"background-repeat")||"","background-position":y.ie?m.getComputedStyle(e,"background-position-x")+" "+m.getComputedStyle(e,"background-position-y"):m.getComputedStyle(e,"background-position"),
height:m.getComputedStyle(e,"height")};for(var n in e)if(e.hasOwnProperty(n))k+=n+":"+e[n]+"; ";k+="}</style> ";d.push(k)},aftersetcontent:function(){b==false&&f()}},inputRule:function(e){b=false;v.each(e.getNodesByTagName("p"),function(d){var k=d.getAttr("data-background");if(k){b=true;f(h(k));d.parentNode.removeChild(d)}})},outputRule:function(e){var d=(v.cssRule(a,this.document)||"").replace(/[\n\r]+/g,"").match(g);d&&e.appendChild(UE.uNode.createElement('<p style="display:none;" data-background="'+
v.trim(d[1].replace(/"/g,"").replace(/[\s]+/g," "))+'"><br/></p>'))},commands:{background:{execCommand:function(e,d){f(d)},queryCommandValue:function(){var e=(v.cssRule(a,this.document)||"").replace(/[\n\r]+/g,"").match(g);return e?h(e[1]):null},notNeedUndo:true}}}});UE.commands.imagefloat={execCommand:function(h,f){h=this.selection.getRange();if(!h.collapsed){var c=h.getClosedNode();if(c&&c.tagName=="IMG")switch(f){case "left":case "right":case "none":for(var a=c.parentNode,b,g;I.$inline[a.tagName]||
a.tagName=="A";)a=a.parentNode;b=a;if(b.tagName=="P"&&m.getStyle(b,"text-align")=="center"){if(!m.isBody(b)&&m.getChildCount(b,function(l){return!m.isBr(l)&&!m.isWhitespace(l)})==1){a=b.previousSibling;g=b.nextSibling;if(a&&g&&a.nodeType==1&&g.nodeType==1&&a.tagName==g.tagName&&m.isBlockElm(a)){for(a.appendChild(b.firstChild);g.firstChild;)a.appendChild(g.firstChild);m.remove(b);m.remove(g)}else m.setStyle(b,"text-align","")}h.selectNode(c).select()}m.setStyle(c,"float",f=="none"?"":f);f=="none"&&
m.removeAttributes(c,"align");break;case "center":if(this.queryCommandValue("imagefloat")!="center"){a=c.parentNode;m.setStyle(c,"float","");m.removeAttributes(c,"align");for(b=c;a&&m.getChildCount(a,function(l){return!m.isBr(l)&&!m.isWhitespace(l)})==1&&(I.$inline[a.tagName]||a.tagName=="A");){b=a;a=a.parentNode}h.setStartBefore(b).setCursor(false);a=this.document.createElement("div");a.appendChild(b);m.setStyle(b,"float","");this.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+
a.innerHTML+"</p>");b=this.document.getElementById("_img_parent_tmp");b.removeAttribute("id");b=b.firstChild;h.selectNode(b).select();(g=b.parentNode.nextSibling)&&m.isEmptyNode(g)&&m.remove(g)}break}}},queryCommandValue:function(){var h=this.selection.getRange(),f;if(h.collapsed)return"none";if((h=h.getClosedNode())&&h.nodeType==1&&h.tagName=="IMG"){f=m.getComputedStyle(h,"float")||h.getAttribute("align");if(f=="none")f=m.getComputedStyle(h.parentNode,"text-align")=="center"?"center":f;return{left:1,
right:1,center:1}[f]?f:"none"}return"none"},queryCommandState:function(){var h=this.selection.getRange();if(h.collapsed)return-1;if((h=h.getClosedNode())&&h.nodeType==1&&h.tagName=="IMG")return 0;return-1}};UE.commands.insertimage={execCommand:function(h,f){f=v.isArray(f)?f:[f];if(f.length){h=this.selection.getRange();var c=h.getClosedNode();if(this.fireEvent("beforeinsertimage",f)!==true){if(c&&/img/i.test(c.tagName)&&(c.className!="edui-faked-video"||c.className.indexOf("edui-upload-video")!=-1)&&
!c.getAttribute("word_img")){var a=f.shift(),b=a.floatStyle;delete a.floatStyle;m.setAttributes(c,a);this.execCommand("imagefloat",b);if(f.length>0){h.setStartAfter(c).setCursor(false,true);this.execCommand("insertimage",f)}}else{h=[];c="";a=f[0];if(f.length==1){c='<img src="'+a.src+'" '+(a._src?' _src="'+a._src+'" ':"")+(a.width?'width="'+a.width+'" ':"")+(a.height?' height="'+a.height+'" ':"")+(a.floatStyle=="left"||a.floatStyle=="right"?' style="float:'+a.floatStyle+';"':"")+(a.title&&a.title!=
""?' title="'+a.title+'"':"")+(a.border&&a.border!="0"?' border="'+a.border+'"':"")+(a.alt&&a.alt!=""?' alt="'+a.alt+'"':"")+(a.hspace&&a.hspace!="0"?' hspace = "'+a.hspace+'"':"")+(a.vspace&&a.vspace!="0"?' vspace = "'+a.vspace+'"':"")+"/>";if(a.floatStyle=="center")c='<p style="text-align: center">'+c+"</p>";h.push(c)}else for(b=0;a=f[b++];){c="<p "+(a.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+a.src+'" '+(a.width?'width="'+a.width+'" ':"")+(a._src?' _src="'+a._src+'" ':
"")+(a.height?' height="'+a.height+'" ':"")+' style="'+(a.floatStyle&&a.floatStyle!="center"?"float:"+a.floatStyle+";":"")+(a.border||"")+'" '+(a.title?' title="'+a.title+'"':"")+" /></p>";h.push(c)}this.execCommand("insertHtml",h.join(""))}this.fireEvent("afterinsertimage",f)}}}};UE.plugins.justify=function(){var h=m.isBlockElm,f={left:1,right:1,center:1,justify:1},c=function(a,b){var g=a.createBookmark(),l=function(p){return p.nodeType==1?p.tagName.toLowerCase()!="br"&&!m.isBookmarkNode(p):!m.isWhitespace(p)};
a.enlarge(true);for(var e=a.createBookmark(),d=m.getNextDomNode(e.start,false,l),k=a.cloneRange(),j;d&&!(m.getPosition(d,e.end)&m.POSITION_FOLLOWING);)if(d.nodeType==3||!h(d)){for(k.setStartBefore(d);d&&d!==e.end&&!h(d);){j=d;d=m.getNextDomNode(d,false,null,function(p){return!h(p)})}k.setEndAfter(j);d=k.getCommonAncestor();if(!m.isBody(d)&&h(d)){m.setStyles(d,v.isString(b)?{"text-align":b}:b);d=d}else{d=a.document.createElement("p");m.setStyles(d,v.isString(b)?{"text-align":b}:b);var n=k.extractContents();
d.appendChild(n);k.insertNode(d);d=d}d=m.getNextDomNode(d,false,l)}else d=m.getNextDomNode(d,true,l);return a.moveToBookmark(e).moveToBookmark(g)};UE.commands.justify={execCommand:function(a,b){a=this.selection.getRange();var g;if(a.collapsed){g=this.document.createTextNode("p");a.insertNode(g)}c(a,b);if(g){a.setStartBefore(g).collapse(true);m.remove(g)}a.select();return true},queryCommandValue:function(){var a=this.selection.getStart();a=m.getComputedStyle(a,"text-align");return f[a]?a:"left"},queryCommandState:function(){var a=
this.selection.getStart();return a&&m.findParentByTagName(a,["td","th","caption"],true)?-1:0}}};UE.plugins.font=function(){function h(e){for(var d;d=e.parentNode;)if(d.tagName=="SPAN"&&m.getChildCount(d,function(k){return!m.isBookmarkNode(k)&&!m.isBr(k)})==1){d.style.cssText+=e.style.cssText;m.remove(e,true);e=d}else break}function f(e,d,k){if(g[d]){e.adjustmentBoundary();if(!e.collapsed&&e.startContainer.nodeType==1){var j=e.startContainer.childNodes[e.startOffset];if(j&&m.isTagNode(j,"span")){var n=
e.createBookmark();v.each(m.getElementsByTagName(j,"span"),function(p){if(!(!p.parentNode||m.isBookmarkNode(p)))if(!(d=="backcolor"&&m.getComputedStyle(p,"background-color").toLowerCase()===k)){m.removeStyle(p,g[d]);p.style.cssText.replace(/^\s+$/,"").length==0&&m.remove(p,true)}});e.moveToBookmark(n)}}}}function c(e,d,k){var j=e.collapsed,n=e.createBookmark();if(j)for(j=n.start.parentNode;I.$inline[j.tagName];)j=j.parentNode;else j=m.getCommonAncestor(n.start,n.end);v.each(m.getElementsByTagName(j,
"span"),function(p){if(!(!p.parentNode||m.isBookmarkNode(p)))if(/\s*border\s*:\s*none;?\s*/i.test(p.style.cssText))/^\s*border\s*:\s*none;?\s*$/.test(p.style.cssText)?m.remove(p,true):m.removeStyle(p,"border");else{if(/border/i.test(p.style.cssText)&&p.parentNode.tagName=="SPAN"&&/border/i.test(p.parentNode.style.cssText))p.style.cssText=p.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"");if(!(d=="fontborder"&&k=="none"))for(var q=p.nextSibling;q&&q.nodeType==1&&q.tagName=="SPAN";){if(m.isBookmarkNode(q)&&
d=="fontborder")p.appendChild(q);else{if(q.style.cssText==p.style.cssText){m.moveChild(q,p);m.remove(q)}if(p.nextSibling===q)break}q=p.nextSibling}h(p);if(y.ie&&y.version>8)if((q=m.findParent(p,function(o){return o.tagName=="SPAN"&&/background-color/.test(o.style.cssText)}))&&!/background-color/.test(p.style.cssText))p.style.backgroundColor=q.style.backgroundColor}});e.moveToBookmark(n);f(e,d,k)}var a={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",
strikethrough:"text-decoration",fontborder:"border"},b={underline:1,strikethrough:1,fontborder:1},g={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"};this.setOpt({fontfamily:[{name:"songti",val:"\u5b8b\u4f53,SimSun"},{name:"yahei",val:"\u5fae\u8f6f\u96c5\u9ed1,Microsoft YaHei"},{name:"kaiti",val:"\u6977\u4f53,\u6977\u4f53_GB2312, SimKai"},{name:"heiti",val:"\u9ed1\u4f53, SimHei"},{name:"lishu",val:"\u96b6\u4e66, SimLi"},{name:"andaleMono",val:"andale mono"},
{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});this.addInputRule(function(e){v.each(e.getNodesByTagName("u s del font strike"),function(d){if(d.tagName=="font"){var k=[];for(var j in d.attrs)switch(j){case "size":k.push("font-size:"+({"1":"10","2":"12","3":"16","4":"18","5":"24","6":"32",
"7":"48"}[d.attrs[j]]||d.attrs[j])+"px");break;case "color":k.push("color:"+d.attrs[j]);break;case "face":k.push("font-family:"+d.attrs[j]);break;case "style":k.push(d.attrs[j])}d.attrs={style:k.join(";")}}else{k=d.tagName=="u"?"underline":"line-through";d.attrs={style:(d.getAttr("style")||"")+"text-decoration:"+k+";"}}d.tagName="span"})});for(var l in a)(function(e,d){UE.commands[e]={execCommand:function(k,j){j=j||(this.queryCommandState(k)?"none":k=="underline"?"underline":k=="fontborder"?"1px solid #000":
"line-through");var n=this.selection.getRange(),p;if(j=="default"){if(n.collapsed){p=this.document.createTextNode("font");n.insertNode(p).select()}this.execCommand("removeFormat","span,a",d);if(p){n.setStartBefore(p).collapse(true);m.remove(p)}c(n,k,j);n.select()}else if(n.collapsed){var q=m.findParentByTagName(n.startContainer,"span",true);p=this.document.createTextNode("font");if(q&&!q.children.length&&!q[y.ie?"innerText":"textContent"].replace(oa,"").length){n.insertNode(p);if(b[e]){n.selectNode(p).select();
this.execCommand("removeFormat","span,a",d,null);q=m.findParentByTagName(p,"span",true);n.setStartBefore(p)}q&&(q.style.cssText+=";"+d+":"+j);n.collapse(true).select()}else{n.insertNode(p);n.selectNode(p).select();q=n.document.createElement("span");if(b[e]){if(m.findParentByTagName(p,"a",true)){n.setStartBefore(p).setCursor();m.remove(p);return}this.execCommand("removeFormat","span,a",d)}q.style.cssText=d+":"+j;p.parentNode.insertBefore(q,p);if(!y.ie||y.ie&&y.version==9)for(var o=q.parentNode;!m.isBlockElm(o);){if(o.tagName==
"SPAN")q.style.cssText=o.style.cssText+";"+q.style.cssText;o=o.parentNode}if(Oa)setTimeout(function(){n.setStart(q,0).collapse(true);c(n,k,j);n.select()});else{n.setStart(q,0).collapse(true);c(n,k,j);n.select()}}m.remove(p)}else{b[e]&&this.queryCommandValue(e)&&this.execCommand("removeFormat","span,a",d);n=this.selection.getRange();n.applyInlineStyle("span",{style:d+":"+j});c(n,k,j);n.select()}return true},queryCommandValue:function(k){var j=this.selection.getStart();if(k=="underline"||k=="strikethrough"){for(k=
j;k&&!m.isBlockElm(k)&&!m.isBody(k);){if(k.nodeType==1){j=m.getComputedStyle(k,d);if(j!="none")return j}k=k.parentNode}return"none"}if(k=="fontborder"){for(k=j;k&&I.$inline[k.tagName];){if(j=m.getComputedStyle(k,"border"))if(/1px/.test(j)&&/solid/.test(j))return j;k=k.parentNode}return""}if(k=="FontSize"){j=m.getComputedStyle(j,d);if(k=/^([\d\.]+)(\w+)$/.exec(j))return Math.floor(k[1])+k[2];return j}return m.getComputedStyle(j,d)},queryCommandState:function(k){if(!b[k])return 0;var j=this.queryCommandValue(k);
return k=="fontborder"?/1px/.test(j)&&/solid/.test(j):k=="underline"?/underline/.test(j):/line\-through/.test(j)}}})(l,a[l])};UE.plugins.link=function(){function h(c){var a=c.startContainer,b=c.endContainer;if(a=m.findParentByTagName(a,"a",true))c.setStartBefore(a);if(b=m.findParentByTagName(b,"a",true))c.setEndAfter(b)}function f(c,a,b){var g=c.cloneRange(),l=b.queryCommandValue("link");h(c=c.adjustmentBoundary());b=c.startContainer;if(b.nodeType==1&&l)if((b=b.childNodes[c.startOffset])&&b.nodeType==
1&&b.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(b[y.ie?"innerText":"textContent"]))b[y.ie?"innerText":"textContent"]=v.html(a.textValue||a.href);if(!g.collapsed||l){c.removeInlineStyle("a");g=c.cloneRange()}if(g.collapsed){l=c.document.createElement("a");var e="";if(a.textValue){e=v.html(a.textValue);delete a.textValue}else e=v.html(a.href);m.setAttributes(l,a);(b=m.findParentByTagName(g.startContainer,"a",true))&&m.isInNodeEndBoundary(g,b)&&c.setStartAfter(b).collapse(true);l[y.ie?"innerText":
"textContent"]=e;c.insertNode(l).selectNode(l)}else c.applyInlineStyle("a",a)}UE.commands.unlink={execCommand:function(){var c=this.selection.getRange(),a;if(!(c.collapsed&&!m.findParentByTagName(c.startContainer,"a",true))){a=c.createBookmark();h(c);c.removeInlineStyle("a").moveToBookmark(a).select()}},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}};UE.commands.link={execCommand:function(c,a){a._href&&(a._href=v.unhtml(a._href,/[<">]/g));a.href&&(a.href=
v.unhtml(a.href,/[<">]/g));a.textValue&&(a.textValue=v.unhtml(a.textValue,/[<">]/g));f(c=this.selection.getRange(),a,this);c.collapse().select(true)},queryCommandValue:function(){var c=this.selection.getRange(),a;if(c.collapsed){a=c.startContainer;if((a=a.nodeType==1?a:a.parentNode)&&(a=m.findParentByTagName(a,"a",true))&&!m.isInNodeEndBoundary(c,a))return a}else{c.shrinkBoundary();var b=c.startContainer.nodeType==3||!c.startContainer.childNodes[c.startOffset]?c.startContainer:c.startContainer.childNodes[c.startOffset],
g=c.endContainer.nodeType==3||c.endOffset==0?c.endContainer:c.endContainer.childNodes[c.endOffset-1];c=c.getCommonAncestor();a=m.findParentByTagName(c,"a",true);if(!a&&c.nodeType==1){c=c.getElementsByTagName("a");for(var l,e,d=0,k;k=c[d++];){l=m.getPosition(k,b);e=m.getPosition(k,g);if((l&m.POSITION_FOLLOWING||l&m.POSITION_CONTAINS)&&(e&m.POSITION_PRECEDING||e&m.POSITION_CONTAINS)){a=k;break}}}return a}},queryCommandState:function(){var c=this.selection.getRange().getClosedNode();return c&&(c.className==
"edui-faked-video"||c.className.indexOf("edui-upload-video")!=-1)?-1:0}}};UE.plugins.insertframe=function(){function h(){f._iframe&&delete f._iframe}var f=this;f.addListener("selectionchange",function(){h()})};UE.commands.scrawl={queryCommandState:function(){return y.ie&&y.version<=8?-1:0}};UE.plugins.removeformat=function(){this.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});
this.commands.removeformat={execCommand:function(h,f,c,a,b){function g(p){if(p.nodeType==3||p.tagName.toLowerCase()!="span")return 0;if(y.ie){var q=p.attributes;if(q.length){p=0;for(var o=q.length;p<o;p++)if(q[p].specified)return 0;return 1}}return!p.attributes.length}function l(p){var q=p.createBookmark();p.collapsed&&p.enlarge(true);if(!b){var o=m.findParentByTagName(p.startContainer,"a",true);o&&p.setStartBefore(o);(o=m.findParentByTagName(p.endContainer,"a",true))&&p.setEndAfter(o)}k=p.createBookmark();
for(o=k.start;(j=o.parentNode)&&!m.isBlockElm(j);){m.breakParent(o,j);m.clearEmptySibling(o)}if(k.end){for(o=k.end;(j=o.parentNode)&&!m.isBlockElm(j);){m.breakParent(o,j);m.clearEmptySibling(o)}o=m.getNextDomNode(k.start,false,n);for(var r;o;){if(o==k.end)break;r=m.getNextDomNode(o,true,n);if(!I.$empty[o.tagName.toLowerCase()]&&!m.isBookmarkNode(o))if(e.test(o.tagName))if(c){m.removeStyle(o,c);g(o)&&c!="text-decoration"&&m.remove(o,true)}else m.remove(o,true);else if(!I.$tableContent[o.tagName]&&
!I.$list[o.tagName]){m.removeAttributes(o,d);g(o)&&m.remove(o,true)}o=r}}o=k.start.parentNode;m.isBlockElm(o)&&!I.$tableContent[o.tagName]&&!I.$list[o.tagName]&&m.removeAttributes(o,d);o=k.end.parentNode;k.end&&m.isBlockElm(o)&&!I.$tableContent[o.tagName]&&!I.$list[o.tagName]&&m.removeAttributes(o,d);p.moveToBookmark(k).moveToBookmark(q);o=p.startContainer;for(r=p.collapsed;o.nodeType==1&&m.isEmptyNode(o)&&I.$removeEmpty[o.tagName];){q=o.parentNode;p.setStartBefore(o);p.startContainer===p.endContainer&&
p.endOffset--;m.remove(o);o=q}if(!r)for(o=p.endContainer;o.nodeType==1&&m.isEmptyNode(o)&&I.$removeEmpty[o.tagName];){q=o.parentNode;p.setEndBefore(o);m.remove(o);o=q}}var e=new RegExp("^(?:"+(f||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),d=c?[]:(a||this.options.removeFormatAttributes).split(",");h=new ea.Range(this.document);var k,j,n=function(p){return p.nodeType==1};h=this.selection.getRange();l(h);h.select()}}};UE.plugins.blockquote=function(){function h(f){return m.filterNodeList(f.selection.getStartElementPath(),
"blockquote")}this.commands.blockquote={execCommand:function(f,c){f=this.selection.getRange();var a=h(this),b=I.blockquote,g=f.createBookmark();if(a){c=f.startContainer;c=m.isBlockElm(c)?c:m.findParent(c,function(k){return m.isBlockElm(k)});b=f.endContainer;b=m.isBlockElm(b)?b:m.findParent(b,function(k){return m.isBlockElm(k)});c=m.findParentByTagName(c,"li",true)||c;b=m.findParentByTagName(b,"li",true)||b;c.tagName=="LI"||c.tagName=="TD"||c===a||m.isBody(c)?m.remove(a,true):m.breakParent(c,a);if(c!==
b)if(a=m.findParentByTagName(b,"blockquote"))if(b.tagName=="LI"||b.tagName=="TD"||m.isBody(b))a.parentNode&&m.remove(a,true);else m.breakParent(b,a);var l=m.getElementsByTagName(this.document,"blockquote");a=0;for(var e;e=l[a++];)if(e.childNodes.length)m.getPosition(e,c)&m.POSITION_FOLLOWING&&m.getPosition(e,b)&m.POSITION_PRECEDING&&m.remove(e,true);else m.remove(e)}else{a=f.cloneRange();e=l=a.startContainer.nodeType==1?a.startContainer:a.startContainer.parentNode;for(var d=1;;){if(m.isBody(l)){if(e!==
l)if(f.collapsed){a.selectNode(e);d=0}else a.setStartBefore(e);else a.setStart(l,0);break}if(!b[l.tagName]){f.collapsed?a.selectNode(e):a.setStartBefore(e);break}e=l;l=l.parentNode}if(d)for(e=l=l=a.endContainer.nodeType==1?a.endContainer:a.endContainer.parentNode;;){if(m.isBody(l)){e!==l?a.setEndAfter(e):a.setEnd(l,l.childNodes.length);break}if(!b[l.tagName]){a.setEndAfter(e);break}e=l;l=l.parentNode}l=f.document.createElement("blockquote");m.setAttributes(l,c);l.appendChild(a.extractContents());
a.insertNode(l);c=m.getElementsByTagName(l,"blockquote");for(a=0;b=c[a++];)b.parentNode&&m.remove(b,true)}f.moveToBookmark(g).select()},queryCommandState:function(){return h(this)?1:0}}};UE.commands.touppercase=UE.commands.tolowercase={execCommand:function(h){var f=this.selection.getRange();if(f.collapsed)return f;for(var c=f.createBookmark(),a=c.end,b=function(l){return!m.isBr(l)&&!m.isWhitespace(l)},g=m.getNextDomNode(c.start,false,b);g&&m.getPosition(g,a)&m.POSITION_PRECEDING;){if(g.nodeType==
3)g.nodeValue=g.nodeValue[h=="touppercase"?"toUpperCase":"toLowerCase"]();g=m.getNextDomNode(g,true,b);if(g===a)break}f.moveToBookmark(c).select()}};UE.commands.indent={execCommand:function(){this.execCommand("Paragraph","p",{style:"text-indent:"+(this.queryCommandState("indent")?"0em":this.options.indentValue||"2em")})},queryCommandState:function(){var h=m.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return h&&h.style.textIndent&&parseInt(h.style.textIndent)?1:0}};UE.commands.indent1=
{execCommand:function(h,f){h=this.queryCommandState("indent1");if(f=="del")h-=2;else h+=2;if(h>40)h=40;if(h<0)h=0;this.execCommand("Paragraph","p",{style:"text-indent:"+h+"em"})},queryCommandState:function(){var h=m.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return h&&h.style.textIndent&&parseInt(h.style.textIndent,10)?parseInt(h.style.textIndent,10):0}};UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1};UE.commands.preview={execCommand:function(){var h=
window.open("","_blank","").document;h.open();h.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"><\/script><script>setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)<\/script></head><body><div>"+this.getContent(null,null,true)+"</div></body></html>");h.close()},notNeedUndo:1};UE.plugins.selectall=function(){this.commands.selectall={execCommand:function(){var h=this.body,f=this.selection.getRange();
f.selectNodeContents(h);if(m.isEmptyBlock(h)){y.opera&&h.firstChild&&h.firstChild.nodeType==1&&f.setStartAtFirst(h.firstChild);f.collapse(true)}f.select(true)},notNeedUndo:1};this.addshortcutkey({selectAll:"ctrl+65"})};UE.plugins.paragraph=function(){var h=m.isBlockElm,f=["TD","LI","PRE"],c=function(a,b,g,l){var e=a.createBookmark(),d=function(o){return o.nodeType==1?o.tagName.toLowerCase()!="br"&&!m.isBookmarkNode(o):!m.isWhitespace(o)},k;a.enlarge(true);var j=a.createBookmark();k=m.getNextDomNode(j.start,
false,d);for(var n=a.cloneRange(),p;k&&!(m.getPosition(k,j.end)&m.POSITION_FOLLOWING);)if(k.nodeType==3||!h(k)){for(n.setStartBefore(k);k&&k!==j.end&&!h(k);){p=k;k=m.getNextDomNode(k,false,null,function(o){return!h(o)})}n.setEndAfter(p);k=a.document.createElement(b);if(g){m.setAttributes(k,g);if(l&&l=="customstyle"&&g.style)k.style.cssText=g.style}k.appendChild(n.extractContents());m.isEmptyNode(k)&&m.fillChar(a.document,k);k.id=n.startContainer.id?n.startContainer.id:ZU.getRandom();k.setAttribute("name",
"hTitle");n.insertNode(k);var q=k.parentNode;if(h(q)&&!m.isBody(k.parentNode)&&v.indexOf(f,q.tagName)==-1){if(!(l&&l=="customstyle")){q.getAttribute("dir")&&k.setAttribute("dir",q.getAttribute("dir"));q.style.cssText&&(k.style.cssText=q.style.cssText+";"+k.style.cssText);q.style.textAlign&&!k.style.textAlign&&(k.style.textAlign=q.style.textAlign);q.style.textIndent&&!k.style.textIndent&&(k.style.textIndent=q.style.textIndent);q.style.padding&&!k.style.padding&&(k.style.padding=q.style.padding)}if(g&&
/h\d/i.test(q.tagName)&&!/h\d/i.test(k.tagName)){m.setAttributes(q,g);if(l&&l=="customstyle"&&g.style)q.style.cssText=g.style;m.remove(k,true);k=q}else m.remove(k.parentNode,true)}k=v.indexOf(f,q.tagName)!=-1?q:k;k=m.getNextDomNode(k,false,d)}else k=m.getNextDomNode(k,true,d);return a.moveToBookmark(j).moveToBookmark(e)};this.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""});this.commands.paragraph={execCommand:function(a,b,g,l){a=this.selection.getRange();if(a.collapsed){var e=this.document.createTextNode("p");
a.insertNode(e);if(y.ie){var d=e.previousSibling;d&&m.isWhitespace(d)&&m.remove(d);(d=e.nextSibling)&&m.isWhitespace(d)&&m.remove(d)}}a=c(a,b,g,l);if(e){a.setStartBefore(e).collapse(true);pN=e.parentNode;m.remove(e);m.isBlockElm(pN)&&m.isEmptyNode(pN)&&m.fillNode(this.document,pN)}if(y.gecko&&a.collapsed&&a.startContainer.nodeType==1)(g=a.startContainer.childNodes[a.startOffset])&&g.nodeType==1&&g.tagName.toLowerCase()==b&&a.setStart(g,0).collapse(true);a.select();return true},queryCommandValue:function(){var a=
m.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return a?a.tagName.toLowerCase():""}}};(function(){var h=m.isBlockElm,f=function(a){return m.filterNodeList(a.selection.getStartElementPath(),function(b){return b&&b.nodeType==1&&b.getAttribute("dir")})},c=function(a,b,g){var l=function(p){return p.nodeType==1?!m.isBookmarkNode(p):!m.isWhitespace(p)};if((b=f(b))&&a.collapsed){b.setAttribute("dir",g);return a}b=a.createBookmark();a.enlarge(true);for(var e=a.createBookmark(),
d=m.getNextDomNode(e.start,false,l),k=a.cloneRange(),j;d&&!(m.getPosition(d,e.end)&m.POSITION_FOLLOWING);)if(d.nodeType==3||!h(d)){for(k.setStartBefore(d);d&&d!==e.end&&!h(d);){j=d;d=m.getNextDomNode(d,false,null,function(p){return!h(p)})}k.setEndAfter(j);d=k.getCommonAncestor();if(!m.isBody(d)&&h(d)){d.setAttribute("dir",g);d=d}else{d=a.document.createElement("p");d.setAttribute("dir",g);var n=k.extractContents();d.appendChild(n);k.insertNode(d);d=d}d=m.getNextDomNode(d,false,l)}else d=m.getNextDomNode(d,
true,l);return a.moveToBookmark(e).moveToBookmark(b)};UE.commands.directionality={execCommand:function(a,b){a=this.selection.getRange();if(a.collapsed){var g=this.document.createTextNode("d");a.insertNode(g)}c(a,this,b);if(g){a.setStartBefore(g).collapse(true);m.remove(g)}a.select();return true},queryCommandValue:function(){var a=f(this);return a?a.getAttribute("dir"):"ltr"}}})();UE.plugins.horizontal=function(){this.commands.horizontal={execCommand:function(h){if(this.queryCommandState(h)!==-1){this.execCommand("insertHtml",
"<hr>");h=this.selection.getRange();var f=h.startContainer;if(f.nodeType==1&&!f.childNodes[h.startOffset])if(f=f.childNodes[h.startOffset-1])if(f.nodeType==1&&f.tagName=="HR")if(this.options.enterTag=="p"){f=this.document.createElement("p");h.insertNode(f);h.setStart(f,0).setCursor()}else{f=this.document.createElement("br");h.insertNode(f);h.setStartBefore(f).setCursor()}return true}},queryCommandState:function(){return m.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}};this.addListener("delkeydown",
function(h,f){h=this.selection.getRange();h.txtToElmBoundary(true);if(m.isStartInblock(h)){var c=h.startContainer.previousSibling;if(c&&m.isTagNode(c,"hr")){m.remove(c);h.select();m.preventDefault(f);return true}}})};UE.commands.time=UE.commands.date={execCommand:function(h,f){function c(g,l){var e=("0"+g.getHours()).slice(-2),d=("0"+g.getMinutes()).slice(-2);g=("0"+g.getSeconds()).slice(-2);l=l||"hh:ii:ss";return l.replace(/hh/ig,e).replace(/ii/ig,d).replace(/ss/ig,g)}function a(g,l){var e=("000"+
g.getFullYear()).slice(-4),d=e.slice(-2),k=("0"+(g.getMonth()+1)).slice(-2);g=("0"+g.getDate()).slice(-2);l=l||"yyyy-mm-dd";return l.replace(/yyyy/ig,e).replace(/yy/ig,d).replace(/mm/ig,k).replace(/dd/ig,g)}var b=new Date;this.execCommand("insertHtml",h=="time"?c(b,f):a(b,f))}};UE.plugins.rowspacing=function(){this.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]});this.commands.rowspacing={execCommand:function(h,f,c){this.execCommand("paragraph","p",{style:"margin-"+
c+":"+f+"px"});return true},queryCommandValue:function(h,f){if(h=m.filterNodeList(this.selection.getStartElementPath(),function(c){return m.isBlockElm(c)})){f=m.getComputedStyle(h,"margin-"+f).replace(/[^\d]/g,"");return!f?0:f}return 0}}};UE.plugins.lineheight=function(){this.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]});this.commands.lineheight={execCommand:function(h,f){this.execCommand("paragraph","p",{style:"line-height:"+(f=="1"?"normal":f+"em")});return true},queryCommandValue:function(){var h=
m.filterNodeList(this.selection.getStartElementPath(),function(f){return m.isBlockElm(f)});if(h){h=m.getComputedStyle(h,"line-height");return h=="normal"?1:h.replace(/[^\d.]*/ig,"")}}}};UE.plugins.insertcode=function(){var h=this;h.ready(function(){v.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}",h.document)});h.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",
groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"});h.commands.insertcode={execCommand:function(f,c){var a=this.selection.getRange();if(f=m.findParentByTagName(a.startContainer,"pre",true))f.className="brush:"+c+";toolbar:false;";else{var b="";if(a.collapsed)b=y.ie&&y.ie11below?y.version<=8?"&nbsp;":"":"<br/>";else{f=a.extractContents();a=this.document.createElement("div");
a.appendChild(f);v.each(UE.filterNode(UE.htmlparser(a.innerHTML.replace(/[\r\t]/g,"")),this.options.filterTxtRules).children,function(g){if(y.ie&&y.ie11below&&y.version>8){if(g.type=="element")if(g.tagName=="br")b+="\n";else{if(!I.$empty[g.tagName]){v.each(g.children,function(l){if(l.type=="element")if(l.tagName=="br")b+="\n";else I.$empty[g.tagName]||(b+=l.innerText());else b+=l.data});/\n$/.test(b)||(b+="\n")}}else b+=g.data+"\n";if(!g.nextSibling()&&/\n$/.test(b))b=b.replace(/\n$/,"")}else if(y.ie&&
y.ie11below){if(g.type=="element")if(g.tagName=="br")b+="<br>";else{if(!I.$empty[g.tagName]){v.each(g.children,function(l){if(l.type=="element")if(l.tagName=="br")b+="<br>";else I.$empty[g.tagName]||(b+=l.innerText());else b+=l.data});/br>$/.test(b)||(b+="<br>")}}else b+=g.data+"<br>";if(!g.nextSibling()&&/<br>$/.test(b))b=b.replace(/<br>$/,"")}else{b+=g.type=="element"?I.$empty[g.tagName]?"":g.innerText():g.data;if(!/br\/?\s*>$/.test(b))if(g.nextSibling())b+="<br>"}})}this.execCommand("inserthtml",
'<pre id="coder"class="brush:'+c+';toolbar:false">'+b+"</pre>",true);f=this.document.getElementById("coder");m.removeAttributes(f,"id");if((c=f.previousSibling)&&(c.nodeType==3&&c.nodeValue.length==1&&y.ie&&y.version==6||m.isEmptyBlock(c)))m.remove(c);a=this.selection.getRange();m.isEmptyBlock(f)?a.setStart(f,0).setCursor(false,true):a.selectNodeContents(f).select()}},queryCommandValue:function(){var f=this.selection.getStartElementPath(),c="";v.each(f,function(a){if(a.nodeName=="PRE"){c=(a=a.className.match(/brush:([^;]+)/))&&
a[1]?a[1]:"";return false}});return c}};h.addInputRule(function(f){v.each(f.getNodesByTagName("pre"),function(c){var a=c.getNodesByTagName("br");if(a.length)y.ie&&y.ie11below&&y.version>8&&v.each(a,function(b){var g=UE.uNode.createText("\n");b.parentNode.insertBefore(g,b);b.parentNode.removeChild(b)});else if(!(y.ie&&y.ie11below&&y.version>8)){a=c.innerText().split(/\n/);c.innerHTML("");v.each(a,function(b){b.length&&c.appendChild(UE.uNode.createText(b));c.appendChild(UE.uNode.createElement("br"))})}})});
h.addOutputRule(function(f){v.each(f.getNodesByTagName("pre"),function(c){var a="";v.each(c.children,function(b){a+=b.type=="text"?b.data.replace(/[ ]/g,"&nbsp;").replace(/\n$/,""):b.tagName=="br"?"\n":!I.$empty[b.tagName]?"":b.innerText()});c.innerText(a.replace(/(&nbsp;|\n)+$/,""))})});h.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,insertcode:1,inserthtml:1,selectall:1};h.queryCommandState=function(f){if(!this.notNeedCodeQuery[f.toLowerCase()]&&
this.selection&&this.queryCommandValue("insertcode"))return-1;return UE.Editor.prototype.queryCommandState.apply(this,arguments)};h.addListener("beforeenterkeydown",function(){var f=h.selection.getRange(),c=m.findParentByTagName(f.startContainer,"pre",true);if(c){h.fireEvent("saveScene");f.collapsed||f.deleteContents();if(!y.ie||y.ie9above){c=h.document.createElement("br");f.insertNode(c).setStartAfter(c).collapse(true);!c.nextSibling&&(!y.ie||y.version>10)?f.insertNode(c.cloneNode(false)):f.setStartAfter(c);
c=c.previousSibling;for(var a;c;){a=c;c=c.previousSibling;if(!c||c.nodeName=="BR"){c=a;break}}if(c){for(a="";c&&c.nodeName!="BR"&&(new RegExp("^[\\s"+m.fillChar+"]*$")).test(c.nodeValue);){a+=c.nodeValue;c=c.nextSibling}if(c.nodeName!="BR")if((c=c.nodeValue.match(new RegExp("^([\\s"+m.fillChar+"]+)")))&&c[1])a+=c[1];if(a){a=h.document.createTextNode(a);f.insertNode(a).setStartAfter(a)}}f.collapse(true).select(true)}else if(y.version>8){c=h.document.createTextNode("\n");a=f.startContainer;if(f.startOffset==
0){if(a.previousSibling){f.insertNode(c);var b=h.document.createTextNode(" ");f.setStartAfter(c).insertNode(b).setStart(b,0).collapse(true).select(true)}}else{f.insertNode(c).setStartAfter(c);b=h.document.createTextNode(" ");(a=f.startContainer.childNodes[f.startOffset])&&!/^\n/.test(a.nodeValue)&&f.setStartBefore(c);f.insertNode(b).setStart(b,0).collapse(true).select(true)}}else{c=h.document.createElement("br");f.insertNode(c);f.insertNode(h.document.createTextNode(m.fillChar));f.setStartAfter(c);
for(c=c.previousSibling;c;){a=c;c=c.previousSibling;if(!c||c.nodeName=="BR"){c=a;break}}if(c){for(a="";c&&c.nodeName!="BR"&&(new RegExp("^[ "+m.fillChar+"]*$")).test(c.nodeValue);){a+=c.nodeValue;c=c.nextSibling}if(c.nodeName!="BR")if((c=c.nodeValue.match(new RegExp("^([ "+m.fillChar+"]+)")))&&c[1])a+=c[1];a=h.document.createTextNode(a);f.insertNode(a).setStartAfter(a)}f.collapse(true).select()}h.fireEvent("saveScene");return true}});h.addListener("tabkeydown",function(f,c){f=h.selection.getRange();
var a=m.findParentByTagName(f.startContainer,"pre",true);if(a){h.fireEvent("saveScene");if(!c.shiftKey)if(f.collapsed){a=h.document.createTextNode("    ");f.insertNode(a).setStartAfter(a).collapse(true).select(true)}else{c=f.createBookmark();for(var b=c.start.previousSibling;b;){if(a.firstChild===b&&!m.isBr(b)){a.insertBefore(h.document.createTextNode("    "),b);break}if(m.isBr(b)){a.insertBefore(h.document.createTextNode("    "),b.nextSibling);break}b=b.previousSibling}var g=c.end;b=c.start.nextSibling;
for(a.firstChild===c.start&&a.insertBefore(h.document.createTextNode("    "),b.nextSibling);b&&b!==g;){if(m.isBr(b)&&b.nextSibling){if(b.nextSibling===g)break;a.insertBefore(h.document.createTextNode("    "),b.nextSibling)}b=b.nextSibling}f.moveToBookmark(c).select()}h.fireEvent("saveScene");return true}});h.addListener("beforeinserthtml",function(f,c){var a=this;f=a.selection.getRange();if(m.findParentByTagName(f.startContainer,"pre",true)){f.collapsed||f.deleteContents();var b="";if(y.ie&&y.version>
8){v.each(UE.filterNode(UE.htmlparser(c),a.options.filterTxtRules).children,function(l){if(l.type=="element")if(l.tagName=="br")b+="\n";else{if(!I.$empty[l.tagName]){v.each(l.children,function(e){if(e.type=="element")if(e.tagName=="br")b+="\n";else I.$empty[l.tagName]||(b+=e.innerText());else b+=e.data});/\n$/.test(b)||(b+="\n")}}else b+=l.data+"\n";if(!l.nextSibling()&&/\n$/.test(b))b=b.replace(/\n$/,"")});c=a.document.createTextNode(v.html(b.replace(/&nbsp;/g," ")));f.insertNode(c).selectNode(c).select()}else{var g=
a.document.createDocumentFragment();v.each(UE.filterNode(UE.htmlparser(c),a.options.filterTxtRules).children,function(l){if(l.type=="element")if(l.tagName=="br")g.appendChild(a.document.createElement("br"));else{if(!I.$empty[l.tagName]){v.each(l.children,function(e){if(e.type=="element")if(e.tagName=="br")g.appendChild(a.document.createElement("br"));else I.$empty[l.tagName]||g.appendChild(a.document.createTextNode(v.html(e.innerText().replace(/&nbsp;/g," "))));else g.appendChild(a.document.createTextNode(v.html(e.data.replace(/&nbsp;/g,
" "))))});g.lastChild.nodeName!="BR"&&g.appendChild(a.document.createElement("br"))}}else g.appendChild(a.document.createTextNode(v.html(l.data.replace(/&nbsp;/g," "))));!l.nextSibling()&&g.lastChild.nodeName=="BR"&&g.removeChild(g.lastChild)});f.insertNode(g).select()}return true}});h.addListener("keydown",function(f,c){if((c.keyCode||c.which)==40){f=this.selection.getRange();var a,b=f.startContainer;if(f.collapsed&&(a=m.findParentByTagName(f.startContainer,"pre",true))&&!a.nextSibling){for(var g=
a.lastChild;g&&g.nodeName=="BR";)g=g.previousSibling;if(g===b||f.startContainer===a&&f.startOffset==a.childNodes.length){this.execCommand("insertparagraph");m.preventDefault(c)}}}});h.addListener("delkeydown",function(f,c){f=this.selection.getRange();f.txtToElmBoundary(true);var a=f.startContainer;if(m.isTagNode(a,"pre")&&f.collapsed&&m.isStartInblock(f)){var b=h.document.createElement("p");m.fillNode(h.document,b);a.parentNode.insertBefore(b,a);m.remove(a);f.setStart(b,0).setCursor(false,true);m.preventDefault(c);
return true}})};UE.commands.cleardoc={execCommand:function(){var h=this,f=h.options.enterTag,c=h.selection.getRange();if(f=="br"){h.body.innerHTML="<br/>";c.setStart(h.body,0).setCursor()}else{h.body.innerHTML="<p>"+(fa?"":"<br/>")+"</p>";c.setStart(h.body.firstChild,0).setCursor(false,true)}setTimeout(function(){h.fireEvent("clearDoc");treeUpdateAll()},0)}};UE.plugin.register("anchor",function(){return{bindEvents:{ready:function(){v.cssRule("anchor",".anchorclass{background: url('"+this.options.themePath+
this.options.theme+"/images/anchor.gif') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}",this.document)}},outputRule:function(h){v.each(h.getNodesByTagName("img"),function(f){var c;if(c=f.getAttr("anchorname")){f.tagName="a";f.setAttr({anchorname:"",name:c,"class":""})}})},inputRule:function(h){v.each(h.getNodesByTagName("a"),function(f){if(f.getAttr("name")&&!f.getAttr("href")){f.tagName="img";f.setAttr({anchorname:f.getAttr("name"),"class":"anchorclass"});
f.setAttr("name")}})},commands:{anchor:{execCommand:function(h,f){h=this.selection.getRange();var c=h.getClosedNode();if(c&&c.getAttribute("anchorname"))if(f)c.setAttribute("anchorname",f);else{h.setStartBefore(c).setCursor();m.remove(c)}else if(f){c=this.document.createElement("img");h.collapse(true);m.setAttributes(c,{anchorname:f,"class":"anchorclass"});h.insertNode(c).setStartAfter(c).setCursor(false,true)}}}}}});UE.plugins.wordcount=function(){var h=this;h.setOpt("wordCount",true);h.addListener("contentchange",
function(){h.fireEvent("wordcount")});var f;h.addListener("ready",function(){var c=this;m.on(c.body,"keyup",function(a){if(!((a.keyCode||a.which)in{"16":1,"18":1,"20":1,"37":1,"38":1,"39":1,"40":1})){clearTimeout(f);f=setTimeout(function(){c.fireEvent("wordcount")},200)}})})};UE.plugins.pagebreak=function(){function h(b){if(m.isEmptyBlock(b)){for(var g=b.firstChild,l;g&&g.nodeType==1&&m.isEmptyBlock(g);){l=g;g=g.firstChild}!l&&(l=b);m.fillNode(c.document,l)}}function f(b){return b&&b.nodeType==1&&
b.tagName=="HR"&&b.className=="pagebreak"}var c=this,a=["td"];c.setOpt("pageBreakTag","_ueditor_page_break_tag_");c.ready(function(){v.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",c.document)});c.addInputRule(function(b){b.traversal(function(g){if(g.type=="text"&&g.data==c.options.pageBreakTag){var l=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');g.parentNode.insertBefore(l,
g);g.parentNode.removeChild(g)}})});c.addOutputRule(function(b){v.each(b.getNodesByTagName("hr"),function(g){g.getAttr("class")})});c.commands.pagebreak={execCommand:function(){var b=c.selection.getRange(),g=c.document.createElement("hr");m.setAttributes(g,{"class":"pagebreak",noshade:"noshade",size:"5"});m.unSelectable(g);var l=m.findParentByTagName(b.startContainer,a,true),e=[];if(l)switch(l.tagName){case "TD":l=l.parentNode;if(l.previousSibling){l.parentNode.insertBefore(g,l);e=m.findParents(g)}else{b=
m.findParentByTagName(l,"table");b.parentNode.insertBefore(g,b);e=m.findParents(g,true)}l=e[1];g!==l&&m.breakParent(g,l);c.fireEvent("afteradjusttable",c.document)}else{if(!b.collapsed){b.deleteContents();for(l=b.startContainer;!m.isBody(l)&&m.isBlockElm(l)&&m.isEmptyNode(l);){b.setStartBefore(l).collapse(true);m.remove(l);l=b.startContainer}}b.insertNode(g);for(l=g.parentNode;!m.isBody(l);){m.breakParent(g,l);(l=g.nextSibling)&&m.isEmptyBlock(l)&&m.remove(l);l=g.parentNode}l=g.nextSibling;e=g.previousSibling;
if(f(e))m.remove(e);else e&&h(e);if(l){f(l)?m.remove(l):h(l);b.setEndAfter(g).collapse(false)}else{l=c.document.createElement("p");g.parentNode.appendChild(l);m.fillNode(c.document,l);b.setStart(l,0).collapse(true)}b.select(true)}}}};UE.plugin.register("wordimage",function(){var h=this,f=[];return{commands:{wordimage:{execCommand:function(){for(var c=m.getElementsByTagName(h.body,"img"),a=[],b=0,g;g=c[b++];)(g=g.getAttribute("word_img"))&&a.push(g);return a},queryCommandState:function(){f=m.getElementsByTagName(h.body,
"img");for(var c=0,a;a=f[c++];)if(a.getAttribute("word_img"))return 1;return-1},notNeedUndo:true}},inputRule:function(c){v.each(c.getNodesByTagName("img"),function(a){var b=a.attrs,g=parseInt(b.width)<128||parseInt(b.height)<43,l=h.options,e=l.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";if(b.src&&/^(?:(file:\/+))/.test(b.src))a.setAttr({width:b.width,height:b.height,alt:b.alt,word_img:b.src,src:e,style:"background:url("+(g?l.themePath+l.theme+"/images/word.gif":l.langPath+l.lang+"/images/localimage.png")+
") no-repeat center center;border:1px solid #ddd"})})}}});UE.plugins.dragdrop=function(){var h=this;h.ready(function(){m.on(this.body,"dragend",function(){var f=h.selection.getRange(),c=f.getClosedNode()||h.selection.getStart();if(c&&c.tagName=="IMG"){for(var a=c.previousSibling,b;b=c.nextSibling;)if(b.nodeType==1&&b.tagName=="SPAN"&&!b.firstChild)m.remove(b);else break;if((a&&a.nodeType==1&&!m.isEmptyBlock(a)||!a)&&(!b||b&&!m.isEmptyBlock(b))){if(a&&a.tagName=="P"&&!m.isEmptyBlock(a)){a.appendChild(c);
m.moveChild(b,a);m.remove(b)}else b&&b.tagName=="P"&&!m.isEmptyBlock(b)&&b.insertBefore(c,b.firstChild);a&&a.tagName=="P"&&m.isEmptyBlock(a)&&m.remove(a);b&&b.tagName=="P"&&m.isEmptyBlock(b)&&m.remove(b);f.selectNode(c).select();h.fireEvent("saveScene")}}})});h.addListener("keyup",function(f,c){if((c.keyCode||c.which)==13){f=h.selection.getRange();if(f=m.findParentByTagName(f.startContainer,"p",true))m.getComputedStyle(f,"text-align")=="center"&&m.removeStyle(f,"text-align")}})};UE.plugins.undo=function(){function h(r,
s){if(r.length!=s.length)return 0;for(var t=0,u=r.length;t<u;t++)if(r[t]!=s[t])return 0;return 1}function f(r,s){if(r.collapsed!=s.collapsed)return 0;if(!h(r.startAddress,s.startAddress)||!h(r.endAddress,s.endAddress))return 0;return 1}function c(){this.list=[];this.index=0;this.hasRedo=this.hasUndo=false;this.undo=function(){if(this.hasUndo)if(!this.list[this.index-1]&&this.list.length==1)this.reset();else{for(;this.list[this.index].content==this.list[this.index-1].content;){this.index--;if(this.index==
0)return this.restore(0)}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}};this.restore=function(){var r=this.editor,s=this.list[this.index],t=UE.htmlparser(s.content.replace(e,""));r.options.autoClearEmptyNode=false;r.filterInputRule(t);r.options.autoClearEmptyNode=k;r.document.body.innerHTML=t.toHtml();
r.fireEvent("afterscencerestore");y.ie&&v.each(m.getElementsByTagName(r.document,"td th caption p"),function(z){m.isEmptyNode(z)&&m.fillNode(r.document,z)});try{var u=(new ea.Range(r.document)).moveToAddress(s.address);u.select(d[u.startContainer.nodeName.toLowerCase()])}catch(x){}this.update();this.clearKey();r.fireEvent("reset",true)};this.getScene=function(){var r=this.editor,s=r.selection.getRange().createAddress(false,true);r.fireEvent("beforegetscene");var t=UE.htmlparser(r.body.innerHTML);
r.options.autoClearEmptyNode=false;r.filterOutputRule(t);r.options.autoClearEmptyNode=k;t=t.toHtml();r.fireEvent("aftergetscene");return{address:s,content:t}};this.save=function(r,s){clearTimeout(a);s=this.getScene(s);var t=this.list[this.index];t&&t.content!=s.content&&b.trigger("contentchange");if(!(t&&t.content==s.content&&(r?1:f(t.address,s.address)))){this.list=this.list.slice(0,this.index+1);this.list.push(s);this.list.length>g&&this.list.shift();this.index=this.list.length-1;this.clearKey();
this.update()}};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1]};this.reset=function(){this.list=[];this.index=0;this.hasRedo=this.hasUndo=false;this.clearKey()};this.clearKey=function(){n=0;p=null}}var a,b=this,g=b.options.maxUndoCount||20,l=b.options.maxInputCount||20,e=new RegExp(m.fillChar+"|</hr>","gi"),d={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},k=b.options.autoClearEmptyNode;b.undoManger=new c;b.undoManger.editor=b;b.addListener("saveScene",
function(){this.undoManger.save.apply(this.undoManger,Array.prototype.splice.call(arguments,1))});b.addListener("reset",function(r,s){s||this.undoManger.reset()});b.commands.redo=b.commands.undo={execCommand:function(r){this.undoManger[r]()},queryCommandState:function(r){return this.undoManger["has"+(r.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var j={16:1,17:1,18:1,37:1,38:1,39:1,40:1},n=0,p,q=false;b.addListener("ready",function(){m.on(this.body,"compositionstart",function(){q=true});
m.on(this.body,"compositionend",function(){q=false})});b.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var o=true;b.addListener("keydown",function(r,s){var t=this;r=s.keyCode||s.which;if(!j[r]&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey)if(!q)if(t.selection.getRange().collapsed){t.undoManger.list.length==0&&t.undoManger.save(true);clearTimeout(a);var u=function(x){x.undoManger.save(false,true);x.fireEvent("selectionchange")};a=setTimeout(function(){if(q)var x=setInterval(function(){if(!q){u(t);
clearInterval(x)}},300);else u(t)},200);p=r;n++;n>=l&&u(t)}else{t.undoManger.save(false,true);o=false}});b.addListener("keyup",function(r,s){if(!j[s.keyCode||s.which]&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey)if(!q)if(!o){this.undoManger.save(false,true);o=true}});b.stopCmdUndo=function(){b.__hasEnterExecCommand=true};b.startCmdUndo=function(){b.__hasEnterExecCommand=false}};UE.plugin.register("copy",function(){function h(){ZeroClipboard.config({debug:false,swfPath:f.options.UEDITOR_HOME_URL+
"third-party/zeroclipboard/ZeroClipboard.swf"});var c=f.zeroclipboard=new ZeroClipboard;c.on("copy",function(a){a=a.client;var b=f.selection.getRange(),g=document.createElement("div");g.appendChild(b.cloneContents());a.setText(g.innerText||g.textContent);a.setHtml(g.innerHTML);b.select()});c.on("mouseover mouseout",function(a){var b=a.target;if(a.type=="mouseover")m.addClass(b,"edui-state-hover");else a.type=="mouseout"&&m.removeClasses(b,"edui-state-hover")});c.on("wrongflash noflash",function(){ZeroClipboard.destroy()});
f.zeroclipboard.clip(ZU.$id("copyButton"))}var f=this;return{bindEvents:{ready:function(){y.ie||(window.ZeroClipboard?h():v.loadFile(document,{src:f.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){h()}))}},commands:{copy:{execCommand:function(){f.document.execCommand("copy")||alert(f.getLang("copymsg"))}}}}});UE.plugins.paste=function(){function h(e){var d=this.document;if(!d.getElementById("baidu_pastebin")){var k=
this.selection.getRange(),j=k.createBookmark(),n=d.createElement("div");n.id="baidu_pastebin";y.webkit&&n.appendChild(d.createTextNode(m.fillChar+m.fillChar));d.body.appendChild(n);j.start.style.display="";n.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+m.getXY(j.start).y+"px";k.selectNodeContents(n).select(true);setTimeout(function(){if(y.webkit)for(var p=0,q=d.querySelectorAll("#baidu_pastebin"),o;o=q[p++];)if(m.isEmptyNode(o))m.remove(o);
else{n=o;break}try{n.parentNode.removeChild(n)}catch(r){}k.moveToBookmark(j).select(true);e(n)},0)}}function f(e){return e.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(d,k,j,n){j=j.toLowerCase();if({img:1}[j])return d;n=n.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(p,q,o){if({src:1,href:1,name:1}[q.toLowerCase()])return q+"="+o+" ";return""});return{span:1,div:1}[j]?"":"<"+k+j+" "+v.trim(n)+">"})}function c(e){var d;if(e.firstChild){d=m.getElementsByTagName(e,"span");
for(var k=0,j;j=d[k++];)if(j.id=="_baidu_cut_start"||j.id=="_baidu_cut_end")m.remove(j);if(y.webkit){j=e.querySelectorAll("div br");for(k=0;d=j[k++];){d=d.parentNode;if(d.tagName=="DIV"&&d.childNodes.length==1){d.innerHTML="<p><br/></p>";m.remove(d)}}d=e.querySelectorAll("#baidu_pastebin");for(k=0;j=d[k++];){var n=a.document.createElement("p");for(j.parentNode.insertBefore(n,j);j.firstChild;)n.appendChild(j.firstChild);m.remove(j)}j=e.querySelectorAll("meta");for(k=0;d=j[k++];)m.remove(d);j=e.querySelectorAll("br");
for(k=0;d=j[k++];)/^apple-/i.test(d.className)&&m.remove(d)}if(y.gecko){j=e.querySelectorAll("[_moz_dirty]");for(k=0;d=j[k++];)d.removeAttribute("_moz_dirty")}if(!y.ie){j=e.querySelectorAll("span.Apple-style-span");for(k=0;d=j[k++];)m.remove(d,true)}j=e.getElementsByTagName("*");for(k=0;k<j.length;k++){d=j[k];d.nodeType==1&&d.id&&d.id!=""&&d.nodeName.toLowerCase()!="img"&&d.removeAttribute("id")}j=e.querySelectorAll("h1,h2,h3,h4,h5,h6");for(k=0;k<j.length;k++){d=j[k];d.id=ZU.getRandom()}d=e.innerHTML;
d=UE.filterWord(d);k=UE.htmlparser(d);a.options.filterRules&&UE.filterNode(k,a.options.filterRules);a.filterInputRule(k);if(y.webkit){(d=k.lastChild())&&d.type=="element"&&d.tagName=="br"&&k.removeChild(d);v.each(a.body.querySelectorAll("div"),function(p){m.isEmptyBlock(p)&&m.remove(p,true)})}d={html:k.toHtml()};a.fireEvent("beforepaste",d,k);if(d.html){e.innerHTML=d.html;j=e.getElementsByTagName("img");n=[];for(k=0;k<j.length;k++)j[k].getAttribute("anchorname")&&j[k].className=="anchorclass"&&n.push(j[k]);
for(k=0;k<n.length;k++)ZU.removeChild(n[k]);d.html=e.innerHTML;k=UE.htmlparser(d.html,true);if(a.queryCommandState("pasteplain")===1)a.execCommand("insertHtml",UE.filterNode(k,a.options.filterTxtRules).toHtml(),true);else{UE.filterNode(k,a.options.filterTxtRules);b=k.toHtml();g=d.html;l=a.selection.getRange().createAddress(true);a.execCommand("insertHtml",a.getOpt("retainOnlyLabelPasted")===true?f(g):g,true)}a.fireEvent("afterpaste",d)}}}var a=this;a.setOpt({retainOnlyLabelPasted:false});var b,g,
l;a.addListener("pasteTransfer",function(e,d){if(l&&b&&g&&b!=g){e=a.selection.getRange();e.moveToAddress(l,true);if(!e.collapsed){for(;!m.isBody(e.startContainer);){var k=e.startContainer;if(k.nodeType==1){k=k.childNodes[e.startOffset];if(!k){e.setStartBefore(e.startContainer);continue}(k=k.previousSibling)&&k.nodeType==3&&(new RegExp("^[\n\r\t "+m.fillChar+"]*$")).test(k.nodeValue)&&e.setStartBefore(k)}if(e.startOffset==0)e.setStartBefore(e.startContainer);else break}for(;!m.isBody(e.endContainer);){k=
e.endContainer;if(k.nodeType==1){k=k.childNodes[e.endOffset];if(!k){e.setEndAfter(e.endContainer);continue}(k=k.nextSibling)&&k.nodeType==3&&(new RegExp("^[\n\r\t"+m.fillChar+"]*$")).test(k.nodeValue)&&e.setEndAfter(k)}if(e.endOffset==e.endContainer[e.endContainer.nodeType==3?"nodeValue":"childNodes"].length)e.setEndAfter(e.endContainer);else break}}e.deleteContents();e.select(true);a.__hasEnterExecCommand=true;e=g;if(d===2)e=f(e);else if(d)e=b;a.execCommand("inserthtml",e,true);a.__hasEnterExecCommand=
false;for(d=a.selection.getRange();!m.isBody(d.startContainer)&&!d.startOffset&&d.startContainer[d.startContainer.nodeType==3?"nodeValue":"childNodes"].length;)d.setStartBefore(d.startContainer);d=d.createAddress(true);l.endAddress=d.startAddress}});a.addListener("ready",function(){m.on(a.body,"cut",function(){!a.selection.getRange().collapsed&&a.undoManger&&a.undoManger.save()});m.on(a.body,y.ie||y.opera?"keydown":"paste",function(e){(y.ie||y.opera)&&(!e.ctrlKey&&!e.metaKey||e.keyCode!="86")||h.call(a,
function(d){c(d)})})});a.commands.paste={execCommand:function(){if(y.ie){h.call(a,function(e){c(e)});a.document.execCommand("paste")}else alert(a.getLang("pastemsg"))}}};UE.plugins.pasteplain=function(){this.setOpt({pasteplain:false,filterTxtRules:function(){function f(a){a.tagName="p";a.setStyle()}function c(a){a.parentNode.removeChild(a,true)}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(a){for(var b,g=UE.uNode.createElement("p");b=a.firstChild();)if(b.type==
"text"||!UE.dom.dtd.$block[b.tagName])g.appendChild(b);else if(g.firstChild()){a.parentNode.insertBefore(g,a);g=UE.uNode.createElement("p")}else a.parentNode.insertBefore(b,a);g.firstChild()&&a.parentNode.insertBefore(g,a);a.parentNode.removeChild(a)},ol:c,ul:c,dl:c,dt:c,dd:c,li:c,caption:f,th:f,tr:f,h1:f,h2:f,h3:f,h4:f,h5:f,h6:f,td:function(a){a.innerText()&&a.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),a);a.parentNode.removeChild(a,a.innerText())}}}()});var h=this.options.pasteplain;
this.commands.pasteplain={queryCommandState:function(){return h?1:0},execCommand:function(){h=!h|0},notNeedUndo:1}};UE.plugins.list=function(){function h(q){var o=[];for(var r in q)o.push(r);return o}function f(q){var o=q.className;if(m.hasClass(q,/custom_/))return o.match(/custom_(\w+)/)[1];return m.getStyle(q,"list-style-type")}function c(q,o){v.each(m.getElementsByTagName(q,"ol ul"),function(r){if(m.inDoc(r,q)){var s=r.parentNode;if(s.tagName==r.tagName){var t=f(r)||(r.tagName=="OL"?"decimal":
"disc"),u=f(s)||(s.tagName=="OL"?"decimal":"disc");if(t==u){t=v.indexOf(j[r.tagName],t);t=t+1==j[r.tagName].length?0:t+1;b(r,j[r.tagName][t])}}var x=0;t=2;if(m.hasClass(r,/custom_/))/[ou]l/i.test(s.tagName)&&m.hasClass(s,/custom_/)||(t=1);else if(/[ou]l/i.test(s.tagName)&&m.hasClass(s,/custom_/))t=3;(s=m.getStyle(r,"list-style-type"))&&(r.style.cssText="list-style-type:"+s);r.className=v.trim(r.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+t;v.each(m.getElementsByTagName(r,"li"),
function(z){z.style.cssText&&(z.style.cssText="");if(z.firstChild){if(z.parentNode===r){x++;if(m.hasClass(r,/custom_/)){var F=1,D=f(r);if(r.tagName=="OL"){if(D)switch(D){case "cn":case "cn1":case "cn2":if(x>10&&(x%10==0||x>10&&x<20))F=2;else if(x>20)F=3;break;case "num2":if(x>9)F=2}z.className="list-"+k[D]+x+" list-"+D+"-paddingleft-"+F}else z.className="list-"+k[D]+" list-"+D+"-paddingleft"}else z.className=z.className.replace(/list-[\w\-]+/gi,"");F=z.getAttribute("class");F!==null&&!F.replace(/\s/g,
"")&&m.removeAttributes(z,"class")}}else m.remove(z)});!o&&a(r,r.tagName.toLowerCase(),f(r)||m.getStyle(r,"list-style-type"),true)}})}function a(q,o,r,s){var t=q.nextSibling;if(t&&t.nodeType==1&&t.tagName.toLowerCase()==o&&(f(t)||m.getStyle(t,"list-style-type")||(o=="ol"?"decimal":"disc"))==r){m.moveChild(t,q);t.childNodes.length==0&&m.remove(t)}t&&m.isFillChar(t)&&m.remove(t);if((t=q.previousSibling)&&t.nodeType==1&&t.tagName.toLowerCase()==o&&(f(t)||m.getStyle(t,"list-style-type")||(o=="ol"?"decimal":
"disc"))==r)m.moveChild(q,t);t&&m.isFillChar(t)&&m.remove(t);!s&&m.isEmptyBlock(q)&&m.remove(q);f(q)&&c(q.ownerDocument,true)}function b(q,o){if(k[o])q.className="custom_"+o;try{m.setStyle(q,"list-style-type",o)}catch(r){}}function g(q){var o=q.previousSibling;o&&m.isEmptyBlock(o)&&m.remove(o);(o=q.nextSibling)&&m.isEmptyBlock(o)&&m.remove(o)}function l(q){for(;q&&!m.isBody(q);){if(q.nodeName=="TABLE")return null;if(q.nodeName=="LI")return q;q=q.parentNode}}var e=this,d={TD:1,PRE:1,BLOCKQUOTE:1},
k={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};e.setOpt({autoTransWordToList:false,insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1,disablePInList:false});var j={OL:h(e.options.insertorderedlist),UL:h(e.options.insertunorderedlist)},
n=e.options.listiconpath;for(var p in k)!e.options.insertorderedlist.hasOwnProperty(p)&&!e.options.insertunorderedlist.hasOwnProperty(p)&&delete k[p];e.ready(function(){var q=[];for(var o in k){if(o=="dash"||o=="dot"){q.push("li.list-"+k[o]+"{background-image:url("+n+k[o]+".gif)}");q.push("ul.custom_"+o+"{list-style:none;}ul.custom_"+o+" li{background-position:0 3px;background-repeat:no-repeat}")}else{for(var r=0;r<99;r++)q.push("li.list-"+k[o]+r+"{background-image:url("+n+"list-"+k[o]+r+".gif)}");
q.push("ol.custom_"+o+"{list-style:none;}ol.custom_"+o+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(o){case "cn":q.push("li.list-"+o+"-paddingleft-1{padding-left:25px}");q.push("li.list-"+o+"-paddingleft-2{padding-left:40px}");q.push("li.list-"+o+"-paddingleft-3{padding-left:55px}");break;case "cn1":q.push("li.list-"+o+"-paddingleft-1{padding-left:30px}");q.push("li.list-"+o+"-paddingleft-2{padding-left:40px}");q.push("li.list-"+o+"-paddingleft-3{padding-left:55px}");break;
case "cn2":q.push("li.list-"+o+"-paddingleft-1{padding-left:40px}");q.push("li.list-"+o+"-paddingleft-2{padding-left:55px}");q.push("li.list-"+o+"-paddingleft-3{padding-left:68px}");break;case "num":case "num1":q.push("li.list-"+o+"-paddingleft-1{padding-left:25px}");break;case "num2":q.push("li.list-"+o+"-paddingleft-1{padding-left:35px}");q.push("li.list-"+o+"-paddingleft-2{padding-left:40px}");break;case "dash":q.push("li.list-"+o+"-paddingleft{padding-left:35px}");break;case "dot":q.push("li.list-"+
o+"-paddingleft{padding-left:20px}")}}q.push(".list-paddingleft-1{padding-left:0}");q.push(".list-paddingleft-2{padding-left:"+e.options.listDefaultPaddingLeft+"px}");q.push(".list-paddingleft-3{padding-left:"+e.options.listDefaultPaddingLeft*2+"px}");v.cssRule("list","ol,ul{margin:0;pading:0;"+(y.ie?"":"width:95%")+"}li{clear:both;}"+q.join("\n"),e.document)});e.ready(function(){m.on(e.body,"cut",function(){setTimeout(function(){var q=e.selection.getRange(),o;if(!q.collapsed)if(o=m.findParentByTagName(q.startContainer,
"li",true))if(!o.nextSibling&&m.isEmptyBlock(o)){o=o.parentNode;var r;if(r=o.previousSibling){m.remove(o);q.setStartAtLast(r).collapse(true)}else if(r=o.nextSibling){m.remove(o);q.setStartAtFirst(r).collapse(true)}else{r=e.document.createElement("p");m.fillNode(e.document,r);o.parentNode.insertBefore(r,o);m.remove(o);q.setStart(r,0).collapse(true)}q.select(true)}})})});e.addListener("beforepaste",function(q,o){var r=this.selection.getRange(),s=UE.htmlparser(o.html,true);if(r=m.findParentByTagName(r.startContainer,
"li",true)){var t=r.parentNode;v.each(s.getNodesByTagName(t.tagName=="OL"?"ul":"ol"),function(u){u.tagName=t.tagName;u.setAttr();if(u.parentNode===s)q=f(t)||(t.tagName=="OL"?"decimal":"disc");else{var x=u.parentNode.getAttr("class");(q=x&&/custom_/.test(x)?x.match(/custom_(\w+)/)[1]:u.parentNode.getStyle("list-style-type"))||(q=t.tagName=="OL"?"decimal":"disc")}x=v.indexOf(j[t.tagName],q);if(u.parentNode!==s)x=x+1==j[t.tagName].length?0:x+1;x=j[t.tagName][x];k[x]?u.setAttr("class","custom_"+x):u.setStyle("list-style-type",
x)})}o.html=s.toHtml()});e.getOpt("disablePInList")===true&&e.addOutputRule(function(q){v.each(q.getNodesByTagName("li"),function(o){var r=[],s=0;v.each(o.children,function(t){if(t.tagName=="p"){for(var u;u=t.children.pop();){r.splice(s,0,u);u.parentNode=o;lastNode=u}u=r[r.length-1];if(!u||u.type!="element"||u.tagName!="br"){t=UE.uNode.createElement("br");t.parentNode=o;r.push(t)}s=r.length}});if(r.length)o.children=r})});e.addInputRule(function(q){v.each(q.getNodesByTagName("li"),function(t){for(var u=
UE.uNode.createElement("p"),x=0,z;z=t.children[x];)if(z.type=="text"||I.p[z.tagName])u.appendChild(z);else if(u.firstChild()){t.insertBefore(u,z);u=UE.uNode.createElement("p");x+=2}else x++;if(u.firstChild()&&!u.parentNode||!t.firstChild())t.appendChild(u);u.firstChild()||u.innerHTML(y.ie?"&nbsp;":"<br/>");t=t.firstChild();(u=t.lastChild())&&u.type=="text"&&/^\s*$/.test(u.data)&&t.removeChild(u)});if(e.options.autoTransWordToList){var o={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,
cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},r={square:"n"},s=function(t,u){if((u=u.firstChild())&&u.type=="element"&&u.tagName=="span"&&/Wingdings|Symbol/.test(u.getStyle("font-family"))){for(var x in r)if(r[x]==u.data)return x;return"disc"}for(x in o)if(o[x].test(t))return x};v.each(q.getNodesByTagName("p"),function(t){function u(M,L,Q){if(M.tagName=="ol")if(y.ie){var S=L.firstChild();S.type=="element"&&
S.tagName=="span"&&o[Q].test(S.innerText())&&L.removeChild(S)}else L.innerHTML(L.innerHTML().replace(o[Q],""));else L.removeChild(L.firstChild());Q=UE.uNode.createElement("li");Q.appendChild(L);M.appendChild(Q)}if(t.getAttr("class")=="MsoListParagraph"){t.setStyle("margin","");t.setStyle("margin-left","");t.setAttr("class","");var x=t,z,F=t;if(t.parentNode.tagName!="li"&&(z=s(t.innerText(),t))){var D=UE.uNode.createElement(e.options.insertorderedlist.hasOwnProperty(z)?"ol":"ul");for(k[z]?D.setAttr("class",
"custom_"+z):D.setStyle("list-style-type",z);t&&t.parentNode.tagName!="li"&&s(t.innerText(),t);){(x=t.nextSibling())||t.parentNode.insertBefore(D,t);u(D,t,z);t=x}!D.parentNode&&t&&t.parentNode&&t.parentNode.insertBefore(D,t)}(t=F.firstChild())&&t.type=="element"&&t.tagName=="span"&&/^\s*(&nbsp;)+\s*$/.test(t.innerText())&&t.parentNode.removeChild(t)}})}});e.addListener("contentchange",function(){c(e.document)});e.addListener("keydown",function(q,o){function r(){o.preventDefault?o.preventDefault():
(o.returnValue=false);e.fireEvent("contentchange");e.undoManger&&e.undoManger.save()}function s(M,L){for(;M&&!m.isBody(M);){if(L(M))return null;if(M.nodeType==1&&/[ou]l/i.test(M.tagName))return M;M=M.parentNode}return null}q=o.keyCode||o.which;if(q==13&&!o.shiftKey){var t=e.selection.getRange(),u=m.findParent(t.startContainer,function(M){return m.isBlockElm(M)},true),x=m.findParentByTagName(t.startContainer,"li",true);if(u&&u.tagName!="PRE"&&!x){x=u.innerHTML.replace(new RegExp(m.fillChar,"g"),"");
if(/^\s*1\s*\.[^\d]/.test(x)){u.innerHTML=x.replace(/^\s*1\s*\./,"");t.setStartAtLast(u).collapse(true).select();e.__hasEnterExecCommand=true;e.execCommand("insertorderedlist");e.__hasEnterExecCommand=false}}t=e.selection.getRange();u=s(t.startContainer,function(M){return M.tagName=="TABLE"});x=t.collapsed?u:s(t.endContainer,function(M){return M.tagName=="TABLE"});if(u&&x&&u===x){if(!t.collapsed){u=m.findParentByTagName(t.startContainer,"li",true);x=m.findParentByTagName(t.endContainer,"li",true);
if(u&&x&&u===x){t.deleteContents();if((x=m.findParentByTagName(t.startContainer,"li",true))&&m.isEmptyBlock(x)){D=x.previousSibling;next=x.nextSibling;u=e.document.createElement("p");m.fillNode(e.document,u);F=x.parentNode;if(D&&next){t.setStart(next,0).collapse(true).select(true);m.remove(x)}else{!D&&!next||!D?F.parentNode.insertBefore(u,F):x.parentNode.parentNode.insertBefore(u,F.nextSibling);m.remove(x);F.firstChild||m.remove(F);t.setStart(u,0).setCursor()}r();return}}else{u=t.cloneRange();var z=
u.collapse(false).createBookmark();t.deleteContents();u.moveToBookmark(z);x=m.findParentByTagName(u.startContainer,"li",true);g(x);u.select();r();return}}if(x=m.findParentByTagName(t.startContainer,"li",true)){if(m.isEmptyBlock(x)){z=t.createBookmark();var F=x.parentNode;if(x!==F.lastChild){m.breakParent(x,F);g(x)}else{F.parentNode.insertBefore(x,F.nextSibling);m.isEmptyNode(F)&&m.remove(F)}if(!I.$list[x.parentNode.tagName])if(m.isBlockElm(x.firstChild))m.remove(x,true);else{u=e.document.createElement("p");
for(x.parentNode.insertBefore(u,x);x.firstChild;)u.appendChild(x.firstChild);m.remove(x)}t.moveToBookmark(z).select()}else{u=x.firstChild;if(!u||!m.isBlockElm(u)){u=e.document.createElement("p");for(!x.firstChild&&m.fillNode(e.document,u);x.firstChild;)u.appendChild(x.firstChild);x.appendChild(u);u=u}z=e.document.createElement("span");t.insertNode(z);m.breakParent(z,x);D=z.nextSibling;u=D.firstChild;if(!u){u=e.document.createElement("p");m.fillNode(e.document,u);D.appendChild(u);u=u}if(m.isEmptyNode(u)){u.innerHTML=
"";m.fillNode(e.document,u)}t.setStart(u,0).collapse(true).shrinkBoundary().select();m.remove(z);var D=D.previousSibling;if(D&&m.isEmptyBlock(D)){D.innerHTML="<p></p>";m.fillNode(e.document,D.firstChild)}}r()}}}if(q==8){t=e.selection.getRange();if(t.collapsed&&m.isStartInblock(t)){u=t.cloneRange().trimBoundary();if((x=m.findParentByTagName(t.startContainer,"li",true))&&m.isStartInblock(u))if((u=m.findParentByTagName(t.startContainer,"p",true))&&u!==x.firstChild){F=m.findParentByTagName(u,["ol","ul"]);
m.breakParent(u,F);g(u);e.fireEvent("contentchange");t.setStart(u,0).setCursor(false,true);e.fireEvent("saveScene");m.preventDefault(o)}else if(x&&(D=x.previousSibling)){if(!(q==46&&x.childNodes.length)){if(I.$list[D.tagName])D=D.lastChild;e.undoManger&&e.undoManger.save();u=x.firstChild;if(m.isBlockElm(u))if(m.isEmptyNode(u)){D.appendChild(u);for(t.setStart(u,0).setCursor(false,true);x.firstChild;)D.appendChild(x.firstChild)}else{z=e.document.createElement("span");t.insertNode(z);if(m.isEmptyBlock(D))D.innerHTML=
"";m.moveChild(x,D);t.setStartBefore(z).collapse(true).select(true);m.remove(z)}else if(m.isEmptyNode(x)){u=e.document.createElement("p");D.appendChild(u);t.setStart(u,0).setCursor()}else for(t.setEnd(D,D.childNodes.length).collapse().select(true);x.firstChild;)D.appendChild(x.firstChild);m.remove(x);e.fireEvent("contentchange");e.fireEvent("saveScene");m.preventDefault(o)}}else if(x&&!x.previousSibling){F=x.parentNode;z=t.createBookmark();if(m.isTagNode(F.parentNode,"ol ul"))F.parentNode.insertBefore(x,
F);else{for(;x.firstChild;)F.parentNode.insertBefore(x.firstChild,F);m.remove(x)}m.isEmptyNode(F)&&m.remove(F);t.moveToBookmark(z).setCursor(false,true);e.fireEvent("contentchange");e.fireEvent("saveScene");m.preventDefault(o)}}}});e.addListener("keyup",function(q,o){if((o.keyCode||o.which)==8){q=e.selection.getRange();if(q=m.findParentByTagName(q.startContainer,["ol","ul"],true))a(q,q.tagName.toLowerCase(),f(q)||m.getComputedStyle(q,"list-style-type"),true)}});e.addListener("tabkeydown",function(){function q(D){if(e.options.maxListLevel!=
-1){D=D.parentNode;for(var M=0;/[ou]l/i.test(D.tagName);){M++;D=D.parentNode}if(M>=e.options.maxListLevel)return true}}var o=e.selection.getRange(),r=m.findParentByTagName(o.startContainer,"li",true);if(r){var s;if(o.collapsed){if(q(r))return true;var t=r.parentNode,u=e.document.createElement(t.tagName),x=v.indexOf(j[u.tagName],f(t)||m.getComputedStyle(t,"list-style-type"));x=x+1==j[u.tagName].length?0:x+1;x=j[u.tagName][x];b(u,x);if(m.isStartInblock(o)){e.fireEvent("saveScene");s=o.createBookmark();
t.insertBefore(u,r);u.appendChild(r);a(u,u.tagName.toLowerCase(),x);e.fireEvent("contentchange");o.moveToBookmark(s).select(true);return true}}else{e.fireEvent("saveScene");s=o.createBookmark();t=0;var z;u=m.findParents(r);for(var F;F=u[t++];)if(m.isTagNode(F,"ol ul")){z=F;break}F=r;if(s.end)for(;F&&!(m.getPosition(F,s.end)&m.POSITION_FOLLOWING);)if(q(F))F=m.getNextDomNode(F,false,null,function(D){return D!==z});else{t=F.parentNode;u=e.document.createElement(t.tagName);x=v.indexOf(j[u.tagName],f(t)||
m.getComputedStyle(t,"list-style-type"));x=j[u.tagName][x+1==j[u.tagName].length?0:x+1];b(u,x);for(t.insertBefore(u,F);F&&!(m.getPosition(F,s.end)&m.POSITION_FOLLOWING);){r=F.nextSibling;u.appendChild(F);if(!r||m.isTagNode(r,"ol ul")){if(r)for(;r=r.firstChild;){if(r.tagName=="LI")break}else r=m.getNextDomNode(F,false,null,function(D){return D!==z});break}F=r}a(u,u.tagName.toLowerCase(),x);F=r}e.fireEvent("contentchange");o.moveToBookmark(s).select();return true}}});e.commands.insertorderedlist=e.commands.insertunorderedlist=
{execCommand:function(q,o){o||(o=q.toLowerCase()=="insertorderedlist"?"decimal":"disc");var r=this.selection.getRange(),s=function(Z){return Z.nodeType==1?Z.tagName.toLowerCase()!="br":!m.isWhitespace(Z)},t=q.toLowerCase()=="insertorderedlist"?"ol":"ul",u=this.document.createDocumentFragment();r.adjustmentBoundary().shrinkBoundary();var x=r.createBookmark(true),z=l(this.document.getElementById(x.start)),F=0,D=l(this.document.getElementById(x.end)),M=0,L,Q,S,R;if(z||D){z&&(L=z.parentNode);x.end||(D=
z);D&&(Q=D.parentNode);if(L===Q){for(;z!==D;){R=z;z=z.nextSibling;if(!m.isBlockElm(R.firstChild)){for(s=this.document.createElement("p");R.firstChild;)s.appendChild(R.firstChild);R.appendChild(s)}u.appendChild(R)}R=this.document.createElement("span");L.insertBefore(R,D);if(!m.isBlockElm(D.firstChild)){for(s=this.document.createElement("p");D.firstChild;)s.appendChild(D.firstChild);D.appendChild(s)}u.appendChild(D);m.breakParent(R,L);m.isEmptyNode(R.previousSibling)&&m.remove(R.previousSibling);m.isEmptyNode(R.nextSibling)&&
m.remove(R.nextSibling);s=f(L)||m.getComputedStyle(L,"list-style-type")||(q.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(L.tagName.toLowerCase()==t&&s==o){D=0;for(D=this.document.createDocumentFragment();s=u.firstChild;)if(m.isTagNode(s,"ol ul"))D.appendChild(s);else for(;s.firstChild;){D.appendChild(s.firstChild);m.remove(s)}R.parentNode.insertBefore(D,R)}else{S=this.document.createElement(t);b(S,o);S.appendChild(u);R.parentNode.insertBefore(S,R)}m.remove(R);S&&a(S,t,o);r.moveToBookmark(x).select();
return}if(z){for(;z;){R=z.nextSibling;if(m.isTagNode(z,"ol ul"))u.appendChild(z);else{S=this.document.createDocumentFragment();for(q=0;z.firstChild;){if(m.isBlockElm(z.firstChild))q=1;S.appendChild(z.firstChild)}if(q)u.appendChild(S);else{q=this.document.createElement("p");q.appendChild(S);u.appendChild(q)}m.remove(z)}z=R}L.parentNode.insertBefore(u,L.nextSibling);if(m.isEmptyNode(L)){r.setStartBefore(L);m.remove(L)}else r.setStartAfter(L);F=1}if(D&&m.inDoc(Q,this.document)){for(z=Q.firstChild;z&&
z!==D;){R=z.nextSibling;if(m.isTagNode(z,"ol ul"))u.appendChild(z);else{S=this.document.createDocumentFragment();for(q=0;z.firstChild;){if(m.isBlockElm(z.firstChild))q=1;S.appendChild(z.firstChild)}if(q)u.appendChild(S);else{q=this.document.createElement("p");q.appendChild(S);u.appendChild(q)}m.remove(z)}z=R}R=m.createElement(this.document,"div",{tmpDiv:1});m.moveChild(D,R);u.appendChild(R);m.remove(D);Q.parentNode.insertBefore(u,Q);r.setEndBefore(Q);m.isEmptyNode(Q)&&m.remove(Q);M=1}}F||r.setStartBefore(this.document.getElementById(x.start));
x.end&&!M&&r.setEndAfter(this.document.getElementById(x.end));r.enlarge(true,function(Z){return d[Z.tagName]});u=this.document.createDocumentFragment();D=r.createBookmark();L=m.getNextDomNode(D.start,false,s);S=r.cloneRange();for(F=m.isBlockElm;L&&L!==D.end&&m.getPosition(L,D.end)&m.POSITION_PRECEDING;)if(L.nodeType==3||I.li[L.tagName])if(L.nodeType==1&&I.$list[L.tagName]){for(;L.firstChild;)u.appendChild(L.firstChild);z=m.getNextDomNode(L,false,s);m.remove(L);L=z}else{z=L;for(S.setStartBefore(L);L&&
L!==D.end&&(!F(L)||m.isBookmarkNode(L));){z=L;L=m.getNextDomNode(L,false,null,function(Z){return!d[Z.tagName]})}if(L&&F(L))if((R=m.getNextDomNode(z,false,s))&&m.isBookmarkNode(R)){L=m.getNextDomNode(R,false,s);z=R}S.setEndAfter(z);L=m.getNextDomNode(z,false,s);R=r.document.createElement("li");R.appendChild(S.extractContents());if(m.isEmptyNode(R)){for(z=r.document.createElement("p");R.firstChild;)z.appendChild(R.firstChild);R.appendChild(z)}u.appendChild(R)}else L=m.getNextDomNode(L,true,s);r.moveToBookmark(D).collapse(true);
S=this.document.createElement(t);b(S,o);S.appendChild(u);r.insertNode(S);a(S,t,o);D=0;for(o=m.getElementsByTagName(S,"div");s=o[D++];)s.getAttribute("tmpDiv")&&m.remove(s,true);r.moveToBookmark(x).select()},queryCommandState:function(q){q=q.toLowerCase()=="insertorderedlist"?"ol":"ul";for(var o=this.selection.getStartElementPath(),r=0,s;s=o[r++];){if(s.nodeName=="TABLE")return 0;if(q==s.nodeName.toLowerCase())return 1}return 0},queryCommandValue:function(q){q=q.toLowerCase()=="insertorderedlist"?
"ol":"ul";for(var o=this.selection.getStartElementPath(),r,s=0,t;t=o[s++];){if(t.nodeName=="TABLE"){r=null;break}if(q==t.nodeName.toLowerCase()){r=t;break}}return r?f(r)||m.getComputedStyle(r,"list-style-type"):null}}};(function(){var h={textarea:function(f,c){var a=c.ownerDocument.createElement("textarea");a.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";if(y.ie&&y.version<8){a.style.width=c.offsetWidth+"px";a.style.height=c.offsetHeight+
"px";c.onresize=function(){a.style.width=c.offsetWidth+"px";a.style.height=c.offsetHeight+"px"}}c.appendChild(a);return{setContent:function(b){a.value=b},getContent:function(){return a.value},select:function(){var b;if(y.ie){b=a.createTextRange();b.collapse(true);b.select()}else{a.setSelectionRange(0,0);a.focus()}},dispose:function(){c.removeChild(a);c=a=c.onresize=null}}},codemirror:function(f,c){var a=window.CodeMirror(c,{mode:"text/html",tabMode:"indent",lineNumbers:true,lineWrapping:true}),b=
a.getWrapperElement();b.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';a.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";a.refresh();return{getCodeMirror:function(){return a},setContent:function(g){a.setValue(g)},getContent:function(){return a.getValue()},select:function(){a.focus()},dispose:function(){c.removeChild(b);a=b=null}}}};UE.plugins.source=function(){function f(n){return h[a.sourceEditor==
"codemirror"&&window.CodeMirror?"codemirror":"textarea"](c,n)}var c=this,a=this.options,b=false,g,l;a.sourceEditor=y.ie?"textarea":a.sourceEditor||"codemirror";c.setOpt({sourceEditorFirst:false});var e,d,k;c.commands.source={execCommand:function(){if(b=!b){k=c.selection.getRange().createAddress(false,true);c.undoManger&&c.undoManger.save(true);if(y.gecko)c.body.contentEditable=false;e=c.iframe.style.cssText;c.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";c.fireEvent("beforegetcontent");
var n=UE.htmlparser(c.body.innerHTML);c.filterOutputRule(n);n.traversal(function(o){if(o.type=="element")switch(o.tagName){case "td":case "th":case "caption":o.children&&o.children.length==1&&o.firstChild().tagName=="br"&&o.removeChild(o.firstChild());break;case "pre":o.innerText(o.innerText().replace(/&nbsp;/g," "))}});c.fireEvent("aftergetcontent");n=n.toHtml(true);g=f(c.iframe.parentNode);g.setContent(n);l=c.setContent;c.setContent=function(o){o=UE.htmlparser(o);c.filterInputRule(o);o=o.toHtml();
g.setContent(o)};setTimeout(function(){g.select();c.addListener("fullscreenchanged",function(){try{g.getCodeMirror().refresh()}catch(o){}})});d=c.getContent;c.getContent=function(){return g.getContent()||"<p>"+(y.ie?"":"<br/>")+"</p>"}}else{c.iframe.style.cssText=e;n=g.getContent()||"<p>"+(y.ie?"":"<br/>")+"</p>";n=n.replace(new RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>","g"),function(o,r){if(r&&!I.$inlineWithA[r.toLowerCase()])return o.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,"");return o.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,
"")});c.setContent=l;c.setContent(n);g.dispose();g=null;c.getContent=d;n=c.body.firstChild;if(!n){c.body.innerHTML="<p>"+(y.ie?"":"<br/>")+"</p>";n=c.body.firstChild}c.undoManger&&c.undoManger.save(true);if(y.gecko){var p=document.createElement("input");p.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(p);c.body.contentEditable=false;setTimeout(function(){m.setViewportOffset(p,{left:-32768,top:0});p.focus();setTimeout(function(){c.body.contentEditable=true;c.selection.getRange().moveToAddress(k).select(true);
m.remove(p)})})}else try{c.selection.getRange().moveToAddress(k).select(true)}catch(q){}}this.fireEvent("sourcemodechanged",b)},queryCommandState:function(){return b|0},notNeedUndo:1};var j=c.queryCommandState;c.queryCommandState=function(n){n=n.toLowerCase();if(b)return n in{source:1,fullscreen:1}?1:-1;return j.apply(this,arguments)};a.sourceEditor=="codemirror"&&c.addListener("ready",function(){v.loadFile(document,{src:a.codeMirrorJsUrl||a.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",
tag:"script",type:"text/javascript",defer:"defer"},function(){a.sourceEditorFirst&&setTimeout(function(){c.execCommand("source")},0)});v.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:a.codeMirrorCssUrl||a.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}})();UE.plugins.enterkey=function(){var h,f=this,c=f.options.enterTag;f.addListener("keyup",function(a,b){if((b.keyCode||b.which)==13){a=f.selection.getRange();b=a.startContainer;var g;if(y.ie)f.fireEvent("saveScene",
true,true);else{if(/h\d/i.test(h)){if(y.gecko){if(!m.findParentByTagName(b,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],true)){f.document.execCommand("formatBlock",false,"<p>");g=1}}else if(b.nodeType==1){b=f.document.createTextNode("");var l;a.insertNode(b);if(l=m.findParentByTagName(b,"div",true)){for(g=f.document.createElement("p");l.firstChild;)g.appendChild(l.firstChild);l.parentNode.insertBefore(g,l);m.remove(l);a.setStartBefore(b).setCursor();g=1}m.remove(b)}f.undoManger&&
g&&f.undoManger.save()}y.opera&&a.select()}}});f.addListener("keydown",function(a,b){if((b.keyCode||b.which)==13)if(f.fireEvent("beforeenterkeydown"))m.preventDefault(b);else{f.fireEvent("saveScene",true,true);h="";a=f.selection.getRange();if(!a.collapsed){var g=a.startContainer,l=a.endContainer;g=m.findParentByTagName(g,"td",true);l=m.findParentByTagName(l,"td",true);if(g&&l&&g!==l||!g&&l||g&&!l){b.preventDefault?b.preventDefault():(b.returnValue=false);return}}if(c=="p"){if(!y.ie){g=m.findParentByTagName(a.startContainer,
["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],true);if(!g&&!y.opera){f.document.execCommand("formatBlock",false,"<p>");if(y.gecko){a=f.selection.getRange();(g=m.findParentByTagName(a.startContainer,"p",true))&&m.removeDirtyAttr(g)}}else{h=g.tagName;g.tagName.toLowerCase()=="p"&&y.gecko&&m.removeDirtyAttr(g)}}}else{b.preventDefault?b.preventDefault():(b.returnValue=false);if(a.collapsed){b=a.document.createElement("br");a.insertNode(b);if(b.parentNode.lastChild===b){b.parentNode.insertBefore(b.cloneNode(true),
b);a.setStartBefore(b)}else a.setStartAfter(b);a.setCursor()}else{a.deleteContents();g=a.startContainer;if(g.nodeType==1&&(g=g.childNodes[a.startOffset])){for(;g.nodeType==1;){if(I.$empty[g.tagName]){a.setStartBefore(g).setCursor();f.undoManger&&f.undoManger.save();return false}if(!g.firstChild){b=a.document.createElement("br");g.appendChild(b);a.setStart(g,0).setCursor();f.undoManger&&f.undoManger.save();return false}g=g.firstChild}if(g===a.startContainer.childNodes[a.startOffset]){b=a.document.createElement("br");
a.insertNode(b).setCursor()}else a.setStart(g,0).setCursor()}else{b=a.document.createElement("br");a.insertNode(b).setStartAfter(b).setCursor()}}}}})};UE.plugins.keystrokes=function(){var h=this,f=true;h.addListener("keydown",function(c,a){c=a.keyCode||a.which;var b=h.selection.getRange();if(!b.collapsed&&!(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)&&(c>=65&&c<=90||c>=48&&c<=57||c>=96&&c<=111||{13:1,8:1,46:1}[c])){var g=b.startContainer;m.isFillChar(g)&&b.setStartBefore(g);g=b.endContainer;m.isFillChar(g)&&
b.setEndAfter(g);b.txtToElmBoundary();if(b.endContainer&&b.endContainer.nodeType==1)(g=b.endContainer.childNodes[b.endOffset])&&m.isBr(g)&&b.setEndAfter(g);if(b.startOffset==0){g=b.startContainer;if(m.isBoundaryNode(g,"firstChild")){g=b.endContainer;if(b.endOffset==(g.nodeType==3?g.nodeValue.length:g.childNodes.length)&&m.isBoundaryNode(g,"lastChild")){h.fireEvent("saveScene");h.body.innerHTML="<p>"+(y.ie?"":"<br/>")+"</p>";b.setStart(h.body.firstChild,0).setCursor(false,true);h._selectionChange();
return}}}}if(c==Ca.Backspace){b=h.selection.getRange();f=b.collapsed;if(h.fireEvent("delkeydown",a))return;var l,e;if(b.collapsed&&b.inFillChar()){l=b.startContainer;if(m.isFillChar(l)){b.setStartBefore(l).shrinkBoundary(true).collapse(true);m.remove(l)}else{l.nodeValue=l.nodeValue.replace(new RegExp("^"+m.fillChar),"");b.startOffset--;b.collapse(true).select(true)}}if(l=b.getClosedNode()){h.fireEvent("saveScene");b.setStartBefore(l);m.remove(l);b.setCursor();h.fireEvent("saveScene");m.preventDefault(a);
return}if(!y.ie){l=m.findParentByTagName(b.startContainer,"table",true);e=m.findParentByTagName(b.endContainer,"table",true);if(l&&!e||!l&&e||l!==e){a.preventDefault();return}}}if(c==Ca.Tab){var d={ol:1,ul:1,table:1};if(h.fireEvent("tabkeydown",a)){m.preventDefault(a);return}b=h.selection.getRange();h.fireEvent("saveScene");g=0;var k="";l=h.options.tabSize||4;for(e=h.options.tabNode||"&nbsp;";g<l;g++)k+=e;g=h.document.createElement("span");g.innerHTML=k+m.fillChar;if(b.collapsed)b.insertNode(g.cloneNode(true).firstChild).setCursor(true);
else{k=function(n){return m.isBlockElm(n)&&!d[n.tagName.toLowerCase()]};l=m.findParent(b.startContainer,k,true);e=m.findParent(b.endContainer,k,true);if(l&&e&&l===e){b.deleteContents();b.insertNode(g.cloneNode(true).firstChild).setCursor(true)}else{l=b.createBookmark();b.enlarge(true);e=b.createBookmark();for(var j=m.getNextDomNode(e.start,false,k);j&&!(m.getPosition(j,e.end)&m.POSITION_FOLLOWING);){j.insertBefore(g.cloneNode(true).firstChild,j.firstChild);j=m.getNextDomNode(j,false,k)}b.moveToBookmark(e).moveToBookmark(l).select()}}m.preventDefault(a)}if(y.gecko&&
c==46){b=h.selection.getRange();if(b.collapsed){l=b.startContainer;if(m.isEmptyBlock(l)){for(c=l.parentNode;m.getChildCount(c)==1&&!m.isBody(c);){l=c;c=c.parentNode}l===c.lastChild&&a.preventDefault()}}}});h.addListener("keyup",function(c,a){if((a.keyCode||a.which)==Ca.Backspace)if(!this.fireEvent("delkeyup")){c=this.selection.getRange();if(c.collapsed){if(a=m.findParentByTagName(c.startContainer,["h1","h2","h3","h4","h5","h6"],true))if(m.isEmptyBlock(a)){var b=a.previousSibling;if(b&&b.nodeName!=
"TABLE"){m.remove(a);c.setStartAtLast(b).setCursor(false,true);return}else if((b=a.nextSibling)&&b.nodeName!="TABLE"){m.remove(a);c.setStartAtFirst(b).setCursor(false,true);return}}if(m.isBody(c.startContainer)){a=m.createElement(this.document,"p",{innerHTML:y.ie?m.fillChar:"<br/>"});c.insertNode(a).setStart(a,0).setCursor(false,true)}}if(!f&&(c.startContainer.nodeType==3||c.startContainer.nodeType==1&&m.isEmptyBlock(c.startContainer)))if(y.ie){a=c.document.createElement("span");c.insertNode(a).setStartBefore(a).collapse(true);
c.select();m.remove(a)}else c.select()}})};UE.plugins.fiximgclick=function(){function h(){this.cover=this.resizer=this.editor=null;this.doc=document;this.prePos={x:0,y:0};this.startPos={x:0,y:0}}var f=false;(function(){var c=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];h.prototype={init:function(a){var b=this;b.editor=a;b.startPos=this.prePos={x:0,y:0};b.dragId=-1;a=[];var g=b.cover=document.createElement("div"),l=b.resizer=document.createElement("div");
g.id=b.editor.ui.id+"_imagescale_cover";g.style.cssText="position:absolute;display:none;z-index:"+b.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;";m.on(g,"mousedown click",function(){b.hide()});for(i=0;i<8;i++)a.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');l.id=b.editor.ui.id+"_imagescale";l.className="edui-editor-imagescale";l.innerHTML=a.join("");l.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+b.editor.options.zIndex+";";b.editor.ui.getDom().appendChild(g);
b.editor.ui.getDom().appendChild(l);b.initStyle();b.initEvents()},initStyle:function(){v.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},
initEvents:function(){this.startPos.x=this.startPos.y=0;this.isDraging=false},_eventHandler:function(a){switch(a.type){case "mousedown":var b=a.target||a.srcElement;if(b.className.indexOf("edui-editor-imagescale-hand")!=-1&&this.dragId==-1){this.dragId=b.className.slice(-1);this.startPos.x=this.prePos.x=a.clientX;this.startPos.y=this.prePos.y=a.clientY;m.on(this.doc,"mousemove",this.proxy(this._eventHandler,this))}break;case "mousemove":if(this.dragId!=-1){this.updateContainerStyle(this.dragId,{x:a.clientX-
this.prePos.x,y:a.clientY-this.prePos.y});this.prePos.x=a.clientX;this.prePos.y=a.clientY;f=true;this.updateTargetElement()}break;case "mouseup":if(this.dragId!=-1){this.updateContainerStyle(this.dragId,{x:a.clientX-this.prePos.x,y:a.clientY-this.prePos.y});this.updateTargetElement();this.target.parentNode&&this.attachTo(this.target);this.dragId=-1}m.un(this.doc,"mousemove",this.proxy(this._eventHandler,this));if(f){f=false;this.editor.fireEvent("contentchange")}break;default:break}},updateTargetElement:function(){m.setStyles(this.target,
{width:this.resizer.style.width,height:this.resizer.style.height});this.target.width=parseInt(this.resizer.style.width);this.target.height=parseInt(this.resizer.style.height);this.attachTo(this.target)},updateContainerStyle:function(a,b){var g=this.resizer,l;if(c[a][0]!=0){l=parseInt(g.style.left)+b.x;g.style.left=this._validScaledProp("left",l)+"px"}if(c[a][1]!=0){l=parseInt(g.style.top)+b.y;g.style.top=this._validScaledProp("top",l)+"px"}if(c[a][2]!=0){l=g.clientWidth+c[a][2]*b.x;g.style.width=
this._validScaledProp("width",l)+"px"}if(c[a][3]!=0){l=g.clientHeight+c[a][3]*b.y;g.style.height=this._validScaledProp("height",l)+"px"}},_validScaledProp:function(a,b){var g=this.resizer,l=document;b=isNaN(b)?0:b;switch(a){case "left":return b<0?0:b+g.clientWidth>l.clientWidth?l.clientWidth-g.clientWidth:b;case "top":return b<0?0:b+g.clientHeight>l.clientHeight?l.clientHeight-g.clientHeight:b;case "width":return b<=0?1:b+g.offsetLeft>l.clientWidth?l.clientWidth-g.offsetLeft:b;case "height":return b<=
0?1:b+g.offsetTop>l.clientHeight?l.clientHeight-g.offsetTop:b}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var a=m.getXY(this.editor.ui.getDom()),b=m.getXY(this.editor.iframe);m.setStyles(this.cover,{width:this.editor.iframe.offsetWidth+"px",height:this.editor.iframe.offsetHeight+"px",top:b.y-a.y+"px",left:b.x-a.x+"px",position:"absolute",display:""})},show:function(a){this.resizer.style.display="block";a&&this.attachTo(a);m.on(this.resizer,"mousedown",this.proxy(this._eventHandler,
this));m.on(this.doc,"mouseup",this.proxy(this._eventHandler,this));this.showCover();this.editor.fireEvent("afterscaleshow",this);this.editor.fireEvent("saveScene")},hide:function(){this.hideCover();this.resizer.style.display="none";m.un(this.resizer,"mousedown",this.proxy(this._eventHandler,this));m.un(this.doc,"mouseup",this.proxy(this._eventHandler,this));this.editor.fireEvent("afterscalehide",this)},proxy:function(a,b){return function(){return a.apply(b||this,arguments)}},attachTo:function(a){a=
this.target=a;var b=this.resizer,g=m.getXY(a),l=m.getXY(this.editor.iframe),e=m.getXY(b.parentNode);m.setStyles(b,{width:a.width+"px",height:a.height+"px",left:l.x+g.x-this.editor.document.body.scrollLeft-e.x-parseInt(b.style.borderLeftWidth)+"px",top:l.y+g.y-this.editor.document.body.scrollTop-e.y-parseInt(b.style.borderTopWidth)+"px"})}}})();return function(){var c=this,a;c.setOpt("imageScaleEnabled",true);!y.ie&&c.options.imageScaleEnabled&&c.addListener("click",function(){var b=c.selection.getRange().getClosedNode();
if(b&&b.tagName=="IMG"&&c.body.contentEditable!="false"){if(!(b.className.indexOf("edui-faked-music")!=-1||b.getAttribute("anchorname")||m.hasClass(b,"loadingclass")||m.hasClass(b,"loaderrorclass"))){if(!a){a=new h;a.init(c);c.ui.getDom().appendChild(a.resizer);var g=function(){a.hide();a.target&&c.selection.getRange().selectNode(a.target).select()},l=function(d){var k=d.target||d.srcElement;if(k&&(k.className===undefined||k.className.indexOf("edui-editor-imagescale")==-1))g(d)},e;c.addListener("afterscaleshow",
function(){c.addListener("beforekeydown",g);c.addListener("beforemousedown",l);m.on(document,"keydown",g);m.on(document,"mousedown",l);c.selection.getNative().removeAllRanges()});c.addListener("afterscalehide",function(){c.removeListener("beforekeydown",g);c.removeListener("beforemousedown",l);m.un(document,"keydown",g);m.un(document,"mousedown",l);var d=a.target;d.parentNode&&c.selection.getRange().selectNode(d).select()});m.on(a.resizer,"mousedown",function(d){c.selection.getNative().removeAllRanges();
var k=d.target||d.srcElement;if(k&&k.className.indexOf("edui-editor-imagescale-hand")==-1)e=setTimeout(function(){a.hide();a.target&&c.selection.getRange().selectNode(k).select()},200)});m.on(a.resizer,"mouseup",function(d){(d=d.target||d.srcElement)&&d.className.indexOf("edui-editor-imagescale-hand")==-1&&clearTimeout(e)})}a.show(b)}}else a&&a.resizer.style.display!="none"&&a.hide()});y.webkit&&c.addListener("click",function(b,g){g.target.tagName=="IMG"&&c.body.contentEditable!="false"&&(new ea.Range(c.document)).selectNode(g.target).select()})}}();
UE.plugin.register("autolink",function(){var h=0;return!y.ie?{bindEvents:{reset:function(){h=0},keydown:function(f,c){f=c.keyCode||c.which;if(f==32||f==13){f=this.selection.getNative();c=f.getRangeAt(0).cloneRange();for(var a,b=c.startContainer;b.nodeType==1&&c.startOffset>0;){b=c.startContainer.childNodes[c.startOffset-1];if(!b)break;c.setStart(b,b.nodeType==1?b.childNodes.length:b.nodeValue.length);c.collapse(true);b=c.startContainer}do{if(c.startOffset==0){for(b=c.startContainer.previousSibling;b&&
b.nodeType==1;)b=b.lastChild;if(!b||m.isFillChar(b))break;a=b.nodeValue.length}else{b=c.startContainer;a=c.startOffset}c.setStart(b,a-1);a=c.toString().charCodeAt(0)}while(a!=160&&a!=32);if(c.toString().replace(new RegExp(m.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){for(;c.toString().length;){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(c.toString()))break;try{c.setStart(c.startContainer,c.startOffset+1)}catch(g){for(b=c.startContainer;!(next=b.nextSibling);){if(m.isBody(b))return;
b=b.parentNode}c.setStart(next,0)}}if(!m.findParentByTagName(c.startContainer,"a",true)){a=this.document.createElement("a");b=this.document.createTextNode(" ");var l;this.undoManger&&this.undoManger.save();a.appendChild(c.extractContents());a.href=a.innerHTML=a.innerHTML.replace(/<[^>]+>/g,"");l=a.getAttribute("href").replace(new RegExp(m.fillChar,"g"),"");l=/^(?:https?:\/\/)/ig.test(l)?l:"http://"+l;a.setAttribute("_src",v.html(l));a.href=v.html(l);c.insertNode(a);a.parentNode.insertBefore(b,a.nextSibling);
c.setStart(b,0);c.collapse(true);f.removeAllRanges();f.addRange(c);this.undoManger&&this.undoManger.save()}}}}}}:{}},function(){function h(c){if(c.nodeType==3)return null;if(c.nodeName=="A")return c;for(c=c.lastChild;c;){if(c.nodeName=="A")return c;if(c.nodeType==3){if(m.isWhitespace(c)){c=c.previousSibling;continue}return null}c=c.lastChild}}var f={37:1,38:1,39:1,40:1,13:1,32:1};y.ie&&this.addListener("keyup",function(c,a){var b=a.keyCode;if(f[b]){c=this.selection.getRange();a=c.startContainer;if(b==
13){for(;a&&!m.isBody(a)&&!m.isBlockElm(a);)a=a.parentNode;if(a&&!m.isBody(a)&&a.nodeName=="P")if((c=a.previousSibling)&&c.nodeType==1)(c=h(c))&&!c.getAttribute("_href")&&m.remove(c,true)}else if(b==32){if(a.nodeType==3&&/^\s$/.test(a.nodeValue))(a=a.previousSibling)&&a.nodeName=="A"&&!a.getAttribute("_href")&&m.remove(a,true)}else if((a=m.findParentByTagName(a,"a",true))&&!a.getAttribute("_href")){b=c.createBookmark();m.remove(a,true);c.moveToBookmark(b).select(true)}}})});UE.plugins.autoheight=
function(){function h(){var d=this;clearTimeout(l);if(!e)if(!d.queryCommandState||d.queryCommandState&&d.queryCommandState("source")!=1)l=setTimeout(function(){for(var k=d.body.lastChild;k&&k.nodeType!=1;)k=k.previousSibling;if(k&&k.nodeType==1){k.style.clear="both";g=Math.max(m.getXY(k).y+k.offsetHeight+25,Math.max(b.minFrameHeight,b.initialFrameHeight));if(g!=a){if(g!==parseInt(d.iframe.parentNode.style.height))d.iframe.parentNode.style.height=g+"px";d.body.style.height=g+"px";a=g}m.removeStyle(k,
"clear")}try{iframeTimer!=0&&clearTimeout(iframeTimer);iframeTimer=setTimeout(function(){d.iframe.style.height=g+200+"px";d.iframe.height=g+200+"px"},400)}catch(j){}},50)}var f=this;f.autoHeightEnabled=f.options.autoHeightEnabled!==false;if(f.autoHeightEnabled){var c,a=0,b=f.options,g,l,e;f.addListener("fullscreenchanged",function(d,k){e=k});f.addListener("destroy",function(){f.removeListener("contentchange afterinserthtml keyup mouseup",h)});f.enableAutoHeight=function(){var d=this;if(d.autoHeightEnabled){var k=
d.document;d.autoHeightEnabled=true;c=k.body.style.overflowY;k.body.style.overflowY="hidden";d.addListener("contentchange afterinserthtml keyup mouseup",h);setTimeout(function(){h.call(d)},y.gecko?100:0);d.fireEvent("autoheightchanged",d.autoHeightEnabled)}};f.disableAutoHeight=function(){f.body.style.overflowY=c||"";f.removeListener("contentchange",h);f.removeListener("keyup",h);f.removeListener("mouseup",h);f.autoHeightEnabled=false;f.fireEvent("autoheightchanged",f.autoHeightEnabled)};f.on("setHeight",
function(){f.disableAutoHeight()});f.addListener("ready",function(){f.enableAutoHeight();var d;m.on(y.ie?f.body:f.document,y.webkit?"dragover":"drop",function(){clearTimeout(d);d=setTimeout(function(){h.call(f)},100)});var k;window.onscroll=function(){if(k===null)k=this.scrollY;else if(this.scrollY==0&&k!=0){f.window.scrollTo(0,0);k=null}}})}};UE.plugins.autofloat=function(){function h(){if(!UE.ui){alert(l.autofloatMsg);return 0}return 1}function f(){var u=document.body.style;u.backgroundImage='url("about:blank")';
u.backgroundAttachment="fixed"}function c(){var u=m.getXY(q),x=m.getComputedStyle(q,"position"),z=m.getComputedStyle(q,"left");q.style.width=q.offsetWidth+"px";q.style.zIndex=g.options.zIndex*1+1;q.parentNode.insertBefore(p,q);if(k||j&&y.ie){if(q.style.position!="absolute")q.style.position="absolute";q.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-o+e+"px"}else{if(y.ie7Compat&&s){s=false;q.style.left=m.getXY(q).x-document.documentElement.getBoundingClientRect().left+2+"px"}if(q.style.position!=
"fixed"){q.style.position="fixed";q.style.top=e+"px";(x=="absolute"||x=="relative")&&parseFloat(z)&&(q.style.left=u.x+"px")}}}function a(){s=true;p.parentNode&&p.parentNode.removeChild(p);q.style.cssText=n}function b(){var u=r(g.container),x=g.options.toolbarTopOffset||0;u.top<0&&u.bottom-q.offsetHeight>x?c():a()}var g=this,l=g.getLang();g.setOpt({topOffset:0});var e=g.options.topOffset;if(g.options.autoFloatEnabled!==false){var d=UE.ui.uiUtils,k=y.ie&&y.version<=6,j=y.quirks,n,p=document.createElement("div"),
q,o,r,s=true,t=v.defer(function(){b()},y.ie?200:100,true);g.addListener("destroy",function(){m.un(window,["scroll","resize"],b);g.removeListener("keydown",t)});g.addListener("ready",function(){if(h(g))if(g.ui){r=d.getClientRect;q=g.ui.getDom("toolbarbox");o=r(q).top;n=q.style.cssText;p.style.height=q.offsetHeight+"px";k&&f();m.on(window,["scroll","resize"],b);g.addListener("keydown",t);g.addListener("beforefullscreenchange",function(u,x){x&&a()});g.addListener("fullscreenchanged",function(u,x){x||
b()});g.addListener("sourcemodechanged",function(){setTimeout(function(){b()},0)});g.addListener("clearDoc",function(){setTimeout(function(){b()},0)})}})}};UE.plugins.video=function(){function h(a,b,g,l,e,d,k){var j;switch(k){case "image":j="<img "+(l?'id="'+l+'"':"")+' width="'+b+'" height="'+g+'" _url="'+a+'" class="'+d.replace(/\bvideo-js\b/,"")+'" src="'+c.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+c.options.UEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+
(e?"float:"+e+";":"")+'" />';break;case "embed":j='<embed type="application/x-shockwave-flash" class="'+d+'" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+v.html(a)+'" width="'+b+'" height="'+g+'"'+(e?' style="float:'+e+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';break;case "video":k=a.substr(a.lastIndexOf(".")+1);if(k=="ogv")k="ogg";j="<video"+(l?' id="'+l+'"':"")+' class="'+d+' video-js" '+(e?' style="float:'+
e+'"':"")+' controls preload="none" width="'+b+'" height="'+g+'" src="'+a+'" data-setup="{}"><source src="'+a+'" type="video/'+k+'" /></video>';break}return j}function f(a,b){v.each(a.getNodesByTagName(b?"img":"embed video"),function(g){var l=g.getAttr("class");if(l&&l.indexOf("edui-faked-video")!=-1){var e=h(b?g.getAttr("_url"):g.getAttr("src"),g.getAttr("width"),g.getAttr("height"),null,g.getStyle("float")||"",l,b?"embed":"image");g.parentNode.replaceChild(UE.uNode.createElement(e),g)}if(l&&l.indexOf("edui-upload-video")!=
-1){e=h(b?g.getAttr("_url"):g.getAttr("src"),g.getAttr("width"),g.getAttr("height"),null,g.getStyle("float")||"",l,b?"video":"image");g.parentNode.replaceChild(UE.uNode.createElement(e),g)}})}var c=this;c.addOutputRule(function(a){f(a,true)});c.addInputRule(function(a){f(a)});c.commands.insertvideo={execCommand:function(a,b,g){b=v.isArray(b)?b:[b];var l=[],e;a=0;for(var d,k=b.length;a<k;a++){d=b[a];e=g=="upload"?"edui-upload-video video-js vjs-default-skin":"edui-faked-video";l.push(h(d.url,d.width||
420,d.height||280,"tmpVedio"+a,null,e,"image"))}c.execCommand("inserthtml",l.join(""),true);g=this.selection.getRange();a=0;for(k=b.length;a<k;a++){l=this.document.getElementById("tmpVedio"+a);m.removeAttributes(l,"id");g.selectNode(l).select();c.execCommand("imagefloat",b[a].align)}},queryCommandState:function(){var a=c.selection.getRange().getClosedNode();return a&&(a.className=="edui-faked-video"||a.className.indexOf("edui-upload-video")!=-1)?1:0}}};(function(){function h(){}var f=UE.UETable=function(c){this.table=
c;this.indexTable=[];this.selectedTds=[];this.cellsRange={};this.update(c)};f.removeSelectedClass=function(c){v.each(c,function(a){m.removeClasses(a,"selectTdClass")})};f.addSelectedClass=function(c){v.each(c,function(a){m.addClass(a,"selectTdClass")})};f.isEmptyBlock=function(c){var a=new RegExp(m.fillChar,"g");if(c[y.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(a,"").length>0)return 0;for(var b in I.$isNotEmpty)if(I.$isNotEmpty.hasOwnProperty(b))if(c.getElementsByTagName(b).length)return 0;
return 1};f.getWidth=function(c){if(!c)return 0;return parseInt(m.getComputedStyle(c,"width"),10)};f.getTableCellAlignState=function(c){!v.isArray(c)&&(c=[c]);var a={},b=["align","valign"],g=null,l=true;v.each(c,function(e){v.each(b,function(d){g=e.getAttribute(d);if(!a[d]&&g)a[d]=g;else if(!a[d]||g!==a[d])return l=false});return l});return l?a:null};f.getTableItemsByRange=function(c){var a=c.selection.getStart();if(a&&a.id&&a.id.indexOf("_baidu_bookmark_start_")===0&&a.nextSibling)a=a.nextSibling;
var b=(c=a&&m.findParentByTagName(a,["td","th"],true))&&c.parentNode;a=a&&m.findParentByTagName(a,"caption",true);return{cell:c,tr:b,table:a?a.parentNode:b&&b.parentNode.parentNode,caption:a}};f.getUETableBySelected=function(c){if((c=f.getTableItemsByRange(c).table)&&c.ueTable&&c.ueTable.selectedTds.length)return c.ueTable;return null};f.getDefaultValue=function(c,a){var b={thin:"0px",medium:"1px",thick:"2px"},g,l;if(a){e=a.getElementsByTagName("td")[0];l=m.getComputedStyle(a,"border-left-width");
c=parseInt(b[l]||l,10);l=m.getComputedStyle(e,"padding-left");g=parseInt(b[l]||l,10);l=m.getComputedStyle(e,"border-left-width");b=parseInt(b[l]||l,10)}else{a=c.document.createElement("table");a.insertRow(0).insertCell(0).innerHTML="xxx";c.body.appendChild(a);var e=a.getElementsByTagName("td")[0];l=m.getComputedStyle(a,"border-left-width");c=parseInt(b[l]||l,10);l=m.getComputedStyle(e,"padding-left");g=parseInt(b[l]||l,10);l=m.getComputedStyle(e,"border-left-width");b=parseInt(b[l]||l,10);m.remove(a)}return{tableBorder:c,
tdPadding:g,tdBorder:b}};f.getUETable=function(c){var a=c.tagName.toLowerCase();c=a=="td"||a=="th"||a=="caption"?m.findParentByTagName(c,"table",true):c;if(!c.ueTable)c.ueTable=new f(c);return c.ueTable};f.cloneCell=function(c,a,b){if(!c||v.isString(c))return this.table.ownerDocument.createElement(c||"td");var g=m.hasClass(c,"selectTdClass");g&&m.removeClasses(c,"selectTdClass");var l=c.cloneNode(true);if(a)l.rowSpan=l.colSpan=1;!b&&m.removeAttributes(l,"width height");!b&&m.removeAttributes(l,"style");
l.style.borderLeftStyle="";l.style.borderTopStyle="";l.style.borderLeftColor=c.style.borderRightColor;l.style.borderLeftWidth=c.style.borderRightWidth;l.style.borderTopColor=c.style.borderBottomColor;l.style.borderTopWidth=c.style.borderBottomWidth;g&&m.addClass(c,"selectTdClass");return l};f.prototype={getMaxRows:function(){for(var c=this.table.rows,a=1,b=0,g;g=c[b];b++){for(var l=1,e=0,d;d=g.cells[e++];)l=Math.max(d.rowSpan||1,l);a=Math.max(l+b,a)}return a},getMaxCols:function(){for(var c=this.table.rows,
a=0,b={},g=0,l;l=c[g];g++){for(var e=0,d=0,k;k=l.cells[d++];){e+=k.colSpan||1;if(k.rowSpan&&k.rowSpan>1)for(var j=1;j<k.rowSpan;j++)if(b["row_"+(g+j)])b["row_"+(g+j)]++;else b["row_"+(g+j)]=k.colSpan||1}e+=b["row_"+g]||0;a=Math.max(e,a)}return a},getCellColIndex:function(){},getHSideCell:function(c,a){try{var b=this.getCellInfo(c),g,l,e=this.selectedTds.length,d=this.cellsRange;if(!a&&(!e?!b.colIndex:!d.beginColIndex)||a&&(!e?b.colIndex==this.colsNum-1:d.endColIndex==this.colsNum-1))return null;g=
!e?b.rowIndex:d.beginRowIndex;l=!a?!e?b.colIndex<1?0:b.colIndex-1:d.beginColIndex-1:!e?b.colIndex+1:d.endColIndex+1;return this.getCell(this.indexTable[g][l].rowIndex,this.indexTable[g][l].cellIndex)}catch(k){h(k)}},getTabNextCell:function(c,a){c=this.getCellInfo(c);a=a||c.rowIndex;c=c.colIndex+1+(c.colSpan-1);var b;try{b=this.getCell(this.indexTable[a][c].rowIndex,this.indexTable[a][c].cellIndex)}catch(g){try{a=a*1+1;c=0;b=this.getCell(this.indexTable[a][c].rowIndex,this.indexTable[a][c].cellIndex)}catch(l){}}return b},
getVSideCell:function(c,a,b){try{var g=this.getCellInfo(c),l,e,d=this.selectedTds.length&&!b,k=this.cellsRange;if(!a&&g.rowIndex==0||a&&(!d?g.rowIndex+g.rowSpan>this.rowsNum-1:k.endRowIndex==this.rowsNum-1))return null;l=!a?!d?g.rowIndex-1:k.beginRowIndex-1:!d?g.rowIndex+g.rowSpan:k.endRowIndex+1;e=!d?g.colIndex:k.beginColIndex;return this.getCell(this.indexTable[l][e].rowIndex,this.indexTable[l][e].cellIndex)}catch(j){h(j)}},getSameEndPosCells:function(c,a){try{var b=a.toLowerCase()==="x",g=m.getXY(c)[b?
"x":"y"]+c["offset"+(b?"Width":"Height")],l=this.table.rows;a=null;for(var e=[],d=0;d<this.rowsNum;d++){a=l[d].cells;for(var k=0,j;j=a[k++];){var n=m.getXY(j)[b?"x":"y"]+j["offset"+(b?"Width":"Height")];if(n>g&&b)break;if(c==j||g==n){if(j[b?"colSpan":"rowSpan"]==1)e.push(j);if(b)break}}}return e}catch(p){h(p)}},setCellContent:function(c,a){c.innerHTML=a||(y.ie?m.fillChar:"<br />")},cloneCell:f.cloneCell,getSameStartPosXCells:function(c){try{var a=m.getXY(c).x+c.offsetWidth,b=this.table.rows,g;c=[];
for(var l=0;l<this.rowsNum;l++){g=b[l].cells;for(var e=0,d;d=g[e++];){var k=m.getXY(d).x;if(k>a)break;if(k==a&&d.colSpan==1){c.push(d);break}}}return c}catch(j){h(j)}},update:function(c){this.table=c||this.table;this.selectedTds=[];this.cellsRange={};this.indexTable=[];c=this.table.rows;for(var a=this.getMaxRows(),b=a-c.length,g=this.getMaxCols();b--;)this.table.insertRow(c.length);this.rowsNum=a;this.colsNum=g;b=0;for(var l=c.length;b<l;b++)this.indexTable[b]=new Array(g);b=0;for(var e;e=c[b];b++){l=
0;var d;for(e=e.cells;d=e[l];l++){if(d.rowSpan>a)d.rowSpan=a;var k=l,j=d.rowSpan||1;for(d=d.colSpan||1;this.indexTable[b][k];)k++;for(var n=0;n<j;n++)for(var p=0;p<d;p++)this.indexTable[b+n][k+p]={rowIndex:b,cellIndex:l,colIndex:k,rowSpan:j,colSpan:d}}}for(n=0;n<a;n++)for(p=0;p<g;p++)if(this.indexTable[n][p]===undefined){e=c[n];d=(d=e.cells[e.cells.length-1])?d.cloneNode(true):this.table.ownerDocument.createElement("td");this.setCellContent(d);if(d.colSpan!==1)d.colSpan=1;if(d.rowSpan!==1)d.rowSpan=
1;e.appendChild(d);this.indexTable[n][p]={rowIndex:n,cellIndex:d.cellIndex,colIndex:p,rowSpan:1,colSpan:1}}c=m.getElementsByTagName(this.table,"td");var q=[];v.each(c,function(o){m.hasClass(o,"selectTdClass")&&q.push(o)});if(q.length){a=q[q.length-1];c=this.getCellInfo(q[0]);a=this.getCellInfo(a);this.selectedTds=q;this.cellsRange={beginRowIndex:c.rowIndex,beginColIndex:c.colIndex,endRowIndex:a.rowIndex+a.rowSpan-1,endColIndex:a.colIndex+a.colSpan-1}}if(!m.hasClass(this.table.rows[0],"firstRow")){m.addClass(this.table.rows[0],
"firstRow");for(b=1;b<this.table.rows.length;b++)m.removeClasses(this.table.rows[b],"firstRow")}},getCellInfo:function(c){if(c){var a=c.cellIndex;c=c.parentNode.rowIndex;for(var b=this.indexTable[c],g=this.colsNum,l=a;l<g;l++){var e=b[l];if(e.rowIndex===c&&e.cellIndex===a)return e}}},getCell:function(c,a){return c<this.rowsNum&&this.table.rows[c].cells[a]||null},deleteCell:function(c,a){a=typeof a=="number"?a:c.parentNode.rowIndex;this.table.rows[a].deleteCell(c.cellIndex)},getCellsRange:function(c,
a){function b(q,o,r,s){var t=q,u=o,x=r,z=s,F,D,M;if(q>0)for(D=o;D<s;D++){F=g.indexTable[q][D];M=F.rowIndex;if(M<q)t=Math.min(M,t)}if(s<g.colsNum)for(M=q;M<r;M++){F=g.indexTable[M][s];D=F.colIndex+F.colSpan-1;if(D>s)z=Math.max(D,z)}if(r<g.rowsNum)for(D=o;D<s;D++){F=g.indexTable[r][D];M=F.rowIndex+F.rowSpan-1;if(M>r)x=Math.max(M,x)}if(o>0)for(M=q;M<r;M++){F=g.indexTable[M][o];D=F.colIndex;if(D<o)u=Math.min(F.colIndex,u)}return t!=q||u!=o||x!=r||z!=s?b(t,u,x,z):{beginRowIndex:q,beginColIndex:o,endRowIndex:r,
endColIndex:s}}try{var g=this,l=g.getCellInfo(c);if(c===a)return{beginRowIndex:l.rowIndex,beginColIndex:l.colIndex,endRowIndex:l.rowIndex+l.rowSpan-1,endColIndex:l.colIndex+l.colSpan-1};var e=g.getCellInfo(a),d=Math.min(l.rowIndex,e.rowIndex),k=Math.min(l.colIndex,e.colIndex),j=Math.max(l.rowIndex+l.rowSpan-1,e.rowIndex+e.rowSpan-1),n=Math.max(l.colIndex+l.colSpan-1,e.colIndex+e.colSpan-1);return b(d,k,j,n)}catch(p){}},getCells:function(c){this.clearSelected();for(var a=c.beginColIndex,b=c.endRowIndex,
g=c.endColIndex,l,e,d={},k=[],j=c.beginRowIndex;j<=b;j++)for(var n=a;n<=g;n++){c=this.indexTable[j][n];l=c.rowIndex;e=c.colIndex;var p=l+"|"+e;if(!d[p]){d[p]=1;if(l<j||e<n||l+c.rowSpan-1>b||e+c.colSpan-1>g)return null;k.push(this.getCell(l,c.cellIndex))}}return k},clearSelected:function(){f.removeSelectedClass(this.selectedTds);this.selectedTds=[];this.cellsRange={}},setSelected:function(c){var a=this.getCells(c);f.addSelectedClass(a);this.selectedTds=a;this.cellsRange=c},isFullRow:function(){var c=
this.cellsRange;return c.endColIndex-c.beginColIndex+1==this.colsNum},isFullCol:function(){var c=this.cellsRange,a=this.table.getElementsByTagName("th");c=c.endRowIndex-c.beginRowIndex+1;return!a.length?c==this.rowsNum:c==this.rowsNum||c==this.rowsNum-1},getNextCell:function(c,a,b){try{var g=this.getCellInfo(c),l,e,d=this.selectedTds.length&&!b,k=this.cellsRange;if(!a&&g.rowIndex==0||a&&(!d?g.rowIndex+g.rowSpan>this.rowsNum-1:k.endRowIndex==this.rowsNum-1))return null;l=!a?!d?g.rowIndex-1:k.beginRowIndex-
1:!d?g.rowIndex+g.rowSpan:k.endRowIndex+1;e=!d?g.colIndex:k.beginColIndex;return this.getCell(this.indexTable[l][e].rowIndex,this.indexTable[l][e].cellIndex)}catch(j){h(j)}},getPreviewCell:function(c,a){try{var b=this.getCellInfo(c),g,l,e=this.selectedTds.length,d=this.cellsRange;if(!a&&(!e?!b.colIndex:!d.beginColIndex)||a&&(!e?b.rowIndex>this.colsNum-1:d.endColIndex==this.colsNum-1))return null;g=!a?!e?b.rowIndex:d.beginRowIndex:!e?b.rowIndex<1?0:b.rowIndex-1:d.beginRowIndex;l=!a?!e?b.colIndex<1?
0:b.colIndex-1:d.beginColIndex-1:!e?b.colIndex:d.endColIndex+1;return this.getCell(this.indexTable[g][l].rowIndex,this.indexTable[g][l].cellIndex)}catch(k){h(k)}},moveContent:function(c,a){if(!f.isEmptyBlock(a))if(f.isEmptyBlock(c))c.innerHTML=a.innerHTML;else{var b=c.lastChild;if(b.nodeType==3||!I.$block[b.tagName])c.appendChild(c.ownerDocument.createElement("br"));for(;b=a.firstChild;)c.appendChild(b)}},mergeRight:function(c){var a=this.getCellInfo(c),b=this.indexTable[a.rowIndex][a.colIndex+a.colSpan],
g=this.getCell(b.rowIndex,b.cellIndex);c.colSpan=a.colSpan+b.colSpan;c.removeAttribute("width");this.moveContent(c,g);this.deleteCell(g,b.rowIndex);this.update()},mergeDown:function(c){var a=this.getCellInfo(c),b=this.indexTable[a.rowIndex+a.rowSpan][a.colIndex],g=this.getCell(b.rowIndex,b.cellIndex);c.rowSpan=a.rowSpan+b.rowSpan;c.removeAttribute("height");this.moveContent(c,g);this.deleteCell(g,b.rowIndex);this.update()},mergeRange:function(){var c=this.cellsRange,a=this.getCell(c.beginRowIndex,
this.indexTable[c.beginRowIndex][c.beginColIndex].cellIndex);if(a.tagName=="TH"&&c.endRowIndex!==c.beginRowIndex){var b=this.indexTable;c=this.getCellInfo(a);a=this.getCell(1,b[1][c.colIndex].cellIndex);c=this.getCellsRange(a,this.getCell(b[this.rowsNum-1][c.colIndex].rowIndex,b[this.rowsNum-1][c.colIndex].cellIndex))}var g=this.getCells(c);b=0;for(var l;l=g[b++];)if(l!==a){this.moveContent(a,l);this.deleteCell(l)}a.rowSpan=c.endRowIndex-c.beginRowIndex+1;a.rowSpan>1&&a.removeAttribute("height");
a.colSpan=c.endColIndex-c.beginColIndex+1;a.colSpan>1&&a.removeAttribute("width");if(a.rowSpan==this.rowsNum&&a.colSpan!=1)a.colSpan=1;if(a.colSpan==this.colsNum&&a.rowSpan!=1){g=a.parentNode.rowIndex;if(this.table.deleteRow){b=g+1;g=g+1;for(c=a.rowSpan;b<c;b++)this.table.deleteRow(g)}else{b=0;for(c=a.rowSpan-1;b<c;b++){l=this.table.rows[g+1];l.parentNode.removeChild(l)}}a.rowSpan=1}this.update()},insertRow:function(c,a){function b(p,q,o){if(p==0){p=(o.nextSibling||o.previousSibling).cells[p];if(p.tagName==
"TH"){p=q.ownerDocument.createElement("th");p.appendChild(q.firstChild);o.insertBefore(p,q);m.remove(q)}}else if(q.tagName=="TH"){p=q.ownerDocument.createElement("td");p.appendChild(q.firstChild);o.insertBefore(p,q);m.remove(q)}}var g=this.colsNum,l=this.table.insertRow(c),e,d=typeof a=="string"&&a.toUpperCase()=="TH";if(c==0||c==this.rowsNum)for(var k=0;k<g;k++){e=this.cloneCell(a,true);this.setCellContent(e);e.getAttribute("vAlign")&&e.setAttribute("vAlign",e.getAttribute("vAlign"));l.appendChild(e);
d||b(k,e,l)}else{var j=this.indexTable[c];for(k=0;k<g;k++){var n=j[k];if(n.rowIndex<c){e=this.getCell(n.rowIndex,n.cellIndex);e.rowSpan=n.rowSpan+1}else{e=this.cloneCell(a,true);this.setCellContent(e);l.appendChild(e)}d||b(k,e,l)}}this.update();return l},deleteRow:function(c){for(var a=this.table.rows[c],b=this.indexTable[c],g=this.colsNum,l=0,e=0;e<g;){var d=b[e],k=this.getCell(d.rowIndex,d.cellIndex);if(k.rowSpan>1)if(d.rowIndex==c){d=k.cloneNode(true);d.rowSpan=k.rowSpan-1;d.innerHTML="";k.rowSpan=
1;var j=c+1,n=this.table.rows[j];j=this.getPreviewMergedCellsNum(j,e)-l;if(j<e){j=e-j-1;m.insertAfter(n.cells[j],d)}else n.cells.length&&n.insertBefore(d,n.cells[0]);l+=1}e+=k.colSpan||1}c=[];l={};for(e=0;e<g;e++){k=b[e].rowIndex;d=b[e].cellIndex;n=k+"_"+d;if(!l[n]){l[n]=1;k=this.getCell(k,d);c.push(k)}}var p=[];v.each(c,function(q){q.rowSpan==1?q.parentNode.removeChild(q):p.push(q)});v.each(p,function(q){q.rowSpan--});a.parentNode.removeChild(a);this.update()},insertCol:function(c,a,b){function g(q,
o,r){if(q==0){q=o.nextSibling||o.previousSibling;if(q.tagName=="TH"){q=o.ownerDocument.createElement("th");q.appendChild(o.firstChild);r.insertBefore(q,o);m.remove(o)}}else if(o.tagName=="TH"){q=o.ownerDocument.createElement("td");q.appendChild(o.firstChild);r.insertBefore(q,o);m.remove(o)}}var l=this.rowsNum,e=0,d,k,j=parseInt((this.table.offsetWidth-(this.colsNum+1)*20-(this.colsNum+1))/(this.colsNum+1),10),n=typeof a=="string"&&a.toUpperCase()=="TH",p;if(c==0||c==this.colsNum)for(;e<l;e++){d=this.table.rows[e];
p=d.cells[c==0?c:d.cells.length];k=this.cloneCell(a,true);this.setCellContent(k);k.setAttribute("vAlign",k.getAttribute("vAlign"));p&&k.setAttribute("width",p.getAttribute("width"));c?m.insertAfter(d.cells[d.cells.length-1],k):d.insertBefore(k,d.cells[0]);n||g(e,k,d)}else for(;e<l;e++){p=this.indexTable[e][c];if(p.colIndex<c){k=this.getCell(p.rowIndex,p.cellIndex);k.colSpan=p.colSpan+1}else{d=this.table.rows[e];p=d.cells[p.cellIndex];k=this.cloneCell(a,true);this.setCellContent(k);k.setAttribute("vAlign",
k.getAttribute("vAlign"));p&&k.setAttribute("width",p.getAttribute("width"));p?d.insertBefore(k,p):d.appendChild(k)}n||g(e,k,d)}this.update();this.updateWidth(j,b||{tdPadding:10,tdBorder:1})},updateWidth:function(c,a){var b=this.table;a=f.getWidth(b)-a.tdPadding*2-a.tdBorder+c;if(a<b.ownerDocument.body.offsetWidth)b.setAttribute("width",a);else{b=m.getElementsByTagName(this.table,"td th");v.each(b,function(g){g.setAttribute("width",c)})}},deleteCol:function(c){for(var a=this.indexTable,b=this.table.rows,
g=this.table.getAttribute("width"),l=0,e=this.rowsNum,d={},k=0;k<e;){var j=a[k][c],n=j.rowIndex+"_"+j.colIndex;if(!d[n]){d[n]=1;n=this.getCell(j.rowIndex,j.cellIndex);l||(l=n&&parseInt(n.offsetWidth/n.colSpan,10).toFixed(0));if(n.colSpan>1)n.colSpan--;else b[k].deleteCell(j.cellIndex);k+=j.rowSpan||1}}this.table.setAttribute("width",g-l);this.update()},splitToCells:function(c){var a=this;c=this.splitToRows(c);v.each(c,function(b){a.splitToCols(b)})},splitToRows:function(c){var a=this.getCellInfo(c),
b=a.rowIndex,g=a.colIndex,l=[];c.rowSpan=1;l.push(c);for(var e=b,d=b+a.rowSpan;e<d;e++)if(e!=b){var k=this.table.rows[e].insertCell(g-this.getPreviewMergedCellsNum(e,g));k.colSpan=a.colSpan;this.setCellContent(k);k.setAttribute("vAlign",c.getAttribute("vAlign"));k.setAttribute("align",c.getAttribute("align"));if(c.style.cssText)k.style.cssText=c.style.cssText;l.push(k)}this.update();return l},getPreviewMergedCellsNum:function(c,a){for(var b=this.indexTable[c],g=0,l=0;l<a;){var e=b[l].colSpan;g+=e-
(b[l].rowIndex==c?1:0);l+=e}return g},splitToCols:function(c){var a=(c.offsetWidth/c.colSpan-22).toFixed(0),b=this.getCellInfo(c),g=b.rowIndex,l=b.colIndex,e=[];c.colSpan=1;c.setAttribute("width",a);e.push(c);for(var d=l,k=l+b.colSpan;d<k;d++)if(d!=l){var j=this.table.rows[g],n=j.insertCell(this.indexTable[g][d].cellIndex+1);n.rowSpan=b.rowSpan;this.setCellContent(n);n.setAttribute("vAlign",c.getAttribute("vAlign"));n.setAttribute("align",c.getAttribute("align"));n.setAttribute("width",a);if(c.style.cssText)n.style.cssText=
c.style.cssText;if(c.tagName=="TH"){var p=c.ownerDocument.createElement("th");p.appendChild(n.firstChild);p.setAttribute("vAlign",c.getAttribute("vAlign"));p.rowSpan=n.rowSpan;j.insertBefore(p,n);m.remove(n)}e.push(n)}this.update();return e},isLastCell:function(c,a,b){a=a||this.rowsNum;b=b||this.colsNum;c=this.getCellInfo(c);return c.rowIndex+c.rowSpan==a&&c.colIndex+c.colSpan==b},getLastCell:function(c){c=c||this.table.getElementsByTagName("td");this.getCellInfo(c[0]);var a=this,b=c[0],g=b.parentNode,
l=0,e=0,d;v.each(c,function(k){if(k.parentNode==g)e+=k.colSpan||1;l+=k.rowSpan*k.colSpan||1});d=l/e;v.each(c,function(k){if(a.isLastCell(k,d,e)){b=k;return false}});return b},selectRow:function(c){var a=this.indexTable[c];c=this.getCell(a[0].rowIndex,a[0].cellIndex);a=this.getCell(a[this.colsNum-1].rowIndex,a[this.colsNum-1].cellIndex);this.setSelected(this.getCellsRange(c,a))},selectTable:function(){var c=this.table.getElementsByTagName("td");this.setSelected(this.getCellsRange(c[0],c[c.length-1]))},
setBackground:function(c,a){if(typeof a==="string")v.each(c,function(n){n.style.backgroundColor=a});else if(typeof a==="object"){a=v.extend({repeat:true,colorList:["#ddd","#fff"]},a);for(var b=this.getCellInfo(c[0]).rowIndex,g=0,l=a.colorList,e=function(n,p,q){return n[p]?n[p]:q?n[p%n.length]:""},d=0,k;k=c[d++];){var j=this.getCellInfo(k);k.style.backgroundColor=e(l,b+g==j.rowIndex?g:++g,a.repeat)}}},removeBackground:function(c){v.each(c,function(a){a.style.backgroundColor=""})}}})();(function(){function h(d,
k){var j=m.getElementsByTagName(d,"td th");v.each(j,function(p){p.removeAttribute("width")});d.setAttribute("width",f(k,true,l(k,d)));var n=[];setTimeout(function(){v.each(j,function(p){p.colSpan==1&&n.push(p.offsetWidth)});v.each(j,function(p,q){p.colSpan==1&&p.setAttribute("width",n[q]+"")})},0)}function f(d,k,j){var n=d.body;return n.offsetWidth-(k?parseInt(m.getComputedStyle(n,"margin-left"),10)*2:0)-j.tableBorder*2-(d.options.offsetWidth||0)}function c(d){if(d=b(d).cell){var k=e(d);return k.selectedTds.length?
k.selectedTds:[d]}else return[]}var a=UE.UETable,b=function(d){return a.getTableItemsByRange(d)},g=function(d){return a.getUETableBySelected(d)},l=function(d,k){return a.getDefaultValue(d,k)},e=function(d){return a.getUETable(d)};UE.commands.inserttable={queryCommandState:function(){return b(this).table?-1:0},execCommand:function(d,k){function j(p,q){for(var o=[],r=p.numRows,s=p.numCols,t=0;t<r;t++){o.push("<tr"+(t==0?' class="firstRow"':"")+">");for(var u=0;u<s;u++)o.push('<td width="'+q+'"  vAlign="'+
p.tdvalign+'" >'+(y.ie&&y.version<11?m.fillChar:"<br/>")+"</td>");o.push("</tr>")}return"<table><tbody>"+o.join("")+"</tbody></table>"}k||(k=v.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign}));d=this.selection.getRange().startContainer;d=m.findParent(d,function(p){return m.isBlockElm(p)},true)||this.body;var n=l(this);d=Math.floor(d.offsetWidth/k.numCols-n.tdPadding*2-n.tdBorder);!k.tdvalign&&(k.tdvalign=this.options.tdvalign);this.execCommand("inserthtml",
j(k,d))}};UE.commands.insertparagraphbeforetable={queryCommandState:function(){return b(this).cell?0:-1},execCommand:function(){var d=b(this).table;if(d){var k=this.document.createElement("p");k.innerHTML=y.ie?"&nbsp;":"<br />";d.parentNode.insertBefore(k,d);this.selection.getRange().setStart(k,0).setCursor()}}};UE.commands.deletetable={queryCommandState:function(){var d=this.selection.getRange();return m.findParentByTagName(d.startContainer,"table",true)?0:-1},execCommand:function(d,k){d=this.selection.getRange();
if(k=k||m.findParentByTagName(d.startContainer,"table",true)){var j=k.nextSibling;if(!j){j=m.createElement(this.document,"p",{innerHTML:y.ie?m.fillChar:"<br/>"});k.parentNode.insertBefore(j,k)}m.remove(k);d=this.selection.getRange();j.nodeType==3?d.setStartBefore(j):d.setStart(j,0);d.setCursor(false,true);this.fireEvent("tablehasdeleted")}}};UE.commands.cellalign={queryCommandState:function(){return c(this).length?0:-1},execCommand:function(d,k){d=c(this);if(d.length)for(var j=0,n;n=d[j++];)n.setAttribute("align",
k)}};UE.commands.cellvalign={queryCommandState:function(){return c(this).length?0:-1},execCommand:function(d,k){d=c(this);if(d.length)for(var j=0,n;n=d[j++];)n.setAttribute("vAlign",k)}};UE.commands.insertcaption={queryCommandState:function(){var d=b(this).table;if(d)return d.getElementsByTagName("caption").length==0?1:-1;return-1},execCommand:function(){var d=b(this).table;if(d){var k=this.document.createElement("caption");k.innerHTML=y.ie?m.fillChar:"<br/>";d.insertBefore(k,d.firstChild);this.selection.getRange().setStart(k,
0).setCursor()}}};UE.commands.deletecaption={queryCommandState:function(){var d=this.selection.getRange();if(d=m.findParentByTagName(d.startContainer,"table"))return d.getElementsByTagName("caption").length==0?-1:1;return-1},execCommand:function(){var d=this.selection.getRange();if(d=m.findParentByTagName(d.startContainer,"table")){m.remove(d.getElementsByTagName("caption")[0]);this.selection.getRange().setStart(d.rows[0].cells[0],0).setCursor()}}};UE.commands.inserttitle={queryCommandState:function(){var d=
b(this).table;if(d){d=d.rows[0];return d.cells[d.cells.length-1].tagName.toLowerCase()!="th"?0:-1}return-1},execCommand:function(){var d=b(this).table;d&&e(d).insertRow(0,"th");d=d.getElementsByTagName("th")[0];this.selection.getRange().setStart(d,0).setCursor(false,true)}};UE.commands.deletetitle={queryCommandState:function(){var d=b(this).table;if(d){d=d.rows[0];return d.cells[d.cells.length-1].tagName.toLowerCase()=="th"?0:-1}return-1},execCommand:function(){var d=b(this).table;d&&m.remove(d.rows[0]);
d=d.getElementsByTagName("td")[0];this.selection.getRange().setStart(d,0).setCursor(false,true)}};UE.commands.inserttitlecol={queryCommandState:function(){var d=b(this).table;if(d)return d.rows[d.rows.length-1].getElementsByTagName("th").length?-1:0;return-1},execCommand:function(){var d=b(this).table;d&&e(d).insertCol(0,"th");h(d,this);d=d.getElementsByTagName("th")[0];this.selection.getRange().setStart(d,0).setCursor(false,true)}};UE.commands.deletetitlecol={queryCommandState:function(){var d=b(this).table;
if(d)return d.rows[d.rows.length-1].getElementsByTagName("th").length?0:-1;return-1},execCommand:function(){var d=b(this).table;if(d)for(var k=0;k<d.rows.length;k++)m.remove(d.rows[k].children[0]);h(d,this);d=d.getElementsByTagName("td")[0];this.selection.getRange().setStart(d,0).setCursor(false,true)}};UE.commands.mergeright={queryCommandState:function(){var d=b(this),k=d.table;d=d.cell;if(!k||!d)return-1;var j=e(k);if(j.selectedTds.length)return-1;var n=j.getCellInfo(d),p=n.colIndex+n.colSpan;if(p>=
j.colsNum)return-1;j=j.indexTable[n.rowIndex][p];k=k.rows[j.rowIndex].cells[j.cellIndex];if(!k||d.tagName!=k.tagName)return-1;return j.rowIndex==n.rowIndex&&j.rowSpan==n.rowSpan?0:-1},execCommand:function(){var d=this.selection.getRange(),k=d.createBookmark(true),j=b(this).cell;e(j).mergeRight(j);d.moveToBookmark(k).select()}};UE.commands.mergedown={queryCommandState:function(){var d=b(this),k=d.table;d=d.cell;if(!k||!d)return-1;var j=e(k);if(j.selectedTds.length)return-1;var n=j.getCellInfo(d),p=
n.rowIndex+n.rowSpan;if(p>=j.rowsNum)return-1;j=j.indexTable[p][n.colIndex];k=k.rows[j.rowIndex].cells[j.cellIndex];if(!k||d.tagName!=k.tagName)return-1;return j.colIndex==n.colIndex&&j.colSpan==n.colSpan?0:-1},execCommand:function(){var d=this.selection.getRange(),k=d.createBookmark(true),j=b(this).cell;e(j).mergeDown(j);d.moveToBookmark(k).select()}};UE.commands.mergecells={queryCommandState:function(){return g(this)?0:-1},execCommand:function(){var d=g(this);if(d&&d.selectedTds.length){var k=d.selectedTds[0];
d.mergeRange();d=this.selection.getRange();m.isEmptyBlock(k)?d.setStart(k,0).collapse(true):d.selectNodeContents(k);d.select()}}};UE.commands.insertrow={queryCommandState:function(){var d=b(this),k=d.cell;return k&&(k.tagName=="TD"||k.tagName=="TH"&&d.tr!==d.table.rows[0])&&e(d.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var d=this.selection.getRange(),k=d.createBookmark(true),j=b(this),n=j.cell;j=j.table;var p=e(j),q=p.getCellInfo(n);if(p.selectedTds.length){q=p.cellsRange;
for(var o=0,r=q.endRowIndex-q.beginRowIndex+1;o<r;o++)p.insertRow(q.beginRowIndex,n)}else p.insertRow(q.rowIndex,n);d.moveToBookmark(k).select();j.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",j)}};UE.commands.insertrownext={queryCommandState:function(){var d=b(this),k=d.cell;return k&&k.tagName=="TD"&&e(d.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var d=this.selection.getRange(),k=d.createBookmark(true),j=b(this),n=j.cell;j=j.table;var p=e(j),q=p.getCellInfo(n);
if(p.selectedTds.length){q=p.cellsRange;for(var o=0,r=q.endRowIndex-q.beginRowIndex+1;o<r;o++)p.insertRow(q.endRowIndex+1,n)}else p.insertRow(q.rowIndex+q.rowSpan,n);d.moveToBookmark(k).select();j.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",j)}};UE.commands.deleterow={queryCommandState:function(){return b(this).cell?0:-1},execCommand:function(){var d=b(this).cell,k=e(d),j=k.cellsRange,n=k.getCellInfo(d),p=k.getVSideCell(d),q=k.getVSideCell(d,true);d=this.selection.getRange();
if(v.isEmptyObject(j))k.deleteRow(n.rowIndex);else for(var o=j.beginRowIndex;o<j.endRowIndex+1;o++)k.deleteRow(j.beginRowIndex);o=k.table;if(o.getElementsByTagName("td").length)if(n.rowSpan==1||n.rowSpan==j.endRowIndex-j.beginRowIndex+1){if(q||p)d.selectNodeContents(q||p).setCursor(false,true)}else(k=k.getCell(n.rowIndex,k.indexTable[n.rowIndex][n.colIndex].cellIndex))&&d.selectNodeContents(k).setCursor(false,true);else{k=o.nextSibling;m.remove(o);k&&d.setStart(k,0).setCursor(false,true)}o.getAttribute("interlaced")===
"enabled"&&this.fireEvent("interlacetable",o)}};UE.commands.insertcol={queryCommandState:function(){var d=b(this),k=d.cell;return k&&(k.tagName=="TD"||k.tagName=="TH"&&k!==d.tr.cells[0])&&e(d.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(d){var k=this.selection.getRange(),j=k.createBookmark(true);if(this.queryCommandState(d)!=-1){d=b(this).cell;var n=e(d),p=n.getCellInfo(d);if(n.selectedTds.length){p=n.cellsRange;for(var q=0,o=p.endColIndex-p.beginColIndex+1;q<o;q++)n.insertCol(p.beginColIndex,
d)}else n.insertCol(p.colIndex,d);k.moveToBookmark(j).select(true)}}};UE.commands.insertcolnext={queryCommandState:function(){var d=b(this);return d.cell&&e(d.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var d=this.selection.getRange(),k=d.createBookmark(true),j=b(this).cell,n=e(j),p=n.getCellInfo(j);if(n.selectedTds.length){p=n.cellsRange;for(var q=0,o=p.endColIndex-p.beginColIndex+1;q<o;q++)n.insertCol(p.endColIndex+1,j)}else n.insertCol(p.colIndex+p.colSpan,j);d.moveToBookmark(k).select()}};
UE.commands.deletecol={queryCommandState:function(){return b(this).cell?0:-1},execCommand:function(){var d=b(this).cell,k=e(d),j=k.cellsRange,n=k.getCellInfo(d),p=k.getHSideCell(d),q=k.getHSideCell(d,true);if(v.isEmptyObject(j))k.deleteCol(n.colIndex);else for(n=j.beginColIndex;n<j.endColIndex+1;n++)k.deleteCol(j.beginColIndex);k=k.table;j=this.selection.getRange();if(k.getElementsByTagName("td").length)if(m.inDoc(d,this.document))j.setStart(d,0).setCursor(false,true);else if(q&&m.inDoc(q,this.document))j.selectNodeContents(q).setCursor(false,
true);else p&&m.inDoc(p,this.document)&&j.selectNodeContents(p).setCursor(true,true);else{d=k.nextSibling;m.remove(k);d&&j.setStart(d,0).setCursor(false,true)}}};UE.commands.splittocells={queryCommandState:function(){var d=b(this),k=d.cell;if(!k)return-1;if(e(d.table).selectedTds.length>0)return-1;return k&&(k.colSpan>1||k.rowSpan>1)?0:-1},execCommand:function(){var d=this.selection.getRange(),k=d.createBookmark(true),j=b(this).cell;e(j).splitToCells(j);d.moveToBookmark(k).select()}};UE.commands.splittorows=
{queryCommandState:function(){var d=b(this),k=d.cell;if(!k)return-1;if(e(d.table).selectedTds.length>0)return-1;return k&&k.rowSpan>1?0:-1},execCommand:function(){var d=this.selection.getRange(),k=d.createBookmark(true),j=b(this).cell;e(j).splitToRows(j);d.moveToBookmark(k).select()}};UE.commands.splittocols={queryCommandState:function(){var d=b(this),k=d.cell;if(!k)return-1;if(e(d.table).selectedTds.length>0)return-1;return k&&k.colSpan>1?0:-1},execCommand:function(){var d=this.selection.getRange(),
k=d.createBookmark(true),j=b(this).cell;e(j).splitToCols(j);d.moveToBookmark(k).select()}};UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return b(this).table?0:-1},execCommand:function(d){var k=b(this).table;if(k)if(d=="adaptbywindow")h(k,this);else{d=m.getElementsByTagName(k,"td th");v.each(d,function(j){j.removeAttribute("width")});k.removeAttribute("width")}}};UE.commands.averagedistributecol={queryCommandState:function(){var d=g(this);if(!d)return-1;return d.isFullRow()||
d.isFullCol()?0:-1},execCommand:function(){function d(){var p=n.table,q=0,o=0,r=l(j,p);if(n.isFullRow()){q=p.offsetWidth;o=n.colsNum}else{p=n.cellsRange.endColIndex;for(var s,t=n.cellsRange.beginColIndex;t<=p;){s=n.selectedTds[t];q+=s.offsetWidth;t+=s.colSpan;o+=1}}return Math.ceil(q/o)-r.tdBorder*2-r.tdPadding*2}function k(p){v.each(m.getElementsByTagName(n.table,"th"),function(o){o.setAttribute("width","")});var q=n.isFullRow()?m.getElementsByTagName(n.table,"td"):n.selectedTds;v.each(q,function(o){o.colSpan==
1&&o.setAttribute("width",p)})}var j=this,n=g(j);n&&n.selectedTds.length&&k(d())}};UE.commands.averagedistributerow={queryCommandState:function(){var d=g(this);if(!d)return-1;if(d.selectedTds&&/th/ig.test(d.selectedTds[0].tagName))return-1;return d.isFullRow()||d.isFullCol()?0:-1},execCommand:function(){function d(){var p,q=0;p=n.table;var o=l(j,p),r=parseInt(m.getComputedStyle(p.getElementsByTagName("td")[0],"padding-top"));if(n.isFullCol()){q=m.getElementsByTagName(p,"caption");var s=m.getElementsByTagName(p,
"th"),t,u;if(q.length>0)t=q[0].offsetHeight;if(s.length>0)u=s[0].offsetHeight;q=p.offsetHeight-(t||0)-(u||0);p=s.length==0?n.rowsNum:n.rowsNum-1}else{u=n.cellsRange.beginRowIndex;s=n.cellsRange.endRowIndex;t=0;p=m.getElementsByTagName(p,"tr");for(u=u;u<=s;u++){q+=p[u].offsetHeight;t+=1}p=t}return y.ie&&y.version<9?Math.ceil(q/p):Math.ceil(q/p)-o.tdBorder*2-r*2}function k(p){var q=n.isFullCol()?m.getElementsByTagName(n.table,"td"):n.selectedTds;v.each(q,function(o){o.rowSpan==1&&o.setAttribute("height",
p)})}var j=this,n=g(j);n&&n.selectedTds.length&&k(d())}};UE.commands.cellalignment={queryCommandState:function(){return b(this).table?0:-1},execCommand:function(d,k){if(d=g(this))v.each(d.selectedTds,function(j){m.setAttributes(j,k)});else{d=(d=this.selection.getStart())&&m.findParentByTagName(d,["td","th","caption"],true);if(/caption/ig.test(d.tagName)){d.style.textAlign=k.align;d.style.verticalAlign=k.vAlign}else m.setAttributes(d,k);this.selection.getRange().setCursor(true)}},queryCommandValue:function(){var d=
b(this).cell;d||(d=c(this)[0]);if(d){var k=UE.UETable.getUETable(d).selectedTds;!k.length&&(k=d);return UE.UETable.getTableCellAlignState(k)}else return null}};UE.commands.tablealignment={queryCommandState:function(){if(y.ie&&y.version<8)return-1;return b(this).table?0:-1},execCommand:function(d,k){(d=(d=this.selection.getStart())&&m.findParentByTagName(d,["table"],true))&&d.setAttribute("align",k)}};UE.commands.edittable={queryCommandState:function(){return b(this).table?0:-1},execCommand:function(d,
k){d=this.selection.getRange();if(d=m.findParentByTagName(d.startContainer,"table")){d=m.getElementsByTagName(d,"td").concat(m.getElementsByTagName(d,"th"),m.getElementsByTagName(d,"caption"));v.each(d,function(j){j.style.borderColor=k})}}};UE.commands.edittd={queryCommandState:function(){return b(this).table?0:-1},execCommand:function(d,k){if(d=g(this))v.each(d.selectedTds,function(j){j.style.backgroundColor=k});else if(d=(d=this.selection.getStart())&&m.findParentByTagName(d,["td","th","caption"],
true))d.style.backgroundColor=k}};UE.commands.settablebackground={queryCommandState:function(){return c(this).length>1?0:-1},execCommand:function(d,k){d=c(this);e(d[0]).setBackground(d,k)}};UE.commands.cleartablebackground={queryCommandState:function(){var d=c(this);if(!d.length)return-1;for(var k=0,j;j=d[k++];)if(j.style.backgroundColor!=="")return 0;return-1},execCommand:function(){var d=c(this);e(d[0]).removeBackground(d)}};UE.commands.interlacetable=UE.commands.uninterlacetable={queryCommandState:function(d){var k=
b(this).table;if(!k)return-1;k=k.getAttribute("interlaced");return d=="interlacetable"?k==="enabled"?-1:0:!k||k==="disabled"?-1:0},execCommand:function(d,k){var j=b(this).table;if(d=="interlacetable"){j.setAttribute("interlaced","enabled");this.fireEvent("interlacetable",j,k)}else{j.setAttribute("interlaced","disabled");this.fireEvent("uninterlacetable",j)}}};UE.commands.setbordervisible={queryCommandState:function(){if(!b(this).table)return-1;return 0},execCommand:function(){var d=b(this).table;
v.each(m.getElementsByTagName(d,"td"),function(k){k.style.borderWidth="1px";k.style.borderStyle="solid"})}}})();UE.plugins.table=function(){function h(){}function f(w){if(w.tagName=="TD"||w.tagName=="TH")return w;if(w=m.findParentByTagName(w,"td",true)||m.findParentByTagName(w,"th",true))return w;return null}function c(w){var A=new RegExp(m.fillChar,"g");if(w[y.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(A,"").length>0)return 0;for(var C in I.$isNotEmpty)if(w.getElementsByTagName(C).length)return 0;
return 1}function a(w){if(w.pageX||w.pageY)return{x:w.pageX,y:w.pageY};return{x:w.clientX+H.document.body.scrollLeft-H.document.body.clientLeft,y:w.clientY+H.document.body.scrollTop-H.document.body.clientTop}}function b(w){if(!L())try{var A=f(w.target||w.srcElement),C;if(qa){H.body.style.webkitUserSelect="none";if(Math.abs(sa.x-w.clientX)>Ja||Math.abs(sa.y-w.clientY)>Ja){t();qa=false;ga=0;x(w)}}if(ka&&ha){ga=0;H.body.style.webkitUserSelect="none";H.selection.getNative()[y.ie9below?"empty":"removeAllRanges"]();
C=a(w);j(H,true,ka,C,A);if(ka=="h")ja.style.left=d(ha,w)+"px";else if(ka=="v")ja.style.top=k(ha,w)+"px"}else if(A){if(H.fireEvent("excludetable",A)!==true){C=a(w);var G=n(A,C),O=m.findParentByTagName(A,"table",true);if(e(O,A,w,true)){if(H.fireEvent("excludetable",O)!==true)H.body.style.cursor="url("+H.options.cursorpath+"h.png),pointer"}else if(e(O,A,w)){if(H.fireEvent("excludetable",O)!==true)H.body.style.cursor="url("+H.options.cursorpath+"v.png),pointer"}else{H.body.style.cursor="text";if(/\d/.test(G)){G=
G.replace(/\d/,"");A=da(A).getPreviewCell(A,G=="v")}j(H,A?!!G:false,A?G:"",C,A)}}}else g(false,O,H)}catch($){h($)}}function g(w,A,C){if(w)l(A,C);else ta||(Qa=setTimeout(function(){!ta&&aa&&aa.parentNode&&aa.parentNode.removeChild(aa)},2E3))}function l(w,A){function C(K,J){clearTimeout(E);E=setTimeout(function(){A.fireEvent("tableClicked",w,J)},300)}function G(){clearTimeout(E);var K=da(w),J=w.rows[0].cells[0],N=K.getLastCell();N=K.getCellsRange(J,N);A.selection.getRange().setStart(J,0).setCursor(false,
true);K.setSelected(N)}var O=m.getXY(w),$=w.ownerDocument;if(aa&&aa.parentNode)return aa;aa=$.createElement("div");aa.contentEditable=false;aa.innerHTML="";aa.style.cssText="width:15px;height:15px;background-image:url("+A.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(O.y-15)+"px;left:"+O.x+"px;";m.unSelectable(aa);aa.onmouseover=function(){ta=true};aa.onmouseout=function(){ta=false};m.on(aa,"click",function(K,J){C(J,this)});m.on(aa,"dblclick",function(K,
J){G(J)});m.on(aa,"dragstart",function(K,J){m.preventDefault(J)});var E;$.body.appendChild(aa)}function e(w,A,C,G){C=a(C);A=n(A,C);if(G){G=(G=w.getElementsByTagName("caption")[0])?G.offsetHeight:0;return A=="v1"&&C.y-m.getXY(w).y-G<8}else return A=="h1"&&C.x-m.getXY(w).x<8}function d(w,A){var C=da(w);if(C){var G=C.getSameEndPosCells(w,"x")[0];w=C.getSameStartPosXCells(w)[0];A=a(A).x;C=(G?m.getXY(G).x:m.getXY(C.table).x)+20;G=w?m.getXY(w).x+w.offsetWidth-20:H.body.offsetWidth+5||parseInt(m.getComputedStyle(H.body,
"width"),10);C+=Da;G-=Da;return A<C?C:A>G?G:A}}function k(w,A){try{var C=m.getXY(w).y,G=a(A).y;return G<C?C:G}catch(O){h(O)}}function j(w,A,C,G,O){try{w.body.style.cursor=C=="h"?"col-resize":C=="v"?"row-resize":"text";if(y.ie)if(C&&!ma&&!ia(w)){Ka(w,w.document);La(C,O)}else na(w);Ea=A}catch($){h($)}}function n(w,A){var C=m.getXY(w);if(!C)return"";if(C.x+w.offsetWidth-A.x<ua)return"h";if(A.x-C.x<ua)return"h1";if(C.y+w.offsetHeight-A.y<ua)return"v";if(A.y-C.y<ua)return"v1";return""}function p(w,A){if(!L()){sa=
{x:A.clientX,y:A.clientY};if(A.button==2){w=ia(H);var C=false;if(w){var G=Ma(H,A);v.each(w.selectedTds,function(O){if(O===G)C=true});if(C){G=w.selectedTds[0];setTimeout(function(){H.selection.getRange().setStart(G,0).setCursor(false,true)},0)}else{va(m.getElementsByTagName(H.body,"th td"));w.clearSelected()}}}else o(A)}}function q(w){ga=0;w=w||H.window.event;var A=f(w.target||w.srcElement);if(A){var C;if(C=n(A,a(w))){na(H);if(C=="h1"){C="h";if(e(m.findParentByTagName(A,"table"),A,w))H.execCommand("adaptbywindow");
else(A=da(A).getPreviewCell(A))&&H.selection.getRange().selectNodeContents(A).setCursor(true,true)}if(C=="h"){w=da(A);var G=S(A,w.table,true);G=s(G,"left");w.width=w.offsetWidth;var O=[],$=[];v.each(G,function(E){O.push(E.offsetWidth)});v.each(G,function(E){E.removeAttribute("width")});window.setTimeout(function(){var E=true;v.each(G,function(J,N){J=J.offsetWidth;if(J>O[N])return E=false;$.push(J)});var K=E?$:O;v.each(G,function(J,N){J.width=K[N]-wa()})},0)}}}}function o(w){va(m.getElementsByTagName(H.body,
"td th"));v.each(H.document.getElementsByTagName("table"),function(C){C.ueTable=null});if(ba=Ma(H,w)){var A=m.findParentByTagName(ba,"table",true);(ut=da(A))&&ut.clearSelected();if(Ea)r(w);else{H.document.body.style.webkitUserSelect="";ma=true;H.addListener("mouseover",F)}}}function r(w){if(y.ie)w=u(w);t();qa=true;xa=setTimeout(function(){x(w)},Na)}function s(w,A){for(var C=[],G=null,O=0,$=w.length;O<$;O++)(G=w[O][A])&&C.push(G);return C}function t(){xa&&clearTimeout(xa);xa=null}function u(w){var A=
["pageX","pageY","clientX","clientY","srcElement","target"],C={};if(w)for(var G=0,O,$;O=A[G];G++)($=w[O])&&(C[O]=$);return C}function x(w){qa=false;if(ba=w.target||w.srcElement){w=n(ba,a(w));if(/\d/.test(w)){w=w.replace(/\d/,"");ba=da(ba).getPreviewCell(ba,w=="v")}na(H);Ka(H,H.document);H.fireEvent("saveScene");La(w,ba);ma=true;ka=w;ha=ba}}function z(w,A){if(!L()){t();qa=false;if(Ea){ga=++ga%3;sa={x:A.clientX,y:A.clientY};Ra=setTimeout(function(){ga>0&&ga--},Na);if(ga===2){ga=0;q(A);return}}if(A.button!=
2){w=this.selection.getRange();var C=m.findParentByTagName(w.startContainer,"table",true),G=m.findParentByTagName(w.endContainer,"table",true);if(C||G)if(C===G){C=m.findParentByTagName(w.startContainer,["td","th","caption"],true);G=m.findParentByTagName(w.endContainer,["td","th","caption"],true);C!==G&&this.selection.clearRange()}else this.selection.clearRange();ma=false;this.document.body.style.webkitUserSelect="";if(ka&&ha){this.selection.getNative()[y.ie9below?"empty":"removeAllRanges"]();ga=0;
if(ja=this.document.getElementById("ue_tableDragLine")){A=m.getXY(ha);w=m.getXY(ja);switch(ka){case "h":M(ha,w.x-A.x);break;case "v":Q(ha,w.y-A.y-ha.offsetHeight);break;default:}ka="";ha=null;na(this);this.fireEvent("saveScene");return}}if(ba){if(C=(w=da(ba))?w.selectedTds[0]:null){w=new ea.Range(this.document);m.isEmptyBlock(C)?w.setStart(C,0).setCursor(false,true):w.selectNodeContents(C).shrinkBoundary().setCursor(false,true)}else{w=this.selection.getRange().shrinkBoundary();if(!w.collapsed){C=
m.findParentByTagName(w.startContainer,["td","th"],true);G=m.findParentByTagName(w.endContainer,["td","th"],true);if(C&&!G||!C&&G||C&&G&&C!==G)w.setCursor(false,true)}}ba=null;this.removeListener("mouseover",F)}else{(C=m.findParentByTagName(A.target||A.srcElement,"td",true))||(C=m.findParentByTagName(A.target||A.srcElement,"th",true));if(C&&(C.tagName=="TD"||C.tagName=="TH")){if(this.fireEvent("excludetable",C)===true)return;w=new ea.Range(this.document);w.setStart(C,0).setCursor(false,true)}}this._selectionChange(250,
A)}}}function F(w,A){if(!L()){w=A.target||A.srcElement;la=m.findParentByTagName(w,"td",true)||m.findParentByTagName(w,"th",true);if(ba&&la&&(ba.tagName=="TD"&&la.tagName=="TD"||ba.tagName=="TH"&&la.tagName=="TH")&&m.findParentByTagName(ba,"table")==m.findParentByTagName(la,"table")){w=da(la);if(ba!=la){this.document.body.style.webkitUserSelect="none";this.selection.getNative()[y.ie9below?"empty":"removeAllRanges"]();var C=w.getCellsRange(ba,la);w.setSelected(C)}else{this.document.body.style.webkitUserSelect=
"";w.clearSelected()}}A.preventDefault?A.preventDefault():(A.returnValue=false)}}function D(w,A,C){var G=parseInt(m.getComputedStyle(w,"line-height"),10);A=C+A;A=A<G?G:A;if(w.style.height)w.style.height="";w.rowSpan==1?w.setAttribute("height",A):w.removeAttribute&&w.removeAttribute("height")}function M(w,A){var C=da(w);if(C){C=C.table;var G=S(w,C);C.style.width="";C.removeAttribute("width");A=R(A,w,G);w.nextSibling?v.each(G,function(O){O.left.width=+O.left.width+A;O.right&&(O.right.width=+O.right.width-
A)}):v.each(G,function(O){O.left.width-=-A})}}function L(){return H.body.contentEditable==="false"}function Q(w,A){if(!(Math.abs(A)<10)){var C=da(w);if(C){w=C.getSameEndPosCells(w,"y");C=w[0]?w[0].offsetHeight:0;for(var G=0,O;O=w[G++];)D(O,A,C)}}}function S(w,A,C){A||(A=m.findParentByTagName(w,"table"));if(!A)return null;m.getNodeIndex(w);w=w;A=A.rows;for(var G=0;w;){if(w.nodeType===1)G+=w.colSpan||1;w=w.previousSibling}w=null;var O=[];v.each(A,function($){var E=0;v.each($.cells,function(K){E+=K.colSpan||
1;if(E===G){O.push({left:K,right:K.nextSibling||null});return false}else if(E>G){C&&O.push({left:K});return false}})});return O}function R(w,A,C){w-=wa();if(w<0)return 0;w-=Z(A);var G=w<0?"left":"right";w=Math.abs(w);v.each(C,function(O){if(O=O[G])w=Math.min(w,Z(O)-Da)});w=w<0?0:w;return G==="left"?-w:w}function Z(w){var A=0;A=w.offsetWidth-wa();w.nextSibling||(A-=Fa(w));A=A<0?0:A;try{w.width=A}catch(C){}return A}function Fa(w){tab=m.findParentByTagName(w,"table",false);if(tab.offsetVal===undefined){var A=
w.previousSibling;tab.offsetVal=A?w.offsetWidth-A.offsetWidth===ca.borderWidth?ca.borderWidth:0:0}return tab.offsetVal}function wa(){if(ca.tabcellSpace===undefined){var w=H.document.createElement("table"),A=H.document.createElement("tbody"),C=H.document.createElement("tr"),G=H.document.createElement("td"),O=null;G.style.cssText="border: 0;";G.width=1;C.appendChild(G);C.appendChild(O=G.cloneNode(false));A.appendChild(C);w.appendChild(A);w.style.cssText="visibility: hidden;";H.body.appendChild(w);ca.paddingSpace=
G.offsetWidth-1;A=w.offsetWidth;G.style.cssText="";O.style.cssText="";ca.borderWidth=(w.offsetWidth-A)/3;ca.tabcellSpace=ca.paddingSpace+ca.borderWidth;H.body.removeChild(w)}wa=function(){return ca.tabcellSpace};return ca.tabcellSpace}function Ka(w){if(!ma){ja=w.document.createElement("div");m.setAttributes(ja,{id:"ue_tableDragLine",unselectable:"on",contenteditable:false,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"});
w.body.appendChild(ja)}}function na(w){if(!ma)for(var A;A=w.document.getElementById("ue_tableDragLine");)m.remove(A)}function La(w,A){if(A){var C=m.findParentByTagName(A,"table"),G=C.getElementsByTagName("caption"),O=C.offsetWidth,$=C.offsetHeight-(G.length>0?G[0].offsetHeight:0);C=m.getXY(C);var E=m.getXY(A);switch(w){case "h":w="height:"+$+"px;top:"+(C.y+(G.length>0?G[0].offsetHeight:0))+"px;left:"+(E.x+A.offsetWidth);ja.style.cssText=w+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";
break;case "v":w="width:"+O+"px;left:"+C.x+"px;top:"+(E.y+A.offsetHeight);ja.style.cssText=w+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)";break;default:}}}function Ga(w,A){w=m.getElementsByTagName(w.body,"table");for(var C,G=0,O;O=w[G++];){C=m.getElementsByTagName(O,"td");if(C[0])if(A){C=C[0].style.borderColor.replace(/\s/g,"");/(#ffffff)|(rgb\(255,255,255\))/ig.test(C)&&m.addClass(O,"noBorderTable")}else m.removeClasses(O,
"noBorderTable")}}function Sa(w,A,C){var G=w.body;return G.offsetWidth-(A?parseInt(m.getComputedStyle(G,"margin-left"),10)*2:0)-C.tableBorder*2-(w.options.offsetWidth||0)}function Ma(w,A){var C=m.findParentByTagName(A.target||A.srcElement,["td","th"],true),G=null;if(!C)return null;G=n(C,a(A));if(!C)return null;if(G==="h1"&&C.previousSibling){G=m.getXY(C);var O=C.offsetWidth;if(Math.abs(G.x+O-A.clientX)>O/3)C=C.previousSibling}else if(G==="v1"&&C.parentNode.previousSibling){G=m.getXY(C);O=C.offsetHeight;
if(Math.abs(G.y+O-A.clientY)>O/3)C=C.parentNode.previousSibling.firstChild}return C&&w.fireEvent("excludetable",C)!==true?C:null}var H=this,xa=null,Ra=null,Da=5,qa=false,ua=5,Ja=10,ga=0,sa=null,Na=360,ca=UE.UETable,da=function(w){return ca.getUETable(w)},ia=function(w){return ca.getUETableBySelected(w)},Ha=function(w,A){return ca.getDefaultValue(w,A)},va=function(w){return ca.removeSelectedClass(w)};H.ready(function(){var w=this,A=w.selection.getText;w.selection.getText=function(){var C=ia(w);if(C){var G=
"";v.each(C.selectedTds,function(O){G+=O[y.ie?"innerText":"textContent"]});return G}else return A.call(w.selection)}});var ba=null,la=null,ka="",Ea=false,aa=null,ta=false,ja=null,ha=null,ma=false;H.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:H.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:false,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]});H.getUETable=da;var Ta={deletetable:1,inserttable:1,cellvalign:1,
insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1};H.ready(function(){v.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:1px solid #BBB;background-color:#F7F7F7;}table tr.firstRow th{border-top-width:2px;}.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }td p{margin:0;padding:0;}",
H.document);var w,A,C;H.addListener("keydown",function(E,K){E=K.keyCode||K.which;if(E==8){var J=ia(this);if(J&&J.selectedTds.length){if(J.isFullCol())this.execCommand("deletecol");else J.isFullRow()?this.execCommand("deleterow"):this.fireEvent("delcells");m.preventDefault(K)}var N=m.findParentByTagName(this.selection.getStart(),"caption",true),P=this.selection.getRange();if(P.collapsed&&N&&c(N)){this.fireEvent("saveScene");J=N.parentNode;m.remove(N);J&&P.setStart(J.rows[0].cells[0],0).setCursor(false,
true);this.fireEvent("saveScene")}}if(E==46)if(J=ia(this)){this.fireEvent("saveScene");for(N=0;P=J.selectedTds[N++];)m.fillNode(this.document,P);this.fireEvent("saveScene");m.preventDefault(K)}if(E==13){E=this.selection.getRange();if(N=m.findParentByTagName(E.startContainer,"caption",true)){J=m.findParentByTagName(N,"table");if(E.collapsed)N&&E.setStart(J.rows[0].cells[0],0).setCursor(false,true);else{E.deleteContents();this.fireEvent("saveScene")}m.preventDefault(K);return}if(E.collapsed)if(J=m.findParentByTagName(E.startContainer,
"table")){P=J.rows[0].cells[0];N=m.findParentByTagName(this.selection.getStart(),["td","th"],true);J=J.previousSibling;if(P===N&&(!J||J.nodeType==1&&J.tagName=="TABLE")&&m.isStartInblock(E))if((E=m.findParent(this.selection.getStart(),function(T){return m.isBlockElm(T)},true))&&(/t(h|d)/i.test(E.tagName)||E===N.firstChild)){this.execCommand("insertparagraphbeforetable");m.preventDefault(K)}}}if((K.ctrlKey||K.metaKey)&&K.keyCode=="67"){w=null;if(J=ia(this)){K=J.selectedTds;A=J.isFullCol();C=J.isFullRow();
w=[[J.cloneCell(K[0],null,true)]];for(N=1;P=K[N];N++)P.parentNode!==K[N-1].parentNode?w.push([J.cloneCell(P,null,true)]):w[w.length-1].push(J.cloneCell(P,null,true))}}});H.addListener("tablehasdeleted",function(){j(this,false,"",null);aa&&m.remove(aa)});H.addListener("beforepaste",function(E,K){var J=this;E=J.selection.getRange();if(m.findParentByTagName(E.startContainer,"caption",true)){E=J.document.createElement("div");E.innerHTML=K.html;K.html=E[y.ie9below?"innerText":"textContent"]}else{var N=
ia(J);if(w){J.fireEvent("saveScene");E=J.selection.getRange();var P=m.findParentByTagName(E.startContainer,["td","th"],true),T,U;if(P){N=da(P);if(C){var W=N.getCellInfo(P).rowIndex;P.tagName=="TH"&&W++;E=0;for(var V;V=w[E++];){U=N.insertRow(W++,"td");for(var Y=0,X;X=V[Y];Y++){(P=U.cells[Y])||(P=U.insertCell(Y));P.innerHTML=X.innerHTML;X.getAttribute("width")&&P.setAttribute("width",X.getAttribute("width"));X.getAttribute("vAlign")&&P.setAttribute("vAlign",X.getAttribute("vAlign"));X.getAttribute("align")&&
P.setAttribute("align",X.getAttribute("align"));X.style.cssText&&(P.style.cssText=X.style.cssText)}for(Y=0;X=U.cells[Y];Y++){if(!V[Y])break;X.innerHTML=V[Y].innerHTML;V[Y].getAttribute("width")&&X.setAttribute("width",V[Y].getAttribute("width"));V[Y].getAttribute("vAlign")&&X.setAttribute("vAlign",V[Y].getAttribute("vAlign"));V[Y].getAttribute("align")&&X.setAttribute("align",V[Y].getAttribute("align"));V[Y].style.cssText&&(X.style.cssText=V[Y].style.cssText)}}}else{if(A){W=N.getCellInfo(P);Y=P=0;
for(V=w[0];X=V[Y++];)P+=X.colSpan||1;J.__hasEnterExecCommand=true;for(E=0;E<P;E++)J.execCommand("insertcol");J.__hasEnterExecCommand=false;P=N.table.rows[0].cells[W.cellIndex];if(P.tagName=="TH")P=N.table.rows[1].cells[W.cellIndex]}for(E=0;V=w[E++];){T=P;for(Y=0;X=V[Y++];)if(P){P.innerHTML=X.innerHTML;X.getAttribute("width")&&P.setAttribute("width",X.getAttribute("width"));X.getAttribute("vAlign")&&P.setAttribute("vAlign",X.getAttribute("vAlign"));X.getAttribute("align")&&P.setAttribute("align",X.getAttribute("align"));
X.style.cssText&&(P.style.cssText=X.style.cssText);U=P;P=P.nextSibling}else{W=X.cloneNode(true);m.removeAttributes(W,["class","rowSpan","colSpan"]);U.parentNode.appendChild(W)}P=N.getNextCell(T,true,true);if(!w[E])break;if(!P){W=N.getCellInfo(T);N.table.insertRow(N.table.rows.length);N.update();P=N.getVSideCell(T,true)}}}N.update()}else{N=J.document.createElement("table");for(E=0;V=w[E++];){U=N.insertRow(N.rows.length);for(Y=0;X=V[Y++];){W=ca.cloneCell(X,null,true);m.removeAttributes(W,["class"]);
U.appendChild(W)}if(Y==2&&W.rowSpan>1)W.rowSpan=1}E=Ha(J);E=J.body.offsetWidth-parseInt(m.getComputedStyle(J.body,"margin-left"),10)*2-E.tableBorder*2-(J.options.offsetWidth||0);J.execCommand("insertHTML","<table  "+(A&&C?'width="'+E+'"':"")+">"+N.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}J.fireEvent("contentchange");J.fireEvent("saveScene");K.html="";return true}else{E=J.document.createElement("div");E.innerHTML=K.html;V=E.getElementsByTagName("table");if(m.findParentByTagName(J.selection.getStart(),
"table")){v.each(V,function(ya){m.remove(ya)});if(m.findParentByTagName(J.selection.getStart(),"caption",true))E.innerHTML=E[y.ie?"innerText":"textContent"]}else v.each(V,function(ya){m.removeAttributes(ya,["style","border"]);v.each(m.getElementsByTagName(ya,"td"),function(za){c(za)&&m.fillNode(J.document,za);za.style.width="";za.style.height=""})});K.html=E.innerHTML}}});H.addListener("afterpaste",function(){v.each(m.getElementsByTagName(H.body,"table"),function(E){if(E.offsetWidth>H.body.offsetWidth){var K=
Ha(H,E);E.style.width=H.body.offsetWidth-parseInt(m.getComputedStyle(H.body,"margin-left"),10)*2-K.tableBorder*2-(H.options.offsetWidth||0)+"px"}})});H.addListener("blur",function(){w=null});var G;H.addListener("keydown",function(){clearTimeout(G);G=setTimeout(function(){var E=H.selection.getRange();if(E=m.findParentByTagName(E.startContainer,["th","td"],true)){var K=E.parentNode.parentNode.parentNode;if(K.offsetWidth>K.getAttribute("width"))E.style.wordBreak="break-all"}},100)});H.addListener("selectionchange",
function(){j(H,false,"",null)});H.addListener("contentchange",function(){var E=this;na(E);if(!ia(E)){var K=E.selection.getRange().startContainer;K=m.findParentByTagName(K,["td","th"],true);v.each(m.getElementsByTagName(E.document,"table"),function(J){if(E.fireEvent("excludetable",J)!==true){J.ueTable=new ca(J);J.onmouseover=function(){E.fireEvent("tablemouseover",J)};J.onmousemove=function(){E.fireEvent("tablemousemove",J);E.options.tableDragable&&g(true,this,E);v.defer(function(){E.fireEvent("contentchange",
50)},true)};J.onmouseout=function(){E.fireEvent("tablemouseout",J);j(E,false,"",null);na(E)};J.onclick=function(N){N=E.window.event||N;var P=f(N.target||N.srcElement);if(P){var T=da(P),U=T.table,W=T.getCellInfo(P),V=E.selection.getRange();if(e(U,P,N,true)){U=T.getCell(T.indexTable[T.rowsNum-1][W.colIndex].rowIndex,T.indexTable[T.rowsNum-1][W.colIndex].cellIndex);if(N.shiftKey&&T.selectedTds.length)if(T.selectedTds[0]!==U){N=T.getCellsRange(T.selectedTds[0],U);T.setSelected(N)}else V&&V.selectNodeContents(U).select();
else if(P!==U){N=T.getCellsRange(P,U);T.setSelected(N)}else V&&V.selectNodeContents(U).select()}else if(e(U,P,N)){U=T.getCell(T.indexTable[W.rowIndex][T.colsNum-1].rowIndex,T.indexTable[W.rowIndex][T.colsNum-1].cellIndex);if(N.shiftKey&&T.selectedTds.length)if(T.selectedTds[0]!==U){N=T.getCellsRange(T.selectedTds[0],U);T.setSelected(N)}else V&&V.selectNodeContents(U).select();else if(P!==U){N=T.getCellsRange(P,U);T.setSelected(N)}else V&&V.selectNodeContents(U).select()}}}}});Ga(E,true)}});m.on(H.document,
"mousemove",b);m.on(H.document,"mouseout",function(E){(E.target||E.srcElement).tagName=="TABLE"&&j(H,false,"",null)});H.addListener("interlacetable",function(E,K,J){if(K){E=K.rows;K=E.length;for(var N=function(T,U,W){return T[U]?T[U]:W?T[U%T.length]:""},P=0;P<K;P++)E[P].className=N(J||this.options.classList,P,true)}});H.addListener("uninterlacetable",function(E,K){if(K){E=K.rows;K=this.options.classList;for(var J=E.length,N=0;N<J;N++)m.removeClasses(E[N],K)}});H.addListener("mousedown",p);H.addListener("mouseup",
z);m.on(H.body,"dragstart",function(E){z.call(H,"dragstart",E)});H.addOutputRule(function(E){v.each(E.getNodesByTagName("div"),function(K){K.getAttr("id")=="ue_tableDragLine"&&K.parentNode.removeChild(K)})});var O=0;H.addListener("mousedown",function(){O=0});H.addListener("tabkeydown",function(){var E=this.selection.getRange(),K=E.getCommonAncestor(true,true),J=m.findParentByTagName(K,"table");if(J){if(m.findParentByTagName(K,"caption",true))(K=m.getElementsByTagName(J,"th td"))&&K.length&&E.setStart(K[0],
0).setCursor(false,true);else{K=m.findParentByTagName(K,["td","th"],true);var N=da(K);O=K.rowSpan>1?O:N.getCellInfo(K).rowIndex;if(K=N.getTabNextCell(K,O))c(K)?E.setStart(K,0).setCursor(false,true):E.selectNodeContents(K).select();else{H.fireEvent("saveScene");H.__hasEnterExecCommand=true;this.execCommand("insertrownext");H.__hasEnterExecCommand=false;E=this.selection.getRange();E.setStart(J.rows[J.rows.length-1].cells[0],0).setCursor();H.fireEvent("saveScene")}}return true}});y.ie&&H.addListener("selectionchange",
function(){j(this,false,"",null)});H.addListener("keydown",function(E,K){E=K.keyCode||K.which;if(!(E==8||E==46)){(K=!K.ctrlKey&&!K.metaKey&&!K.shiftKey&&!K.altKey)&&va(m.getElementsByTagName(this.body,"td"));(E=ia(this))&&K&&E.clearSelected()}});H.addListener("beforegetcontent",function(){Ga(this,false);y.ie&&v.each(this.document.getElementsByTagName("caption"),function(E){if(m.isEmptyNode(E))E.innerHTML="&nbsp;"})});H.addListener("aftergetcontent",function(){Ga(this,true)});H.addListener("getAllHtml",
function(){va(H.document.getElementsByTagName("td"))});H.addListener("fullscreenchanged",function(E,K){if(!K){var J=this.body.offsetWidth/document.body.offsetWidth;E=m.getElementsByTagName(this.body,"table");v.each(E,function(N){if(N.offsetWidth<H.body.offsetWidth)return false;var P=m.getElementsByTagName(N,"td"),T=[];v.each(P,function(V){T.push(V.offsetWidth)});for(var U=0,W;W=P[U];U++)W.setAttribute("width",Math.floor(T[U]*J));N.setAttribute("width",Math.floor(Sa(H,true,Ha(H))))})}});var $=H.execCommand;
H.execCommand=function(E){E=E.toLowerCase();var K=ia(this),J=new ea.Range(this.document),N=this.commands[E]||UE.commands[E],P;if(N){if(K&&!Ta[E]&&!N.notNeedUndo&&!this.__hasEnterExecCommand){this.__hasEnterExecCommand=true;this.fireEvent("beforeexeccommand",E);K=K.selectedTds;for(var T,U=0,W;W=K[U];U++){c(W)?J.setStart(W,0).setCursor(false,true):J.selectNode(W).select(true);T=this.queryCommandState(E);N=this.queryCommandValue(E);if(T!=-1){if(-2!==T||-2!==N){this._ignoreContentChange=true;P=$.apply(this,
arguments);this._ignoreContentChange=false}m.isEmptyBlock(W)&&m.fillNode(this.document,W)}}this.queryCommandState(E);this.queryCommandValue(E);J.setStart(K[0],0).shrinkBoundary(true).setCursor(false,true);this.fireEvent("contentchange");this.fireEvent("afterexeccommand",E);this.__hasEnterExecCommand=false;this._selectionChange()}else P=$.apply(this,arguments);return P}}});var Qa};UE.UETable.prototype.sortTable=function(h,f){var c=this.table,a=c.rows,b=[],g=a[0].cells[0].tagName==="TH",l=0;if(this.selectedTds.length){for(var e=
this.cellsRange,d=e.endRowIndex+1,k=e.beginRowIndex;k<d;k++)b[k]=a[k];b.splice(0,e.beginRowIndex);l=e.endRowIndex+1===this.rowsNum?0:e.endRowIndex+1}else{k=0;for(d=a.length;k<d;k++)b[k]=a[k]}var j={reversecurrent:function(){return 1},orderbyasc:function(n,p){return(n.innerText||n.textContent).localeCompare(p.innerText||p.textContent)},reversebyasc:function(n,p){return p.innerHTML.localeCompare(n.innerHTML)},orderbynum:function(n,p){n=n[y.ie?"innerText":"textContent"].match(/\d+/);p=p[y.ie?"innerText":
"textContent"].match(/\d+/);if(n)n=+n[0];if(p)p=+p[0];return(n||0)-(p||0)},reversebynum:function(n,p){n=n[y.ie?"innerText":"textContent"].match(/\d+/);p=p[y.ie?"innerText":"textContent"].match(/\d+/);if(n)n=+n[0];if(p)p=+p[0];return(p||0)-(n||0)}};c.setAttribute("data-sort-type",f&&typeof f==="string"&&j[f]?f:"");g&&b.splice(0,1);b=v.sort(b,function(n,p){return f&&typeof f==="function"?f.call(this,n.cells[h],p.cells[h]):f&&typeof f==="number"?1:f&&typeof f==="string"&&j[f]?j[f].call(this,n.cells[h],
p.cells[h]):j.orderbyasc.call(this,n.cells[h],p.cells[h])});g=c.ownerDocument.createDocumentFragment();k=0;for(d=b.length;k<d;k++)g.appendChild(b[k]);c=c.getElementsByTagName("tbody")[0];l?c.insertBefore(g,a[l-e.endRowIndex+e.beginRowIndex-1]):c.appendChild(g)};UE.plugins.tablesort=function(){var h=this,f=UE.UETable,c=function(b){return f.getUETable(b)},a=function(b){return f.getTableItemsByRange(b)};h.ready(function(){v.cssRule("tablesort","table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;   background-image:url("+
h.options.themePath+h.options.theme+"/images/sortable.png);}",h.document);h.addListener("afterexeccommand",function(b,g){if(g=="mergeright"||g=="mergedown"||g=="mergecells")this.execCommand("disablesort")})});UE.commands.sorttable={queryCommandState:function(){var b=a(this);if(!b.cell)return-1;b=b.table.getElementsByTagName("td");for(var g=0,l;l=b[g++];)if(l.rowSpan!=1||l.colSpan!=1)return-1;return 0},execCommand:function(b,g){b=this.selection.getRange();var l=b.createBookmark(true),e=a(this),d=e.cell;
e=c(e.table);d=e.getCellInfo(d);e.sortTable(d.cellIndex,g);b.moveToBookmark(l);try{b.select()}catch(k){}}};UE.commands.enablesort=UE.commands.disablesort={queryCommandState:function(b){var g=a(this).table;if(g&&b=="enablesort")for(var l=m.getElementsByTagName(g,"th td"),e=0;e<l.length;e++)if(l[e].getAttribute("colspan")>1||l[e].getAttribute("rowspan")>1)return-1;return!g?-1:b=="enablesort"^g.getAttribute("data-sort")!="sortEnabled"?-1:0},execCommand:function(b){var g=a(this).table;g.setAttribute("data-sort",
b=="enablesort"?"sortEnabled":"sortDisabled");b=="enablesort"?m.addClass(g,"sortEnabled"):m.removeClasses(g,"sortEnabled")}}};UE.plugins.contextmenu=function(){var h=this;h.setOpt("enableContextMenu",true);if(h.getOpt("enableContextMenu")!==false){var f=h.getLang("contextMenu"),c,a=h.options.contextMenu||[{label:f.selectall,cmdName:"selectall"},{label:f.cleardoc,cmdName:"cleardoc",exec:function(){confirm(f.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:f.unlink,cmdName:"unlink"},"-",{group:f.paragraph,
icon:"justifyjustify",subMenu:[{label:f.justifyleft,cmdName:"justify",value:"left"},{label:f.justifyright,cmdName:"justify",value:"right"},{label:f.justifycenter,cmdName:"justify",value:"center"},{label:f.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:f.table,icon:"table",subMenu:[{label:f.inserttable,cmdName:"inserttable"},{label:f.deletetable,cmdName:"deletetable"},"-",{label:f.deleterow,cmdName:"deleterow"},{label:f.deletecol,cmdName:"deletecol"},{label:f.insertcol,cmdName:"insertcol"},
{label:f.insertcolnext,cmdName:"insertcolnext"},{label:f.insertrow,cmdName:"insertrow"},{label:f.insertrownext,cmdName:"insertrownext"},"-",{label:f.insertcaption,cmdName:"insertcaption"},{label:f.deletecaption,cmdName:"deletecaption"},{label:f.inserttitle,cmdName:"inserttitle"},{label:f.deletetitle,cmdName:"deletetitle"},{label:f.inserttitlecol,cmdName:"inserttitlecol"},{label:f.deletetitlecol,cmdName:"deletetitlecol"},"-",{label:f.mergecells,cmdName:"mergecells"},{label:f.mergeright,cmdName:"mergeright"},
{label:f.mergedown,cmdName:"mergedown"},"-",{label:f.splittorows,cmdName:"splittorows"},{label:f.splittocols,cmdName:"splittocols"},{label:f.splittocells,cmdName:"splittocells"},"-",{label:f.averageDiseRow,cmdName:"averagedistributerow"},{label:f.averageDisCol,cmdName:"averagedistributecol"},"-",{label:f.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this);this.getDialog("edittd").open()}},{label:f.edittable,cmdName:"edittable",exec:function(){UE.ui.edittable&&new UE.ui.edittable(this);
this.getDialog("edittable").open()}},{label:f.setbordervisible,cmdName:"setbordervisible"}]},{group:f.tablesort,icon:"tablesort",subMenu:[{label:f.enablesort,cmdName:"enablesort"},{label:f.disablesort,cmdName:"disablesort"},"-",{label:f.reversecurrent,cmdName:"sorttable",value:"reversecurrent"},{label:f.orderbyasc,cmdName:"sorttable",value:"orderbyasc"},{label:f.reversebyasc,cmdName:"sorttable",value:"reversebyasc"},{label:f.orderbynum,cmdName:"sorttable",value:"orderbynum"},{label:f.reversebynum,
cmdName:"sorttable",value:"reversebynum"}]},{group:f.borderbk,icon:"borderBack",subMenu:[{label:f.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:f.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:f.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:true,colorList:["#bbb","#ccc"]})}},{label:f.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},
{label:f.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:true,colorList:["red","blue"]})}},{label:f.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:true,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:f.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",
vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:f.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:f.tableleft,
value:"left"},{cmdName:"tablealignment",className:"center",label:f.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:f.tableright,value:"right"}]},"-",{label:f.copy,cmdName:"copy"},{label:f.paste,cmdName:"paste"}];if(a.length){var b=UE.ui.uiUtils;h.addListener("contextmenu",function(g,l){g=b.getViewportOffsetByEvent(l);h.fireEvent("beforeselectionchange");c&&c.destroy();for(var e=0,d,k=[];d=a[e];e++){var j;(function(q){if(q=="-"){if((j=k[k.length-1])&&j!=="-")k.push("-")}else if(q.hasOwnProperty("group")){for(var o=
0,r,s=[];r=q.subMenu[o];o++)(function(t){if(t=="-")(j=s[s.length-1])&&j!=="-"?s.push("-"):s.splice(s.length-1);else if((h.commands[t.cmdName]||UE.commands[t.cmdName]||t.query)&&(t.query?t.query():h.queryCommandState(t.cmdName))>-1)s.push({label:t.label||h.getLang("contextMenu."+t.cmdName+(t.value||""))||"",className:"edui-for-"+t.cmdName+(t.className?" edui-for-"+t.cmdName+"-"+t.className:""),onclick:t.exec?function(){t.exec.call(h)}:function(){h.execCommand(t.cmdName,t.value)}})})(r);s.length&&k.push({label:function(){switch(q.icon){case "table":return h.getLang("contextMenu.table");
case "justifyjustify":return h.getLang("contextMenu.paragraph");case "aligntd":return h.getLang("contextMenu.aligntd");case "aligntable":return h.getLang("contextMenu.aligntable");case "tablesort":return f.tablesort;case "borderBack":return f.borderbk;default:return""}}(),className:"edui-for-"+q.icon,subMenu:{items:s,editor:h}})}else if((h.commands[q.cmdName]||UE.commands[q.cmdName]||q.query)&&(q.query?q.query.call(h):h.queryCommandState(q.cmdName))>-1)k.push({label:q.label||h.getLang("contextMenu."+
q.cmdName),className:"edui-for-"+(q.icon?q.icon:q.cmdName+(q.value||"")),onclick:q.exec?function(){q.exec.call(h)}:function(){h.execCommand(q.cmdName,q.value)}})})(d)}k[k.length-1]=="-"&&k.pop();c=new UE.ui.Menu({items:k,className:"edui-contextmenu",editor:h});c.render();c.showAt(g);h.fireEvent("aftershowcontextmenu",c);m.preventDefault(l);if(y.ie){var n;try{n=h.selection.getNative().createRange()}catch(p){return}n.item&&(new ea.Range(h.document)).selectNode(n.item(0)).select(true,true)}});h.addListener("aftershowcontextmenu",
function(g,l){if(h.zeroclipboard){g=l.items;for(var e in g)g[e].className=="edui-for-copy"&&h.zeroclipboard.clip(g[e].getDom())}})}}};UE.plugins.shortcutmenu=function(){var h,f=this.options.shortcutMenu||[];if(f.length){this.addListener("contextmenu mouseup",function(c,a){var b=this,g={type:c,target:a.target||a.srcElement,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY};setTimeout(function(){if(b.selection.getRange().collapsed===false||c=="contextmenu"){if(!h){h=new B.editor.ui.ShortCutMenu({editor:b,
items:f,theme:b.options.theme,className:"edui-shortcutmenu"});h.render();b.fireEvent("afterrendershortcutmenu",h)}h.show(g,!!UE.plugins.contextmenu)}});if(c=="contextmenu"){m.preventDefault(a);if(y.ie9below){var l;try{l=b.selection.getNative().createRange()}catch(e){return}l.item&&(new ea.Range(b.document)).selectNode(l.item(0)).select(true,true)}}});this.addListener("keydown",function(c){c=="keydown"&&h&&!h.isHidden&&h.hide()})}};UE.plugins.basestyle=function(){var h={bold:["strong","b"],italic:["em",
"i"],subscript:["sub"],superscript:["sup"]},f=function(b,g){return m.filterNodeList(b.selection.getStartElementPath(),g)},c=this;c.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"});c.addInputRule(function(b){v.each(b.getNodesByTagName("b i"),function(g){switch(g.tagName){case "b":g.tagName="strong";break;case "i":g.tagName="em"}})});for(var a in h)(function(b,g){c.commands[b]={execCommand:function(l){var e=c.selection.getRange(),d=f(this,g);if(e.collapsed){if(d){l=c.document.createTextNode("");
e.insertNode(l).removeInlineStyle(g);e.setStartBefore(l);m.remove(l)}else{d=e.document.createElement(g[0]);if(l=="superscript"||l=="subscript"){l=c.document.createTextNode("");e.insertNode(l).removeInlineStyle(["sub","sup"]).setStartBefore(l).collapse(true)}e.insertNode(d).setStart(d,0)}e.collapse(true)}else{if(l=="superscript"||l=="subscript")if(!d||d.tagName.toLowerCase()!=l)e.removeInlineStyle(["sub","sup"]);d?e.removeInlineStyle(g):e.applyInlineStyle(g[0])}e.select()},queryCommandState:function(){return f(this,
g)?1:0}}})(a,h[a])};UE.plugins.elementpath=function(){var h,f,c=this;c.setOpt("elementPathEnabled",true);if(c.options.elementPathEnabled)c.commands.elementpath={execCommand:function(a,b){a=f[b];var g=c.selection.getRange();h=b*1;g.selectNode(a).select()},queryCommandValue:function(){var a=[].concat(this.selection.getStartElementPath()).reverse(),b=[];f=a;for(var g=0,l;l=a[g];g++)if(l.nodeType!=3){var e=l.tagName.toLowerCase();if(e=="img"&&l.getAttribute("anchorname"))e="anchor";b[g]=e;if(h==g){h=
-1;break}}return b}}};UE.plugins.formatmatch=function(){function h(g,l){function e(j){k&&j.selectNode(k);return j.applyInlineStyle(c[c.length-1].tagName,null,c)}if(y.webkit)var d=l.target.tagName=="IMG"?l.target:null;f.undoManger&&f.undoManger.save();g=f.selection.getRange();d=d||g.getClosedNode();if(a&&d&&d.tagName=="IMG"){d.style.cssText+=";float:"+(a.style.cssFloat||a.style.styleFloat||"none")+";display:"+(a.style.display||"inline");a=null}else if(!a){if(g.collapsed){var k=f.document.createTextNode("match");
g.insertNode(k).select()}f.__hasEnterExecCommand=true;d=f.options.removeFormatAttributes;f.options.removeFormatAttributes="";f.execCommand("removeformat");f.options.removeFormatAttributes=d;f.__hasEnterExecCommand=false;g=f.selection.getRange();c.length&&e(g);k&&g.setStartBefore(k).collapse(true);g.select();k&&m.remove(k)}f.undoManger&&f.undoManger.save();f.removeListener("mouseup",h);b=0}var f=this,c=[],a,b=0;f.addListener("reset",function(){c=[];b=0});f.commands.formatmatch={execCommand:function(){if(b){b=
0;c=[];f.removeListener("mouseup",h)}else{var g=f.selection.getRange();a=g.getClosedNode();if(!a||a.tagName!="IMG"){g.collapse(true).shrinkBoundary();c=m.findParents(g.startContainer,true,function(e){return!m.isBlockElm(e)&&e.nodeType==1});g=0;for(var l;l=c[g];g++)if(l.tagName=="A"){c.splice(g,1);break}}f.addListener("mouseup",h);b=1}},queryCommandState:function(){return b},notNeedUndo:1}};UE.plugin.register("searchreplace",function(){function h(e,d,k){var j=d.searchStr;if(d.dir==-1){e=e.split("").reverse().join("");
j=j.split("").reverse().join("");k=e.length-k}j=new RegExp(j,"g"+(d.casesensitive?"":"i"));for(var n;n=j.exec(e);)if(n.index>=k)return d.dir==-1?e.length-n.index-d.searchStr.length:n.index;return-1}function f(e,d,k){var j,n=k.all||k.dir==1?"getNextDomNode":"getPreDomNode";if(m.isBody(e))e=e.firstChild;for(;e;){j=e.nodeType==3?e.nodeValue:e[y.ie?"innerText":"textContent"];j=h(j,k,d);if(j!=-1)return{node:e,index:j};for(e=m[n](e);e&&l[e.nodeName.toLowerCase()];)e=m[n](e,true);if(e)d=k.dir==-1?(e.nodeType==
3?e.nodeValue:e[y.ie?"innerText":"textContent"]).length:0}}function c(e,d,k){var j=0;e=e.firstChild;for(var n=0;e;){if(e.nodeType==3){n=e.nodeValue.replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length;j+=n;if(j>=d)return{node:e,index:n-(j-d)}}else if(!I.$empty[e.tagName]){n=e[y.ie?"innerText":"textContent"].replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length;j+=n;if(j>=d)if(n=c(e,n-(j-d),k))return n}e=m.getNextDomNode(e)}}function a(e,d){var k=e.selection.getRange(),j=d.searchStr,n=e.document.createElement("span");
n.innerHTML="$$ueditor_searchreplace_key$$";k.shrinkBoundary(true);if(!k.collapsed){k.select();e=e.selection.getText();if((new RegExp("^"+d.searchStr+"$",d.casesensitive?"":"i")).test(e))if(d.replaceStr!=undefined){b(k,d.replaceStr);k.select();return true}else k.collapse(d.dir==-1)}k.insertNode(n);k.enlargeToBlockElm(true);e=k.startContainer;var p=e[y.ie?"innerText":"textContent"].indexOf("$$ueditor_searchreplace_key$$");k.setStartBefore(n);m.remove(n);if(e=f(e,p,d)){n=c(e.node,e.index,j);j=c(e.node,
e.index+j.length,j);k.setStart(n.node,n.index).setEnd(j.node,j.index);d.replaceStr!==undefined&&b(k,d.replaceStr);k.select();return true}else k.setCursor()}function b(e,d){d=g.document.createTextNode(d);e.deleteContents().insertNode(d)}var g=this,l={table:1,tbody:1,tr:1,ol:1,ul:1};return{commands:{searchreplace:{execCommand:function(e,d){v.extend(d,{all:false,casesensitive:false,dir:1},true);e=0;if(d.all){var k=g.selection.getRange(),j=g.body.firstChild;if(j&&j.nodeType==1){k.setStart(j,0);k.shrinkBoundary(true)}else j.nodeType==
3&&k.setStartBefore(j);k.collapse(true).select(true);for(d.replaceStr!==undefined&&g.fireEvent("saveScene");a(this,d);)e++}else{d.replaceStr!==undefined&&g.fireEvent("saveScene");a(this,d)&&e++}e&&g.fireEvent("saveScene");return e},notNeedUndo:1}}}});UE.plugins.customstyle=function(){var h=this;h.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},
{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]});h.commands.customstyle={execCommand:function(f,c){f=c.tag;var a=m.findParent(this.selection.getStart(),function(n){return n.getAttribute("label")},true),b,g,l={};for(b in c)if(c[b]!==undefined)l[b]=c[b];delete l.tag;if(a&&a.getAttribute("label")==c.label){b=this.selection.getRange();
g=b.createBookmark();if(b.collapsed)if(I.$block[a.tagName]){var e=this.document.createElement("p");m.moveChild(a,e);a.parentNode.insertBefore(e,a);m.remove(a)}else m.remove(a,true);else{a=m.getCommonAncestor(g.start,g.end);l=m.getElementsByTagName(a,f);(new RegExp(f,"i")).test(a.tagName)&&l.push(a);for(var d=0,k;k=l[d++];)if(k.getAttribute("label")==c.label){e=m.getPosition(k,g.start);var j=m.getPosition(k,g.end);if((e&m.POSITION_FOLLOWING||e&m.POSITION_CONTAINS)&&(j&m.POSITION_PRECEDING||j&m.POSITION_CONTAINS))if(I.$block[f]){e=
this.document.createElement("p");m.moveChild(k,e);k.parentNode.insertBefore(e,k)}m.remove(k,true)}(a=m.findParent(a,function(n){return n.getAttribute("label")==c.label},true))&&m.remove(a,true)}b.moveToBookmark(g).select()}else if(I.$block[f]){this.execCommand("paragraph",f,l,"customstyle");b=this.selection.getRange();if(!b.collapsed){b.collapse();a=m.findParent(this.selection.getStart(),function(n){return n.getAttribute("label")==c.label},true);f=this.document.createElement("p");m.insertAfter(a,
f);m.fillNode(this.document,f);b.setStart(f,0).setCursor()}}else{b=this.selection.getRange();if(b.collapsed){a=this.document.createElement(f);m.setAttributes(a,l);b.insertNode(a).setStart(a,0).setCursor()}else{g=b.createBookmark();b.applyInlineStyle(f,l).moveToBookmark(g).select()}}},queryCommandValue:function(){var f=m.filterNodeList(this.selection.getStartElementPath(),function(c){return c.getAttribute("label")});return f?f.getAttribute("label"):""}};h.addListener("keyup",function(f,c){f=c.keyCode||
c.which;if(f==32||f==13){f=h.selection.getRange();if(f.collapsed)if((c=m.findParent(h.selection.getStart(),function(b){return b.getAttribute("label")},true))&&I.$block[c.tagName]&&m.isEmptyNode(c)){var a=h.document.createElement("p");m.insertAfter(c,a);m.fillNode(h.document,a);m.remove(c);f.setStart(a,0).setCursor()}}})};UE.plugins.catchremoteimage=function(){var h=this,f=UE.ajax;if(h.options.catchRemoteImageEnable!==false){h.setOpt({catchRemoteImageEnable:false});h.addListener("afterpaste",function(){h.fireEvent("catchRemoteImage")});
h.addListener("catchRemoteImage",function(){function c(p,q){var o=v.serializeParam(h.queryCommandValue("serverparam"))||"";o=v.formatUrl(b+(b.indexOf("?")==-1?"?":"&")+o);q={method:"POST",dataType:v.isCrossDomainUrl(o)?"jsonp":"",timeout:6E4,onsuccess:q.success,onerror:q.error};q[l]=p;f.request(o,q)}for(var a=h.getOpt("catcherLocalDomain"),b=h.getActionUrl(h.getOpt("catcherActionName")),g=h.getOpt("catcherUrlPrefix"),l=h.getOpt("catcherFieldName"),e=[],d=m.getElementsByTagName(h.document,"img"),k=
function(p,q){if(p.indexOf(location.host)!=-1||/(^\.)|(^\/)/.test(p))return true;if(q)for(var o=0,r;r=q[o++];)if(p.indexOf(r)!==-1)return true;return false},j=0,n;n=d[j++];)if(!n.getAttribute("word_img")){n=n.getAttribute("_src")||n.src||"";/^(https?|ftp):/i.test(n)&&!k(n,a)&&e.push(n)}e.length&&c(e,{success:function(p){try{var q=p.state!==undefined?p:eval("("+p.responseText+")")}catch(o){return}var r,s,t,u=q.list;for(p=0;q=d[p++];){t=q.getAttribute("_src")||q.src||"";for(r=0;s=u[r++];)if(t==s.source&&
s.state=="SUCCESS"){r=g+s.url;m.setAttributes(q,{src:r,_src:r});break}}h.fireEvent("catchremotesuccess")},error:function(){h.fireEvent("catchremoteerror")}})})}};UE.plugin.register("snapscreen",function(){function h(a){var b=document.createElement("a"),g=v.serializeParam(f.queryCommandValue("serverparam"))||"";b.href=a;if(y.ie)b.href=b.href;a=b.search;if(g){a=a+(a.indexOf("?")==-1?"?":"&")+g;a=a.replace(/[&]+/ig,"&")}return{port:b.port,hostname:b.hostname,path:b.pathname+a||+b.hash}}var f=this,c;
return{commands:{snapscreen:{execCommand:function(){function a(k){try{k=eval("("+k+")");if(k.state=="SUCCESS"){var j=f.options;f.execCommand("insertimage",{src:j.snapscreenUrlPrefix+k.url,_src:j.snapscreenUrlPrefix+k.url,alt:k.title||"",floatStyle:j.snapscreenImgAlign})}else alert(k.state)}catch(n){alert(e.callBackErrorMsg)}}var b,g,l,e=f.getLang("snapScreen_plugin");if(!c){b=f.container;c=(f.container.ownerDocument||f.container.document).createElement("object");try{c.type="application/x-pluginbaidusnap"}catch(d){return}c.style.cssText=
"position:absolute;left:-9999px;width:0;height:0;";c.setAttribute("width","0");c.setAttribute("height","0");b.appendChild(c)}b=f.getActionUrl(f.getOpt("snapscreenActionName"));g=h(b);setTimeout(function(){try{l=c.saveSnapshot(g.hostname,g.path,g.port)}catch(k){f.ui._dialogs.snapscreenDialog.open();return}a(l)},50)},queryCommandState:function(){return navigator.userAgent.indexOf("Windows",0)!=-1?0:-1}}}}});UE.commands.insertparagraph={execCommand:function(h,f){h=this.selection.getRange();for(var c=
h.startContainer,a;c;){if(m.isBody(c))break;a=c;c=c.parentNode}if(a){c=this.document.createElement("p");f?a.parentNode.insertBefore(c,a):a.parentNode.insertBefore(c,a.nextSibling);m.fillNode(this.document,c);h.setStart(c,0).setCursor(false,true)}}};UE.plugin.register("webapp",function(){function h(c,a){return!a?'<img title="'+c.title+'" width="'+c.width+'" height="'+c.height+'" src="'+f.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" _logo_url="'+c.logo+'" style="background:url('+c.logo+
') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+c.url+'" '+(c.align&&!c.cssfloat?'align="'+c.align+'"':"")+(c.cssfloat?'style="float:'+c.cssfloat+'"':"")+"/>":'<iframe class="edui-faked-webapp" title="'+c.title+'" '+(c.align&&!c.cssfloat?'align="'+c.align+'"':"")+(c.cssfloat?'style="float:'+c.cssfloat+'"':"")+'width="'+c.width+'" height="'+c.height+'"  scrolling="no" frameborder="0" src="'+c.url+'" logo_url = "'+c.logo+'"></iframe>'}var f=this;return{outputRule:function(c){v.each(c.getNodesByTagName("img"),
function(a){var b;if(a.getAttr("class")=="edui-faked-webapp"){b=h({title:a.getAttr("title"),width:a.getAttr("width"),height:a.getAttr("height"),align:a.getAttr("align"),cssfloat:a.getStyle("float"),url:a.getAttr("_url"),logo:a.getAttr("_logo_url")},true);b=UE.uNode.createElement(b);a.parentNode.replaceChild(b,a)}})},inputRule:function(c){v.each(c.getNodesByTagName("iframe"),function(a){if(a.getAttr("class")=="edui-faked-webapp"){var b=UE.uNode.createElement(h({title:a.getAttr("title"),width:a.getAttr("width"),
height:a.getAttr("height"),align:a.getAttr("align"),cssfloat:a.getStyle("float"),url:a.getAttr("src"),logo:a.getAttr("logo_url")}));a.parentNode.replaceChild(b,a)}})},commands:{webapp:{execCommand:function(c,a){this.execCommand("inserthtml",h(v.extend(a,{align:"none"}),false))},queryCommandState:function(){var c=this.selection.getRange().getClosedNode();return c&&c.className=="edui-faked-webapp"?1:0}}}}});UE.plugins.template=function(){UE.commands.template={execCommand:function(h,f){f.html&&this.execCommand("inserthtml",
f.html)}};this.addListener("click",function(h,f){f=f.target||f.srcElement;h=this.selection.getRange();(f=m.findParent(f,function(c){if(c.className&&m.hasClass(c,"ue_t"))return c},true))&&h.selectNode(f).shrinkBoundary().select()});this.addListener("keydown",function(h,f){h=this.selection.getRange();if(!h.collapsed)if(!f.ctrlKey&&!f.metaKey&&!f.shiftKey&&!f.altKey)(f=m.findParent(h.startContainer,function(c){if(c.className&&m.hasClass(c,"ue_t"))return c},true))&&m.removeClasses(f,["ue_t"])})};UE.plugin.register("music",
function(){function h(c,a,b,g,l,e){return!e?"<img "+(g&&!l?'align="'+g+'"':"")+(l?'style="float:'+l+'"':"")+' width="'+a+'" height="'+b+'" _url="'+c+'" class="edui-faked-music" src="'+f.options.langPath+f.options.lang+'/images/music.png" />':'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+c+'" width="'+a+'" height="'+b+'" '+(g&&!l?'align="'+g+'"':"")+(l?'style="float:'+l+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >'}
var f=this;return{outputRule:function(c){v.each(c.getNodesByTagName("img"),function(a){var b;if(a.getAttr("class")=="edui-faked-music"){b=a.getStyle("float");var g=a.getAttr("align");b=h(a.getAttr("_url"),a.getAttr("width"),a.getAttr("height"),g,b,true);b=UE.uNode.createElement(b);a.parentNode.replaceChild(b,a)}})},inputRule:function(c){v.each(c.getNodesByTagName("embed"),function(a){if(a.getAttr("class")=="edui-faked-music"){var b=a.getStyle("float"),g=a.getAttr("align");html=h(a.getAttr("src"),
a.getAttr("width"),a.getAttr("height"),g,b,false);b=UE.uNode.createElement(html);a.parentNode.replaceChild(b,a)}})},commands:{music:{execCommand:function(c,a){this.execCommand("inserthtml",h(a.url,a.width||400,a.height||95,"none",false))},queryCommandState:function(){var c=this.selection.getRange().getClosedNode();return c&&c.className=="edui-faked-music"?1:0}}}}});UE.plugin.register("autoupload",function(){function h(a,b){var g,l,e,d,k,j,n,p,q=/image\/\w+/i.test(a.type)?"image":"file",o="loading_"+
(+new Date).toString(36);g=b.getOpt(q+"FieldName");l=b.getOpt(q+"UrlPrefix");e=b.getOpt(q+"MaxSize");d=b.getOpt(q+"AllowFiles");k=b.getActionUrl(b.getOpt(q+"ActionName"));n=function(r){var s=b.document.getElementById(o);s&&m.remove(s);b.fireEvent("showmessage",{id:o,content:r,type:"error",timeout:4E3})};if(q=="image"){j='<img class="loadingclass" id="'+o+'" src="'+b.options.themePath+b.options.theme+'/images/spacer.gif" title="'+(b.getLang("autoupload.loading")||"")+'" >';p=function(r){var s=l+r.url,
t=b.document.getElementById(o);if(t){t.setAttribute("src",s);t.setAttribute("_src",s);t.setAttribute("title",r.title||"");t.setAttribute("alt",r.original||"");t.removeAttribute("id");m.removeClasses(t,"loadingclass")}}}else{j='<p><img class="loadingclass" id="'+o+'" src="'+b.options.themePath+b.options.theme+'/images/spacer.gif" title="'+(b.getLang("autoupload.loading")||"")+'" ></p>';p=function(r){r=l+r.url;var s=b.document.getElementById(o),t=b.selection.getRange(),u=t.createBookmark();t.selectNode(s).select();
b.execCommand("insertfile",{url:r});t.moveToBookmark(u).select()}}b.execCommand("inserthtml",j);if(b.getOpt(q+"ActionName"))if(a.size>e)n(b.getLang("autoupload.exceedSizeError"));else if((e=a.name?a.name.substr(a.name.lastIndexOf(".")):"")&&q!="image"||d&&(d.join("")+".").indexOf(e.toLowerCase()+".")==-1)n(b.getLang("autoupload.exceedTypeError"));else{d=new XMLHttpRequest;q=new FormData;e=v.serializeParam(b.queryCommandValue("serverparam"))||"";k=v.formatUrl(k+(k.indexOf("?")==-1?"?":"&")+e);q.append(g,
a,a.name||"blob."+a.type.substr(6));q.append("type","ajax");d.open("post",k,true);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.addEventListener("load",function(r){try{var s=(new Function("return "+v.trim(r.target.response)))();s.state=="SUCCESS"&&s.url?p(s):n(s.state)}catch(t){n(b.getLang("autoupload.loadError"))}});d.send(q)}else n(b.getLang("autoupload.errorLoadConfig"))}function f(a){return a.clipboardData&&a.clipboardData.items&&a.clipboardData.items.length==1&&/^image\//.test(a.clipboardData.items[0].type)?
a.clipboardData.items:null}function c(a){return a.dataTransfer&&a.dataTransfer.files?a.dataTransfer.files:null}return{outputRule:function(a){v.each(a.getNodesByTagName("img"),function(b){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(b.getAttr("class"))&&b.parentNode.removeChild(b)});v.each(a.getNodesByTagName("p"),function(b){/\bloadpara\b/.test(b.getAttr("class"))&&b.parentNode.removeChild(b)})},bindEvents:{ready:function(){var a=this;if(window.FormData&&window.FileReader){m.on(a.body,"paste drop",
function(b){var g=false,l;if(l=b.type=="paste"?f(b):c(b)){for(var e=l.length,d;e--;){d=l[e];if(d.getAsFile)d=d.getAsFile();if(d&&d.size>0){h(d,a);g=true}}g&&b.preventDefault()}});m.on(a.body,"dragover",function(b){b.dataTransfer.types[0]=="Files"&&b.preventDefault()});v.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+
this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)}}}}});UE.plugin.register("autosave",function(){function h(g){var l;if(!(new Date-c<a))if(g.hasContents()){c=new Date;g._saveFlag=null;l=f.body.innerHTML;if(g.fireEvent("beforeautosave",{content:l})!==false){f.setPreferences(b,l);g.fireEvent("afterautosave",{content:l})}}else b&&f.removePreferences(b)}var f=this,
c=new Date,a=20,b=null;return{defaultOptions:{saveInterval:500},bindEvents:{ready:function(){var g=null;g=f.key?f.key+"-drafts-data":(f.container.parentNode.id||"ue-common")+"-drafts-data";b=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+g},contentchange:function(){if(b){f._saveFlag&&window.clearTimeout(f._saveFlag);if(f.options.saveInterval>0)f._saveFlag=window.setTimeout(function(){h(f)},f.options.saveInterval);else h(f)}}},commands:{clearlocaldata:{execCommand:function(){b&&
f.getPreferences(b)&&f.removePreferences(b)},notNeedUndo:true,ignoreContentChange:true},getlocaldata:{execCommand:function(){return b?f.getPreferences(b)||"":""},notNeedUndo:true,ignoreContentChange:true},drafts:{execCommand:function(){if(b){f.body.innerHTML=f.getPreferences(b)||"<p>"+m.fillHtml+"</p>";f.focus(true)}},queryCommandState:function(){return b?f.getPreferences(b)===null?-1:0:-1},notNeedUndo:true,ignoreContentChange:true}}}});UE.plugin.register("charts",function(){function h(c){var a=null,
b=0;if(c.rows.length<2)return false;if(c.rows[0].cells.length<2)return false;a=c.rows[0].cells;b=a.length;for(var g=0,l;l=a[g];g++)if(l.tagName.toLowerCase()!=="th")return false;for(g=1;a=c.rows[g];g++){if(a.cells.length!=b)return false;if(a.cells[0].tagName.toLowerCase()!=="th")return false;for(var e=1;l=a.cells[e];e++){l=v.trim(l.innerText||l.textContent||"");l=l.replace(new RegExp(UE.dom.domUtils.fillChar,"g"),"").replace(/^\s+|\s+$/g,"");if(!/^\d*\.?\d+$/.test(l))return false}}return true}var f=
this;return{bindEvents:{chartserror:function(){}},commands:{charts:{execCommand:function(c,a){c=m.findParentByTagName(this.selection.getRange().startContainer,"table",true);var b=[],g={};if(!c)return false;if(!h(c)){f.fireEvent("chartserror");return false}g.title=a.title||"";g.subTitle=a.subTitle||"";g.xTitle=a.xTitle||"";g.yTitle=a.yTitle||"";g.suffix=a.suffix||"";g.tip=a.tip||"";g.dataFormat=a.tableDataFormat||"";g.chartType=a.chartType||0;for(var l in g)g.hasOwnProperty(l)&&b.push(l+":"+g[l]);
c.setAttribute("data-chart",b.join(";"));m.addClass(c,"edui-charts-table")},queryCommandState:function(){var c=m.findParentByTagName(this.selection.getRange().startContainer,"table",true);return c&&h(c)?0:-1}}},inputRule:function(c){v.each(c.getNodesByTagName("table"),function(a){a.getAttr("data-chart")!==undefined&&a.setAttr("style")})},outputRule:function(c){v.each(c.getNodesByTagName("table"),function(a){a.getAttr("data-chart")!==undefined&&a.setAttr("style","display: none;")})}}});UE.plugin.register("section",
function(){function h(){this.tag="";this.level=-1;this.parentSection=this.previousSection=this.nextSection=this.dom=null;this.startAddress=[];this.endAddress=[];this.children=[]}function f(b){var g=new h;return v.extend(g,b)}function c(b,g){g=g;for(var l=0;l<b.length;l++){if(!g.childNodes)return null;g=g.childNodes[b[l]]}return g}var a=this;return{bindMultiEvents:{type:"afterscencerestore",handler:function(){a.fireEvent("updateSections")}},bindEvents:{ready:function(){m.on(a.body,"drop paste",function(){a.fireEvent("updateSections")})},
afterexeccommand:function(b,g){g=="paragraph"&&a.fireEvent("updateSections")},keyup:function(b,g){b=this.selection.getRange();if(b.collapsed!=true)this.fireEvent("updateSections");else{g=g.keyCode||g.which;if(g==13||g==8||g==46){b=b.getCommonAncestor(true).parentNode;for(var l=false;b&&b.nodeType==1;)if(/H\d{1}/.test(b.nodeName)){l=true;break}else b=b.parentNode;if(l&&g==13)if(b.id==b.previousSibling.id)b.id=ZU.getRandom();this.fireEvent("updateSections")}else 37<=g&&g<=40||this.fireEvent("updateSections")}}},
commands:{getsections:{execCommand:function(b,g){function l(n){for(var p=0;p<d.length;p++)if(d[p](n))return p;return-1}function e(n,p){for(var q=null,o,r=n.childNodes,s=0,t=r.length;s<t;s++){o=r[s];n=l(o);if(n>=0){q=k.selection.getRange().selectNode(o).createAddress(true).startAddress;o=f({tag:o.tagName,title:o.innerText||o.textContent||"",level:n,dom:o,startAddress:v.clone(q,[]),endAddress:v.clone(q,[]),children:[]});j.nextSection=o;for(q=o.previousSection=j;n<=q.level;)q=q.parentSection;o.parentSection=
q;q.children.push(o);q=j=o}else{o.nodeType===1&&e(o,p);q&&q.endAddress[q.endAddress.length-1]++}}}var d=g||["h1","h2","h3","h4","h5","h6"];for(b=0;b<d.length;b++)if(typeof d[b]=="string")d[b]=function(n){return function(p){return p.tagName==n.toUpperCase()}}(d[b]);else if(typeof d[b]!="function")d[b]=function(){return null};var k=this;var j=b=f({level:-1,title:"root"});e(k.body,b);return b},notNeedUndo:true},movesection:{execCommand:function(b,g,l,e){function d(j,n,p){for(var q=false,o=false,r=0;r<
j.length;r++){if(r>=p.length)break;if(p[r]>j[r]){q=true;break}else if(p[r]<j[r])break}for(r=0;r<n.length;r++){if(r>=p.length)break;if(p[r]<j[r]){o=true;break}else if(p[r]>j[r])break}return q&&o}if(!(!g||!l||l.level==-1)){l=e?l.endAddress:l.startAddress;b=c(l,this.body);if(!(!l||!b||d(g.startAddress,g.endAddress,l))){l=c(g.startAddress,this.body);g=c(g.endAddress,this.body);var k;if(e)for(e=g;e&&!(m.getPosition(l,e)&m.POSITION_FOLLOWING);){k=e.previousSibling;m.insertAfter(b,e);if(e==l)break;e=k}else for(e=
l;e&&!(m.getPosition(e,g)&m.POSITION_FOLLOWING);){k=e.nextSibling;b.parentNode.insertBefore(e,b);if(e==g)break;e=k}this.fireEvent("updateSections")}}}},deletesection:{execCommand:function(b,g,l){function e(k){for(var j=d.body,n=0;n<k.length;n++){if(!j.childNodes)return null;j=j.childNodes[k[n]]}return j}var d=this;if(g){b=e(g.startAddress);g=e(g.endAddress);b=b;if(l)m.remove(b);else for(;b&&m.inDoc(g,d.document)&&!(m.getPosition(b,g)&m.POSITION_FOLLOWING);){l=b.nextSibling;m.remove(b);b=l}d.fireEvent("updateSections")}}},
selectsection:{execCommand:function(b,g){if(!g&&!g.dom)return false;b=this.selection.getRange();g={startAddress:v.clone(g.startAddress,[]),endAddress:v.clone(g.endAddress,[])};g.endAddress[g.endAddress.length-1]++;b.moveToAddress(g).select().scrollToView();return true},notNeedUndo:true},scrolltosection:{execCommand:function(b,g){if(!g&&!g.dom)return false;b=this.selection.getRange();g={startAddress:g.startAddress,endAddress:g.endAddress};g.endAddress[g.endAddress.length-1]++;b.moveToAddress(g).scrollToView();
return true},notNeedUndo:true}}}});UE.plugin.register("simpleupload",function(){function h(){var b=a.offsetWidth||50,g=a.offsetHeight||20,l=document.createElement("iframe"),e="display:block;width:"+b+"px;height:"+g+"px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";m.on(l,"load",function(){var d=(+new Date).toString(36),k,j,n;j=l.contentDocument||l.contentWindow.document;n=j.body;k=j.createElement("div");
k.innerHTML='<form id="edui_form_'+d+'" target="edui_iframe_'+d+'" method="POST" enctype="multipart/form-data" action="'+f.getOpt("serverUrl")+'" style="'+e+'"><input id="edui_input_'+d+'" type="file" accept="image/*" name="'+f.options.imageFieldName+'" style="'+e+'"></form><iframe id="edui_iframe_'+d+'" name="edui_iframe_'+d+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>';k.className="edui-"+f.options.theme;k.id=f.ui.id+"_iframeupload";n.style.cssText=
e;n.style.width=b+"px";n.style.height=g+"px";n.appendChild(k);if(n.parentNode){n.parentNode.style.width=b+"px";n.parentNode.style.height=b+"px"}var p=j.getElementById("edui_form_"+d),q=j.getElementById("edui_input_"+d),o=j.getElementById("edui_iframe_"+d);m.on(q,"change",function(){function s(){try{var M,L,Q,S=(o.contentDocument||o.contentWindow.document).body;L=(new Function("return "+(S.innerText||S.textContent||"")))();M=f.options.imageUrlPrefix+L.url;if(L.state=="SUCCESS"&&L.url){Q=f.document.getElementById(u);
Q.setAttribute("src",M);Q.setAttribute("_src",M);Q.setAttribute("title",L.title||"");Q.setAttribute("alt",L.original||"");Q.removeAttribute("id");m.removeClasses(Q,"loadingclass")}else t&&t(L.state)}catch(R){t&&t(f.getLang("simpleupload.loadError"))}p.reset();m.un(o,"load",s)}function t(M){if(u){var L=f.document.getElementById(u);L&&m.remove(L);f.fireEvent("showmessage",{id:u,content:M,type:"error",timeout:4E3})}}if(q.value){var u="loading_"+(+new Date).toString(36),x=v.serializeParam(f.queryCommandValue("serverparam"))||
"",z=f.getActionUrl(f.getOpt("imageActionName")),F=f.getOpt("imageAllowFiles");f.focus();f.execCommand("inserthtml",'<img class="loadingclass" id="'+u+'" src="'+f.options.themePath+f.options.theme+'/images/spacer.gif" title="'+(f.getLang("simpleupload.loading")||"")+'" >');if(f.getOpt("imageActionName")){var D=q.value;D=D?D.substr(D.lastIndexOf(".")):"";if(!D||F&&(F.join("")+".").indexOf(D.toLowerCase()+".")==-1)t(f.getLang("simpleupload.exceedTypeError"));else{m.on(o,"load",s);p.action=v.formatUrl(z+
(z.indexOf("?")==-1?"?":"&")+x);p.submit()}}else errorHandler(f.getLang("autoupload.errorLoadConfig"))}});var r;f.addListener("selectionchange",function(){clearTimeout(r);r=setTimeout(function(){var s=f.queryCommandState("simpleupload");q.disabled=s==-1?"disabled":false},400)});c=true});l.style.cssText=e;a.appendChild(l)}var f=this,c=false,a;return{bindEvents:{ready:function(){v.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+
"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)},simpleuploadbtnready:function(b,g){a=g;f.afterConfigReady(h)}},outputRule:function(b){v.each(b.getNodesByTagName("img"),
function(g){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(g.getAttr("class"))&&g.parentNode.removeChild(g)})},commands:{simpleupload:{queryCommandState:function(){return c?0:-1}}}}});UE.plugin.register("serverparam",function(){var h={};return{commands:{serverparam:{execCommand:function(f,c,a){if(c===undefined||c===null)h={};else if(v.isString(c))if(a===undefined||a===null)delete h[c];else h[c]=a;else if(v.isObject(c))v.extend(h,c,true);else v.isFunction(c)&&v.extend(h,c(),true)},queryCommandValue:function(){return h||
{}}}}}});UE.plugin.register("insertfile",function(){function h(c){c=c.substr(c.lastIndexOf(".")+1).toLowerCase();var a={rar:"icon_rar.gif",zip:"icon_rar.gif",tar:"icon_rar.gif",gz:"icon_rar.gif",bz2:"icon_rar.gif",doc:"icon_doc.gif",docx:"icon_doc.gif",pdf:"icon_pdf.gif",mp3:"icon_mp3.gif",xls:"icon_xls.gif",chm:"icon_chm.gif",ppt:"icon_ppt.gif",pptx:"icon_ppt.gif",avi:"icon_mv.gif",rmvb:"icon_mv.gif",wmv:"icon_mv.gif",flv:"icon_mv.gif",swf:"icon_mv.gif",rm:"icon_mv.gif",exe:"icon_exe.gif",psd:"icon_psd.gif",
txt:"icon_txt.gif",jpg:"icon_jpg.gif",png:"icon_jpg.gif",jpeg:"icon_jpg.gif",gif:"icon_jpg.gif",ico:"icon_jpg.gif",bmp:"icon_jpg.gif"};return a[c]?a[c]:a.txt}var f=this;return{commands:{insertfile:{execCommand:function(c,a){a=v.isArray(a)?a:[a];var b,g,l,e;c="";b=f.getOpt("UEDITOR_HOME_URL");var d=b+(b.substr(b.length-1)=="/"?"":"/")+"dialogs/attachment/fileTypeImages/";for(b=0;b<a.length;b++){g=a[b];l=d+h(g.url);e=g.title||g.url.substr(g.url.lastIndexOf("/")+1);c+='<p style="line-height: 16px;"><img style="vertical-align: middle; margin-right: 2px;" src="'+
l+'" _src="'+l+'" /><a style="font-size:12px; color:#0066cc;" href="'+g.url+'" title="'+e+'">'+e+"</a></p>"}f.execCommand("insertHtml",c)}}}}});B=B||{};B.editor=B.editor||{};UE.ui=B.editor.ui={};(function(){function h(){var e=document.getElementById("edui_fixedlayer");l.setViewportOffset(e,{left:0,top:0})}function f(){a.on(window,"scroll",h);a.on(window,"resize",B.editor.utils.defer(h,0,true))}var c=B.editor.browser,a=B.editor.dom.domUtils,b=window.$EDITORUI={},g=0,l=B.editor.ui.uiUtils={uid:function(e){return e?
e.ID$EDITORUI||(e.ID$EDITORUI=++g):++g},hook:function(e,d){var k;if(e&&e._callbacks)k=e;else{k=function(){var j;if(e)j=e.apply(this,arguments);for(var n=k._callbacks,p=n.length;p--;){var q=n[p].apply(this,arguments);if(j===undefined)j=q}return j};k._callbacks=[]}k._callbacks.push(d);return k},createElementByHtml:function(e){var d=document.createElement("div");d.innerHTML=e;d=d.firstChild;d.parentNode.removeChild(d);return d},getViewportElement:function(){return c.ie&&c.quirks?document.body:document.documentElement},
getClientRect:function(e){var d;try{d=e.getBoundingClientRect()}catch(k){d={left:0,top:0,height:0,width:0}}for(var j={left:Math.round(d.left),top:Math.round(d.top),height:Math.round(d.bottom-d.top),width:Math.round(d.right-d.left)},n;(n=e.ownerDocument)!==document&&(e=a.getWindow(n).frameElement);){d=e.getBoundingClientRect();j.left+=d.left;j.top+=d.top}j.bottom=j.top+j.height;j.right=j.left+j.width;return j},getViewportRect:function(){var e=l.getViewportElement(),d=(window.innerWidth||e.clientWidth)|
0;e=(window.innerHeight||e.clientHeight)|0;return{left:0,top:0,height:e,width:d,bottom:e,right:d}},setViewportOffset:function(e,d){var k=l.getFixedLayer();if(e.parentNode===k){e.style.left=d.left+"px";e.style.top=d.top+"px"}else a.setViewportOffset(e,d)},getEventOffset:function(e){var d=l.getClientRect(e.target||e.srcElement);e=l.getViewportOffsetByEvent(e);return{left:e.left-d.left,top:e.top-d.top}},getViewportOffsetByEvent:function(e){var d=e.target||e.srcElement,k=a.getWindow(d).frameElement;e=
{left:e.clientX,top:e.clientY};if(k&&d.ownerDocument!==document){d=l.getClientRect(k);e.left+=d.left;e.top+=d.top}return e},setGlobal:function(e,d){b[e]=d;return'$EDITORUI["'+e+'"]'},unsetGlobal:function(e){delete b[e]},copyAttributes:function(e,d){for(var k=d.attributes,j=k.length;j--;){var n=k[j];if(n.nodeName!="style"&&n.nodeName!="class"&&(!c.ie||n.specified))e.setAttribute(n.nodeName,n.nodeValue)}d.className&&a.addClass(e,d.className);if(d.style.cssText)e.style.cssText+=";"+d.style.cssText},
removeStyle:function(e,d){if(e.style.removeProperty)e.style.removeProperty(d);else if(e.style.removeAttribute)e.style.removeAttribute(d);else throw"";},contains:function(e,d){return e&&d&&(e===d?false:e.contains?e.contains(d):e.compareDocumentPosition(d)&16)},startDrag:function(e,d,k){function j(s){d.ondragmove(s.clientX-n,s.clientY-p,s);if(s.stopPropagation)s.stopPropagation();else s.cancelBubble=true}k=k||document;var n=e.clientX,p=e.clientY;if(k.addEventListener){var q=function(){k.removeEventListener("mousemove",
j,true);k.removeEventListener("mouseup",q,true);window.removeEventListener("mouseup",q,true);d.ondragstop()};k.addEventListener("mousemove",j,true);k.addEventListener("mouseup",q,true);window.addEventListener("mouseup",q,true);e.preventDefault()}else{var o=e.srcElement;o.setCapture();var r=function(){o.releaseCapture();o.detachEvent("onmousemove",j);o.detachEvent("onmouseup",r);o.detachEvent("onlosecaptrue",r);d.ondragstop()};o.attachEvent("onmousemove",j);o.attachEvent("onmouseup",r);o.attachEvent("onlosecaptrue",
r);e.returnValue=false}d.ondragstart()},getFixedLayer:function(){var e=document.getElementById("edui_fixedlayer");if(e==null){e=document.createElement("div");e.id="edui_fixedlayer";document.body.appendChild(e);if(c.ie&&c.version<=8){e.style.position="absolute";f();setTimeout(h)}else e.style.position="fixed";e.style.left="0";e.style.top="0";e.style.width="0";e.style.height="0"}return e},makeUnselectable:function(e){if(c.opera||c.ie&&c.version<9){e.unselectable="on";if(e.hasChildNodes())for(var d=0;d<
e.childNodes.length;d++)e.childNodes[d].nodeType==1&&l.makeUnselectable(e.childNodes[d])}else if(e.style.MozUserSelect!==undefined)e.style.MozUserSelect="none";else if(e.style.WebkitUserSelect!==undefined)e.style.WebkitUserSelect="none";else if(e.style.KhtmlUserSelect!==undefined)e.style.KhtmlUserSelect="none"}}})();(function(){var h=B.editor.utils,f=B.editor.ui.uiUtils,c=B.editor.EventBase,a=B.editor.ui.UIBase=function(){};a.prototype={className:"",uiName:"",initOptions:function(b){for(var g in b)this[g]=
b[g];this.id=this.id||"edui"+f.uid()},initUIBase:function(){this._globalKey=h.unhtml(f.setGlobal(this.id,this))},render:function(b){var g=this.renderHtml();g=f.createElementByHtml(g);for(var l=m.getElementsByTagName(g,"*"),e="edui-"+(this.theme||this.editor.options.theme),d=document.getElementById("edui_fixedlayer"),k=0,j;j=l[k++];)m.addClass(j,e);m.addClass(g,e);if(d){d.className="";m.addClass(d,e)}l=this.getDom();if(l!=null){l.parentNode.replaceChild(g,l);f.copyAttributes(g,l)}else{if(typeof b==
"string")b=document.getElementById(b);b=b||f.getFixedLayer();m.addClass(b,e);b.appendChild(g)}this.postRender()},getDom:function(b){return b?document.getElementById(this.id+"_"+b):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(b){var g="edui-"+this.uiName;return b.replace(/##/g,this.id).replace(/%%-/g,this.uiName?g+"-":"").replace(/%%/g,(this.uiName?g:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},
renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var b=this.getDom();b&&B.editor.dom.domUtils.remove(b);f.unsetGlobal(this.id)}};h.inherits(a,c)})();(function(){var h=B.editor.utils,f=B.editor.ui.UIBase,c=B.editor.ui.Separator=function(a){this.initOptions(a);this.initSeparator()};c.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};h.inherits(c,f)})();(function(){var h=
B.editor.utils,f=B.editor.dom.domUtils,c=B.editor.ui.UIBase,a=B.editor.ui.uiUtils,b=B.editor.ui.Mask=function(g){this.initOptions(g);this.initUIBase()};b.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var g=this;f.on(window,"resize",function(){setTimeout(function(){g.isHidden()||g._fill()})})},show:function(g){this._fill();this.getDom().style.display=
"";this.getDom().style.zIndex=g},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_onClick:function(g,l){this.fireEvent("click",g,l)},_fill:function(){var g=this.getDom(),l=a.getViewportRect();g.style.width=l.width+"px";g.style.height=l.height+"px"}};h.inherits(b,c)})();(function(){function h(d,k){for(var j=0;j<l.length;j++){var n=l[j];if(!n.isHidden())if(n.queryAutoHide(k)!==
false){if(d&&/scroll/ig.test(d.type)&&n.className=="edui-wordpastepop")return;n.hide()}}l.length&&n.editor.fireEvent("afterhidepop")}var f=B.editor.utils,c=B.editor.ui.uiUtils,a=B.editor.dom.domUtils,b=B.editor.ui.UIBase,g=B.editor.ui.Popup=function(d){this.initOptions(d);this.initPopup()},l=[];g.postHide=h;var e=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];g.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,
canSideUp:true,initPopup:function(){this.initUIBase();l.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){if(this.content){if(typeof this.content==
"string")return this.content;return this.content.renderHtml()}else return""},_UIBase_postRender:b.prototype.postRender,postRender:function(){this.content instanceof b&&this.content.postRender();if(this.captureWheel&&!this.captured){this.captured=true;var d=(document.documentElement.clientHeight||document.body.clientHeight)-80,k=this.getDom().offsetHeight,j=c.getClientRect(this.combox.getDom()).top,n=this.getDom("content"),p=this.getDom("body").getElementsByTagName("iframe"),q=this;for(p.length&&(p=
p[0]);j+k>d;)k-=30;n.style.height=k+"px";p&&(p.style.height=k+"px");window.XMLHttpRequest?a.on(n,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(o){if(o.preventDefault)o.preventDefault();else o.returnValue=false;n.scrollTop-=o.wheelDelta?o.wheelDelta/120*60:o.detail/-3*60}):a.on(this.getDom(),"mousewheel",function(o){o.returnValue=false;q.getDom("content").scrollTop-=o.wheelDelta/120*60})}this.fireEvent("postRenderAfter");this.hide(true);this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&
this.autoRender&&this.render()},mesureSize:function(){var d=this.getDom("content");return c.getClientRect(d)},fitSize:function(){if(this.captureWheel&&this.sized)return this.__size;this.sized=true;var d=this.getDom("body");d.style.width="";d.style.height="";var k=this.mesureSize();if(this.captureWheel){d.style.width=-(-20-k.width)+"px";var j=parseInt(this.getDom("content").style.height,10);!window.isNaN(j)&&(k.height=j)}else d.style.width=k.width+"px";d.style.height=k.height+"px";this.__size=k;this.captureWheel&&
(this.getDom("content").style.overflow="auto");return k},showAnchor:function(d,k){this.showAnchorRect(c.getClientRect(d),k)},showAnchorRect:function(d,k){this._doAutoRender();var j=c.getViewportRect();this.getDom().style.visibility="hidden";this._show();var n=this.fitSize(),p;if(k){k=this.canSideLeft&&d.right+n.width>j.right&&d.left>n.width;j=this.canSideUp&&d.top+n.height>j.bottom&&d.bottom>n.height;p=k?d.left-n.width:d.right;d=j?d.bottom-n.height:d.top}else{k=this.canSideLeft&&d.right+n.width>j.right&&
d.left>n.width;j=this.canSideUp&&d.top+n.height>j.bottom&&d.bottom>n.height;p=k?d.right-n.width:d.left;d=j?d.top-n.height:d.bottom}n=this.getDom();c.setViewportOffset(n,{left:p,top:d});a.removeClasses(n,e);n.className+=" "+e[(j?1:0)*2+(k?1:0)];if(this.editor){n.style.zIndex=this.editor.container.style.zIndex*1+10;B.editor.ui.uiUtils.getFixedLayer().style.zIndex=n.style.zIndex-1}this.getDom().style.visibility="visible"},showAt:function(d){var k=d.left;d=d.top;this.showAnchorRect({left:k,top:d,right:k,
bottom:d,height:0,width:0},false,true)},_show:function(){if(this._hidden){this.getDom().style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(d){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=true;d||this.fireEvent("hide")}},queryAutoHide:function(d){return!d||!c.contains(this.getDom(),d)}};f.inherits(g,b);a.on(document,"mousedown",function(d){h(d,d.target||
d.srcElement)});a.on(window,"scroll",function(d,k){h(d,k)})})();(function(){function h(g,l){g='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+g+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+
l.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >';for(var e=0;e<b.length;e++){if(e&&e%10===0)g+="</tr>"+(e==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+l.getLang("standardColor")+"</td></tr>":"")+"<tr"+(e==60?' class="edui-colorpicker-tablefirstrow"':"")+">";g+=e<70?'<td style="padding: 0 2px;"><a hidefocus title="'+b[e]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+
b[e]+'" style="background-color:#'+b[e]+";border:solid #ccc;"+(e<10||e>=60?"border-width:1px;":e>=10&&e<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':""}g+="</tr></table></div>";return g}var f=B.editor.utils,c=B.editor.ui.UIBase,a=B.editor.ui.ColorPicker=function(g){this.initOptions(g);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase()};a.prototype={getHtmlTpl:function(){return h(this.noColorText,this.editor)},_onTableClick:function(g){(g=
(g.target||g.srcElement).getAttribute("data-color"))&&this.fireEvent("pickcolor",g)},_onTableOver:function(g){if(g=(g.target||g.srcElement).getAttribute("data-color"))this.getDom("preview").style.backgroundColor=g},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};f.inherits(a,c);var b="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")})();
(function(){var h=B.editor.utils,f=B.editor.ui.uiUtils,c=B.editor.ui.UIBase,a=B.editor.ui.TablePicker=function(b){this.initOptions(b);this.initTablePicker()};a.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},
_UIBase_render:c.prototype.render,render:function(b){this._UIBase_render(b);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(b,g){var l=this.getDom("overlay").style,e=this.lengthOfCellSide;l.width=b*e+"px";l.height=g*e+"px";this.getDom("label").innerHTML=b+this.editor.getLang("t_col")+" x "+g+this.editor.getLang("t_row");this.numCols=b;this.numRows=g},_onMouseOver:function(b,g){b=b.relatedTarget||b.fromElement;if(!f.contains(g,b)&&
g!==b){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility=""}},_onMouseOut:function(b,g){b=b.relatedTarget||b.toElement;if(!f.contains(g,b)&&g!==b){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(b){this.getDom("overlay");var g=f.getEventOffset(b),l=this.lengthOfCellSide;b=Math.ceil(g.left/
l);g=Math.ceil(g.top/l);this._track(b,g)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}};h.inherits(a,c)})();(function(){var h=B.editor.dom.domUtils,f=B.editor.ui.uiUtils,c='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(B.editor.browser.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');
B.editor.ui.Stateful={alwalysHoverable:false,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){return this._Stateful_dGetHtmlTpl().replace(/stateful/g,function(){return c})},Stateful_onMouseEnter:function(a,b){this.target=b;if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");
this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(a,b){var g=a.relatedTarget;!f.contains(b,g)&&b!==g&&this.Stateful_onMouseEnter(a,b)},Stateful_onMouseOut:function(a,b){var g=a.relatedTarget;!f.contains(b,g)&&b!==g&&this.Stateful_onMouseLeave(a,b)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&
this.addState("disabled")},hasState:function(a){return h.hasClass(this.getStateDom(),"edui-state-"+a)},addState:function(a){this.hasState(a)||(this.getStateDom().className+=" edui-state-"+a)},removeState:function(a){this.hasState(a)&&h.removeClasses(this.getStateDom(),["edui-state-"+a])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(a){!this.isDisabled()&&a?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},
setDisabled:function(a){if(a){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else this.removeState("disabled")}}})();(function(){var h=B.editor.utils,f=B.editor.ui.UIBase,c=B.editor.ui.Stateful,a=B.editor.ui.Button=function(b){if(b.name){var g=b.name,l=b.cssRules;if(!b.className)b.className="edui-for-"+g;b.cssRules=".edui-default  .edui-for-"+g+" .edui-icon {"+l+"}"}this.initOptions(b);this.initButton()};a.prototype={uiName:"button",label:"",
title:"",showIcon:true,showText:true,cssRules:"",initButton:function(){this.initUIBase();this.Stateful_init();this.cssRules&&h.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?
'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled)},_onMouseDown:function(b){b=(b=b.target||b.srcElement)&&b.tagName&&b.tagName.toLowerCase();if(b=="input"||b=="object"||b=="object")return false},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(b){this.getDom("label").innerHTML=b}};h.inherits(a,
f);h.extend(a.prototype,c)})();(function(){var h=B.editor.utils,f=B.editor.ui.uiUtils,c=B.editor.ui.UIBase,a=B.editor.ui.Stateful,b=B.editor.ui.SplitButton=function(g){this.initOptions(g);this.initSplitButton()};b.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();if(this.popup!=null){var g=this.popup;this.popup=null;this.setPopup(g)}},_UIBase_postRender:c.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},
setPopup:function(g){if(this.popup!==g){this.popup!=null&&this.popup.dispose();g.addListener("show",h.bind(this._onPopupShow,this));g.addListener("hide",h.bind(this._onPopupHide,this));g.addListener("postrender",h.bind(function(){g.getDom("body").appendChild(f.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(f.getClientRect(this.getDom()).width+20)+'px"></div>'));g.getDom().className+=" "+this.className},this));this.popup=g}},
_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},
showPopup:function(){var g=f.getClientRect(this.getDom());g.top-=this.popup.SHADOW_RADIUS;g.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(g)},_onArrowClick:function(){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}};h.inherits(b,c);h.extend(b.prototype,a,true)})();(function(){var h=B.editor.utils,f=B.editor.ui.uiUtils,c=B.editor.ui.ColorPicker,a=B.editor.ui.Popup,b=B.editor.ui.SplitButton,g=B.editor.ui.ColorButton=function(l){this.initOptions(l);
this.initColorButton()};g.prototype={initColorButton:function(){var l=this;this.popup=new a({content:new c({noColorText:l.editor.getLang("clearColor"),editor:l.editor,onpickcolor:function(e,d){l._onPickColor(d)},onpicknocolor:function(e,d){l._onPickNoColor(d)}}),editor:l.editor});this.initSplitButton()},_SplitButton_postRender:b.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(f.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));
this.getDom().className+=" edui-colorbutton"},setColor:function(l){this.color=this.getDom("colorlump").style.backgroundColor=l},_onPickColor:function(l){if(this.fireEvent("pickcolor",l)!==false){this.setColor(l);this.popup.hide()}},_onPickNoColor:function(){this.fireEvent("picknocolor")!==false&&this.popup.hide()}};h.inherits(g,b)})();(function(){var h=B.editor.utils,f=B.editor.ui.Popup,c=B.editor.ui.TablePicker,a=B.editor.ui.SplitButton,b=B.editor.ui.TableButton=function(g){this.initOptions(g);this.initTableButton()};
b.prototype={initTableButton:function(){var g=this;this.popup=new f({content:new c({editor:g.editor,onpicktable:function(l,e,d){g._onPickTable(e,d)}}),editor:g.editor});this.initSplitButton()},_onPickTable:function(g,l){this.fireEvent("picktable",g,l)!==false&&this.popup.hide()}};h.inherits(b,a)})();(function(){var h=B.editor.utils,f=B.editor.ui.UIBase,c=B.editor.ui.AutoTypeSetPicker=function(a){this.initOptions(a);this.initAutoTypeSetPicker()};c.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},
getHtmlTpl:function(){var a=this.editor,b=a.options.autotypeset,g=a.getLang("autoTypeSet"),l="textAlignValue"+a.uid,e="imageBlockLineValue"+a.uid,d="symbolConverValue"+a.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(b.mergeEmptyline?"checked":"")+">"+g.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(b.removeEmptyline?"checked":"")+">"+g.delLine+
'</td></tr><tr><td nowrap><input type="checkbox" name="removeClass" '+(b.removeClass?"checked":"")+">"+g.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(b.indent?"checked":"")+">"+g.indent+'</td></tr><tr><td nowrap><input type="checkbox" name="textAlign" '+(b.textAlign?"checked":"")+">"+g.alignment+'</td><td colspan="2" id="'+l+'"><input type="radio" name="'+l+'" value="left" '+(b.textAlign&&b.textAlign=="left"?"checked":"")+">"+a.getLang("justifyleft")+'<input type="radio" name="'+
l+'" value="center" '+(b.textAlign&&b.textAlign=="center"?"checked":"")+">"+a.getLang("justifycenter")+'<input type="radio" name="'+l+'" value="right" '+(b.textAlign&&b.textAlign=="right"?"checked":"")+">"+a.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="imageBlockLine" '+(b.imageBlockLine?"checked":"")+">"+g.imageFloat+'</td><td nowrap id="'+e+'"><input type="radio" name="'+e+'" value="none" '+(b.imageBlockLine&&b.imageBlockLine=="none"?"checked":"")+">"+a.getLang("default")+
'<input type="radio" name="'+e+'" value="left" '+(b.imageBlockLine&&b.imageBlockLine=="left"?"checked":"")+">"+a.getLang("justifyleft")+'<input type="radio" name="'+e+'" value="center" '+(b.imageBlockLine&&b.imageBlockLine=="center"?"checked":"")+">"+a.getLang("justifycenter")+'<input type="radio" name="'+e+'" value="right" '+(b.imageBlockLine&&b.imageBlockLine=="right"?"checked":"")+">"+a.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="clearFontSize" '+(b.clearFontSize?
"checked":"")+">"+g.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(b.clearFontFamily?"checked":"")+">"+g.removeFontFamily+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(b.removeEmptyNode?"checked":"")+">"+g.removeHtml+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(b.pasteFilter?"checked":"")+">"+g.pasteFilter+'</td></tr><tr><td nowrap><input type="checkbox" name="symbolConver" '+(b.bdc2sb||
b.tobdc?"checked":"")+">"+g.symbol+'</td><td id="'+d+'"><input type="radio" name="bdc" value="bdc2sb" '+(b.bdc2sb?"checked":"")+">"+g.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(b.tobdc?"checked":"")+">"+g.tobdc+'</td><td nowrap align="right"><button >'+g.run+"</button></td></tr></table></div></div>"},_UIBase_render:f.prototype.render};h.inherits(c,f)})();(function(){function h(l){var e={},d=l.getDom(),k=l.editor.uid,j=null;j=null;for(var n=m.getElementsByTagName(d,"input"),p=n.length-
1,q;q=n[p--];){j=q.getAttribute("type");if(j=="checkbox"){j=q.getAttribute("name");e[j]&&delete e[j];if(q.checked)if(q=document.getElementById(j+"Value"+k))if(/input/ig.test(q.tagName))e[j]=q.value;else{q=q.getElementsByTagName("input");for(var o=q.length-1,r;r=q[o--];)if(r.checked){e[j]=r.value;break}}else e[j]=true;else e[j]=false}else e[q.getAttribute("value")]=q.checked}d=m.getElementsByTagName(d,"select");for(p=0;k=d[p++];){n=k.getAttribute("name");e[n]=e[n]?k.value:""}f.extend(l.editor.options.autotypeset,
e);l.editor.setPreferences("autotypeset",e)}var f=B.editor.utils,c=B.editor.ui.Popup,a=B.editor.ui.AutoTypeSetPicker,b=B.editor.ui.SplitButton,g=B.editor.ui.AutoTypeSetButton=function(l){this.initOptions(l);this.initAutoTypeSetButton()};g.prototype={initAutoTypeSetButton:function(){var l=this;this.popup=new c({content:new a({editor:l.editor}),editor:l.editor,hide:function(){if(!this._hidden&&this.getDom()){h(this);this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide")}}});var e=
0;this.popup.addListener("postRenderAfter",function(){var d=this;if(!e){var k=this.getDom();k.getElementsByTagName("button")[0].onclick=function(){h(d);l.editor.execCommand("autotypeset");d.hide()};m.on(k,"click",function(j){j=j.target||j.srcElement;var n=l.editor.uid;if(j&&j.tagName=="INPUT"){if(j.name=="imageBlockLine"||j.name=="textAlign"||j.name=="symbolConver")for(var p=j.checked,q=document.getElementById(j.name+"Value"+n).getElementsByTagName("input"),o={imageBlockLine:"none",textAlign:"left",
symbolConver:"tobdc"},r=0;r<q.length;r++)if(p){if(q[r].value==o[j.name])q[r].checked="checked"}else q[r].checked=false;if(j.name=="imageBlockLineValue"+n||j.name=="textAlignValue"+n||j.name=="bdc")(j=j.parentNode.previousSibling.getElementsByTagName("input"))&&(j[0].checked=true);h(d)}});e=1}});this.initSplitButton()}};f.inherits(g,b)})();(function(){var h=B.editor.utils,f=B.editor.ui.Popup,c=B.editor.ui.Stateful,a=B.editor.ui.UIBase,b=B.editor.ui.CellAlignPicker=function(g){this.initOptions(g);this.initSelected();
this.initCellAlignPicker()};b.prototype={initSelected:function(){var g={valign:{top:0,middle:1,bottom:2},align:{left:0,center:1,right:2},count:3};if(this.selected)this.selectedIndex=g.valign[this.selected.valign]*g.count+g.align[this.selected.align]},initCellAlignPicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){for(var g=["left","center","right"],l=null,e=-1,d=[],k=0;k<9;k++){l=this.selectedIndex===k?' class="edui-cellalign-selected" ':"";e=k%3;e===0&&d.push("<tr>");
d.push('<td index="'+k+'" '+l+' stateful><div class="edui-icon edui-'+g[e]+'"></div></td>');e===2&&d.push("</tr>")}return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">'+d.join("")+"</table></div></div>"},getStateDom:function(){return this.target},_onClick:function(g){var l=g.target||g.srcElement;if(/icon/.test(l.className)){this.items[l.parentNode.getAttribute("index")].onclick();f.postHide(g)}},_UIBase_render:a.prototype.render};
h.inherits(b,a);h.extend(b.prototype,c,true)})();(function(){var h=B.editor.utils,f=B.editor.ui.Stateful,c=B.editor.ui.uiUtils,a=B.editor.ui.UIBase,b=B.editor.ui.PastePicker=function(g){this.initOptions(g);this.initPastePicker()};b.prototype={initPastePicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+
this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(g){this.editor.ui._isTransfer=true;this.editor.fireEvent("pasteTransfer",
g)},_onClick:function(g){var l=m.getNextDomNode(g),e=c.getViewportRect().height,d=c.getClientRect(l);l.style.top=d.top+d.height>e?-d.height-g.offsetHeight+"px":"";if(/hidden/ig.test(m.getComputedStyle(l,"visibility"))){l.style.visibility="visible";m.addClass(g,"edui-state-opened")}else{l.style.visibility="hidden";m.removeClasses(g,"edui-state-opened")}},_UIBase_render:a.prototype.render};h.inherits(b,a);h.extend(b.prototype,f,true)})();(function(){var h=B.editor.utils,f=B.editor.ui.uiUtils,c=B.editor.ui.UIBase,
a=B.editor.ui.Toolbar=function(b){this.initOptions(b);this.initToolbar()};a.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(b,g){g===undefined?this.items.push(b):this.items.splice(g,0,b)},getHtmlTpl:function(){for(var b=[],g=0;g<this.items.length;g++)b[g]=this.items[g].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+b.join("")+"</div>"},postRender:function(){for(var b=
this.getDom(),g=0;g<this.items.length;g++)this.items[g].postRender();f.makeUnselectable(b)},_onMouseDown:function(b){b=(b=b.target||b.srcElement)&&b.tagName&&b.tagName.toLowerCase();if(b=="input"||b=="object"||b=="object")return false}};h.inherits(a,c)})();(function(){var h=B.editor.utils,f=B.editor.dom.domUtils,c=B.editor.ui.uiUtils,a=B.editor.ui.UIBase,b=B.editor.ui.Popup,g=B.editor.ui.Stateful,l=B.editor.ui.CellAlignPicker,e=B.editor.ui.Menu=function(j){this.initOptions(j);this.initMenu()},d={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},
postRender:function(){},queryAutoHide:function(){return true}};e.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var j=0;j<this.items.length;j++){var n=this.items[j];if(n=="-")this.items[j]=this.getSeparator();else if(!(n instanceof k)){n.editor=this.editor;n.theme=this.editor.options.theme;this.items[j]=this.createItem(n)}}},getSeparator:function(){return d},createItem:function(j){j.menu=this;return new k(j)},
_Popup_getContentHtmlTpl:b.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0)return this._Popup_getContentHtmlTpl();for(var j=[],n=0;n<this.items.length;n++)j[n]=this.items[n].renderHtml();return'<div class="%%-body">'+j.join("")+"</div>"},_Popup_postRender:b.prototype.postRender,postRender:function(){for(var j=this,n=0;n<this.items.length;n++){var p=this.items[n];p.ownerMenu=this;p.postRender()}f.on(this.getDom(),"mouseover",function(q){q=q||event;q=q.relatedTarget||
q.fromElement;var o=j.getDom();!c.contains(o,q)&&o!==q&&j.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(j){if(j){if(c.contains(this.getDom(),j))return false;for(var n=0;n<this.items.length;n++)if(this.items[n].queryAutoHide(j)===false)return false}},clearItems:function(){for(var j=0;j<this.items.length;j++){var n=this.items[j];clearTimeout(n._showingTimer);clearTimeout(n._closingTimer);n.subMenu&&n.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&f.remove(this.getDom());
this.clearItems()},dispose:function(){this.destroy()}};h.inherits(e,b);var k=B.editor.ui.MenuItem=function(j){this.initOptions(j);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof e))if(j.className&&j.className.indexOf("aligntd")!=-1){var n=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment");this.subMenu=new b({content:new l(this.subMenu),parentMenu:n,editor:n.editor,destroy:function(){this.getDom()&&f.remove(this.getDom())}});this.subMenu.addListener("postRenderAfter",
function(){f.on(this.getDom(),"mouseover",function(){n.addState("opened")})})}else this.subMenu=new e(this.subMenu)};k.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var j=this;this.addListener("over",function(){j.ownerMenu.fireEvent("submenuover",j);j.subMenu&&j.delayShowSubMenu()});
if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){j.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(j._closingTimer);j._closingTimer=null;j.addState("opened")});this.ownerMenu.addListener("hide",function(){j.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(n,p){p!==j&&j.delayHideSubMenu()});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(n){if(n&&
c.contains(j.getDom(),n))return false;return this._bakQueryAutoHide(n)}}this.getDom().style.tabIndex="-1";c.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var j=this;if(!j.isDisabled()){j.addState("opened");clearTimeout(j._showingTimer);clearTimeout(j._closingTimer);j._closingTimer=null;j._showingTimer=setTimeout(function(){j.showSubMenu()},250)}},delayHideSubMenu:function(){var j=this;if(!j.isDisabled()){j.removeState("opened");clearTimeout(j._showingTimer);
if(!j._closingTimer)j._closingTimer=setTimeout(function(){j.hasState("opened")||j.hideSubMenu();j._closingTimer=null},400)}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(j){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(j)},_onClick:function(j,n){if(!this.hasState("disabled"))if(this.fireEvent("click",
j,n)!==false)this.subMenu?this.showSubMenu():b.postHide(j)},showSubMenu:function(){var j=c.getClientRect(this.getDom());j.right-=5;j.left+=2;j.width-=7;j.top-=4;j.bottom+=4;j.height+=8;this.subMenu.showAnchorRect(j,true,true)},hideSubMenu:function(){this.subMenu.hide()}};h.inherits(k,a);h.extend(k.prototype,g,true)})();(function(){var h=B.editor.utils,f=B.editor.ui.uiUtils,c=B.editor.ui.Menu,a=B.editor.ui.SplitButton,b=B.editor.ui.Combox=function(g){this.initOptions(g);this.initCombox()};b.prototype=
{uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var g=this;this.items=this.items||[];for(var l=0;l<this.items.length;l++){var e=this.items[l];e.uiName="listitem";e.index=l;e.onclick=function(){g.selectByIndex(this.index)}}this.popup=new c({items:this.items,uiName:"list",editor:this.editor,captureWheel:true,combox:this});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||
"");this.setValue(this.initValue||"")},showPopup:function(){var g=f.getClientRect(this.getDom());g.top+=1;g.bottom-=1;g.height-=2;this.popup.showAnchorRect(g)},getValue:function(){return this.value},setValue:function(g){var l=this.indexByValue(g);if(l!=-1){this.selectedIndex=l;this.setLabel(this.items[l].label);this.value=this.items[l].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(g));this.value=g}},setLabel:function(g){this.label=this.getDom("button_body").innerHTML=
g},getLabelForUnknowValue:function(g){return g},indexByValue:function(g){for(var l=0;l<this.items.length;l++)if(g==this.items[l].value)return l;return-1},getItem:function(g){return this.items[g]},selectByIndex:function(g){if(g<this.items.length&&this.fireEvent("select",g)!==false){this.selectedIndex=g;this.value=this.items[g].value;this.setLabel(this.items[g].label)}}};h.inherits(b,a)})();(function(){var h=B.editor.utils,f=B.editor.dom.domUtils,c=B.editor.ui.uiUtils,a=B.editor.ui.Mask,b=B.editor.ui.UIBase,
g=B.editor.ui.Button,l=B.editor.ui.Dialog=function(j){if(j.name){var n=j.name,p=j.cssRules;if(!j.className)j.className="edui-for-"+n;if(p)j.cssRules=".edui-default .edui-for-"+n+" .edui-dialog-content  {"+p+"}"}this.initOptions(h.extend({autoReset:true,draggable:true,onok:function(){},oncancel:function(){},onclose:function(q,o){return o?this.onok():this.oncancel()},holdScroll:false},j));this.initDialog()},e,d,k;l.prototype={draggable:false,uiName:"dialog",initDialog:function(){var j=this,n=this.editor.options.theme;
this.cssRules&&h.cssRule("edui-customize-"+this.name+"-style",this.cssRules);this.initUIBase();this.modalMask=e||(e=new a({className:"edui-dialog-modalmask",theme:n,onclick:function(){k&&k.close(false)}}));this.dragMask=d||(d=new a({className:"edui-dialog-dragmask",theme:n}));this.closeButton=new g({className:"edui-dialog-closebutton",title:j.closeDialog,theme:n,onclick:function(){j.close(false)}});this.fullscreen&&this.initResizeEvent();if(this.buttons)for(n=0;n<this.buttons.length;n++)this.buttons[n]instanceof
g||(this.buttons[n]=new g(h.extend(this.buttons[n],{editor:this.editor},true)))},initResizeEvent:function(){var j=this;f.on(window,"resize",function(){if(!(j._hidden||j._hidden===undefined)){j.__resizeTimer&&window.clearTimeout(j.__resizeTimer);j.__resizeTimer=window.setTimeout(function(){j.__resizeTimer=null;var n=j.getDom(),p=j.getDom("content"),q=UE.ui.uiUtils.getClientRect(n),o=UE.ui.uiUtils.getClientRect(p),r=c.getViewportRect();p.style.width=r.width-q.width+o.width+"px";p.style.height=r.height-
q.height+o.height+"px";n.style.width=r.width+"px";n.style.height=r.height+"px";j.fireEvent("resize")},100)}})},fitSize:function(){var j=this.getDom("body"),n=this.mesureSize();j.style.width=n.width+"px";j.style.height=n.height+"px";return n},safeSetOffset:function(j){var n=this.getDom(),p=c.getViewportRect(),q=c.getClientRect(n),o=j.left;if(o+q.width>p.right)o=p.right-q.width;j=j.top;if(j+q.height>p.bottom)j=p.bottom-q.height;n.style.left=Math.max(o,0)+"px";n.style.top=Math.max(j,0)+"px"},showAtCenter:function(){var j=
c.getViewportRect();if(this.fullscreen){var n=this.getDom(),p=this.getDom("content");n.style.display="block";var q=UE.ui.uiUtils.getClientRect(n),o=UE.ui.uiUtils.getClientRect(p);n.style.left="-100000px";p.style.width=j.width-q.width+o.width+"px";p.style.height=j.height-q.height+o.height+"px";n.style.width=j.width+"px";n.style.height=j.height+"px";n.style.left=0;this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,
overflowY:document.body.style.overflowY}};document.documentElement.style.overflowX="hidden";document.documentElement.style.overflowY="hidden";document.body.style.overflowX="hidden";document.body.style.overflowY="hidden"}else{this.getDom().style.display="";p=this.fitSize();q=this.getDom("titlebar").offsetHeight|0;n=j.width/2-p.width/2;j=j.height/2-(p.height-q)/2-q;p=this.getDom();this.safeSetOffset({left:Math.max(n|0,0),top:Math.max(j|0,0)});f.hasClass(p,"edui-state-centered")||(p.className+=" edui-state-centered")}this._show()},
getContentHtml:function(){var j="";if(typeof this.content=="string")j=this.content;else if(this.iframeUrl)j='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>';return j},getHtmlTpl:function(){var j="";if(this.buttons){j=[];for(var n=0;n<this.buttons.length;n++)j[n]=this.buttons[n].renderHtml();j='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+
j.join("")+"</div></div>"}return'<div id="##" class="%%"><div '+(!this.fullscreen?'class="%%"':'class="%%-wrap edui-dialog-fullscreen-flag"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+
"</div>"+j+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var j=this;this.addListener("show",function(){j.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){j.modalMask.hide()});if(this.buttons)for(var n=0;n<this.buttons.length;n++)this.buttons[n].postRender();f.on(window,"resize",function(){setTimeout(function(){j.isHidden()||
j.safeSetOffset(c.getClientRect(j.getDom()))})});this._hide()},mesureSize:function(){var j=this.getDom("body"),n=c.getClientRect(this.getDom("content")).width;j.style.width=n;return c.getClientRect(j)},_onTitlebarMouseDown:function(j){if(this.draggable){var n;c.getViewportRect();var p=this;c.startDrag(j,{ondragstart:function(){n=c.getClientRect(p.getDom());p.getDom("contmask").style.visibility="visible";p.dragMask.show(p.getDom().style.zIndex-1)},ondragmove:function(q,o){p.safeSetOffset({left:n.left+
q,top:n.top+o})},ondragstop:function(){p.getDom("contmask").style.visibility="hidden";f.removeClasses(p.getDom(),["edui-state-centered"]);p.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml();this.fireEvent("dialogafterreset")},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent("show");B.editor.ui.uiUtils.getFixedLayer().style.zIndex=
this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var j=this.getDom();j.style.display="none";j.style.zIndex="";j.style.width="";j.style.height="";this._hidden=true;this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(j){this.render();this.open()}this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(n){}k=this},_onCloseButtonClick:function(){this.close(false)},close:function(j){if(this.fireEvent("close",
j)!==false){if(this.fullscreen){document.documentElement.style.overflowX=this._originalContext.html.overflowX;document.documentElement.style.overflowY=this._originalContext.html.overflowY;document.body.style.overflowX=this._originalContext.body.overflowX;document.body.style.overflowY=this._originalContext.body.overflowY;delete this._originalContext}this._hide();j=this.getDom("content");var n=this.getDom("iframe");if(j&&n){(n=n.contentDocument||n.contentWindow.document)&&(n.body.innerHTML="");f.remove(j)}}}};
h.inherits(l,b)})();(function(){var h=B.editor.utils,f=B.editor.ui.Menu,c=B.editor.ui.SplitButton,a=B.editor.ui.MenuButton=function(b){this.initOptions(b);this.initMenuButton()};a.prototype={initMenuButton:function(){var b=this;this.uiName="menubutton";this.popup=new f({items:b.items,className:b.className,editor:b.editor});this.popup.addListener("show",function(){for(var g=0;g<this.items.length;g++){this.items[g].removeState("checked");if(this.items[g].value==b._value){this.items[g].addState("checked");
this.value=b._value}}});this.initSplitButton()},setValue:function(b){this._value=b}};h.inherits(a,c)})();(function(){var h=B.editor.utils,f=B.editor.ui.Popup,c=B.editor.ui.SplitButton,a=B.editor.ui.MultiMenuPop=function(b){this.initOptions(b);this.initMultiMenu()};a.prototype={initMultiMenu:function(){var b=this;this.popup=new f({content:"",editor:b.editor,iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+b.id+
'_iframe" src="'+b.iframeUrl+'" frameborder="0"></iframe>';b.editor.container.style.zIndex&&(this.getDom().style.zIndex=b.editor.container.style.zIndex*1+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};h.inherits(a,c)})();(function(){function h(j){if(!g.findParent(j.target||j.srcElement,function(p){return g.hasClass(p,"edui-shortcutmenu")||g.hasClass(p,"edui-popup")},true)){j=0;for(var n;n=l[j++];)n.hide()}}var f=B.editor.ui,c=f.UIBase,a=f.uiUtils,b=B.editor.utils,
g=B.editor.dom.domUtils,l=[],e,d=false,k=f.ShortCutMenu=function(j){this.initOptions(j);this.initShortCutMenu()};k.postHide=h;k.prototype={isHidden:true,SPACE:5,initShortCutMenu:function(){this.items=this.items||[];this.initUIBase();this.initItems();this.initEvent();l.push(this)},initEvent:function(){var j=this,n=j.editor.document;g.on(n,"mousemove",function(p){if(j.isHidden===false)if(!(j.getSubMenuMark()||j.eventType=="contextmenu")){var q=true,o=j.getDom(),r=o.offsetWidth/2+j.SPACE,s=o.offsetHeight/
2,t=Math.abs(p.screenX-j.left),u=Math.abs(p.screenY-j.top);clearTimeout(e);e=setTimeout(function(){if(u>0&&u<s)j.setOpacity(o,"1");else if(u>s&&u<s+70){j.setOpacity(o,"0.5");q=false}else u>s+70&&u<s+140&&j.hide();if(q&&t>0&&t<r)j.setOpacity(o,"1");else if(t>r&&t<r+70)j.setOpacity(o,"0.5");else t>r+70&&t<r+140&&j.hide()})}});y.chrome&&g.on(n,"mouseout",function(p){p=p.relatedTarget||p.toElement;if(p==null||p.tagName=="HTML")j.hide()});j.editor.addListener("afterhidepop",function(){j.isHidden||(d=true)})},
initItems:function(){if(b.isArray(this.items))for(var j=0,n=this.items.length;j<n;j++){var p=this.items[j].toLowerCase();if(f[p]){this.items[j]=new f[p](this.editor);this.items[j].className+=" edui-shortcutsubmenu "}}},setOpacity:function(j,n){if(y.ie&&y.version<9)j.style.filter="alpha(opacity = "+parseFloat(n)*100+");";else j.style.opacity=n},getSubMenuMark:function(){d=false;var j=a.getFixedLayer();j=g.getElementsByTagName(j,"div",function(q){return g.hasClass(q,"edui-shortcutsubmenu edui-popup")});
for(var n=0,p;p=j[n++];)if(p.style.display!="none")d=true;return d},show:function(j,n){function p(t){if(t.left<0)t.left=0;if(t.top<0)t.top=0;r.style.cssText="position:absolute;left:"+t.left+"px;top:"+t.top+"px;"}function q(t){t.tagName||(t=t.getDom());o.left=parseInt(t.style.left);o.top=parseInt(t.style.top);o.top-=r.offsetHeight+15;p(o)}var o={},r=this.getDom(),s=a.getFixedLayer();this.eventType=j.type;r.style.cssText="display:block;left:-9999px";if(j.type=="contextmenu"&&n)(n=g.getElementsByTagName(s,
"div","edui-contextmenu")[0])?q(n):this.editor.addListener("aftershowcontextmenu",function(t,u){q(u)});else{o=a.getViewportOffsetByEvent(j);o.top-=r.offsetHeight+this.SPACE;o.left+=this.SPACE+20;p(o);this.setOpacity(r,0.2)}this.isHidden=false;this.left=j.screenX+r.offsetWidth/2-this.SPACE;this.top=j.screenY-r.offsetHeight/2-this.SPACE;if(this.editor){r.style.zIndex=this.editor.container.style.zIndex*1+10;s.style.zIndex=r.style.zIndex-1}},hide:function(){if(this.getDom())this.getDom().style.display=
"none";this.isHidden=true},postRender:function(){if(b.isArray(this.items))for(var j=0,n;n=this.items[j++];)n.postRender()},getHtmlTpl:function(){var j;if(b.isArray(this.items)){j=[];for(var n=0;n<this.items.length;n++)j[n]=this.items[n].renderHtml();j=j.join("")}else j=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+j+"</div>"}};b.inherits(k,c);g.on(document,"mousedown",function(j){h(j)});g.on(window,"scroll",
function(j){h(j)})})();(function(){var h=B.editor.utils,f=B.editor.ui.UIBase,c=B.editor.ui.Breakline=function(a){this.initOptions(a);this.initSeparator()};c.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}};h.inherits(c,f)})();(function(){var h=B.editor.utils,f=B.editor.dom.domUtils,c=B.editor.ui.UIBase,a=B.editor.ui.Message=function(b){this.initOptions(b);this.initMessage()};a.prototype={initMessage:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-message %%"> <div id="##_closer" class="edui-message-closer">\u00d7</div> <div id="##_body" class="edui-message-body edui-message-type-info"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-message-content">  </div> </div></div>'},
reset:function(b){var g=this;if(!b.keepshow){clearTimeout(this.timer);g.timer=setTimeout(function(){g.hide()},b.timeout||4E3)}b.content!==undefined&&g.setContent(b.content);b.type!==undefined&&g.setType(b.type);g.show()},postRender:function(){var b=this,g=this.getDom("closer");g&&f.on(g,"click",function(){b.hide()})},setContent:function(b){this.getDom("content").innerHTML=b},setType:function(b){b=b||"info";var g=this.getDom("body");g.className=g.className.replace(/edui-message-type-[\w-]+/,"edui-message-type-"+
b)},getContent:function(){return this.getDom("content").innerHTML},getType:function(){var b=this.getDom("body").match(/edui-message-type-([\w-]+)/);return b?b[1]:""},show:function(){this.getDom().style.display="block"},hide:function(){var b=this.getDom();if(b){b.style.display="none";b.parentNode&&b.parentNode.removeChild(b)}}};h.inherits(a,c)})();(function(){var h=B.editor.utils,f=B.editor.ui,c=f.Dialog;f.buttons={};f.Dialog=function(d){var k=new c(d);k.addListener("hide",function(){if(k.editor){var j=
k.editor;try{if(y.gecko){var n=j.window.scrollY,p=j.window.scrollX;j.body.focus();j.window.scrollTo(p,n)}else j.focus()}catch(q){}}});return k};for(var a={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",
preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",
template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"},b=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow",
"deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"],g=0,l;l=b[g++];){l=l.toLowerCase();f[l]=function(d){return function(k){var j=new f.Button({className:"edui-for-"+d,title:k.options.labelMap[d]||k.getLang("labelMap."+d)||"",onclick:function(){k.execCommand(d)},theme:k.options.theme,showText:false});f.buttons[d]=j;k.addListener("selectionchange",function(n,p,q){n=k.queryCommandState(d);if(n==-1){j.setDisabled(true);j.setChecked(false)}else if(!q){j.setDisabled(false);
j.setChecked(n)}});return j}}(l)}f.cleardoc=function(d){var k=new f.Button({className:"edui-for-cleardoc",title:d.options.labelMap.cleardoc||d.getLang("labelMap.cleardoc")||"",theme:d.options.theme,onclick:function(){confirm(d.getLang("confirmClear"))&&d.execCommand("cleardoc")}});f.buttons.cleardoc=k;d.addListener("selectionchange",function(){k.setDisabled(d.queryCommandState("cleardoc")==-1)});return k};b={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr",
"rtl"]};for(var e in b)(function(d,k){for(var j=0,n;n=k[j++];)(function(p){f[d.replace("float","")+p]=function(q){var o=new f.Button({className:"edui-for-"+d.replace("float","")+p,title:q.options.labelMap[d.replace("float","")+p]||q.getLang("labelMap."+d.replace("float","")+p)||"",theme:q.options.theme,onclick:function(){q.execCommand(d,p)}});f.buttons[d]=o;q.addListener("selectionchange",function(r,s,t){o.setDisabled(q.queryCommandState(d)==-1);o.setChecked(q.queryCommandValue(d)==p&&!t)});return o}})(n)})(e,
b[e]);for(g=0;l=["backcolor","forecolor"][g++];)f[l]=function(d){return function(k){var j=new f.ColorButton({className:"edui-for-"+d,color:"default",title:k.options.labelMap[d]||k.getLang("labelMap."+d)||"",editor:k,onpickcolor:function(n,p){k.execCommand(d,p)},onpicknocolor:function(){k.execCommand(d,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){k.execCommand(d,this.color)}});f.buttons[d]=j;k.addListener("selectionchange",function(){j.setDisabled(k.queryCommandState(d)==
-1)});return j}}(l);b={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(e in b)(function(d,k){for(var j=0,n;n=k[j++];)y.opera&&n==="searchreplace"||function(p){f[p]=function(q,o,r){o=o||(q.options.iframeUrlMap||{})[p]||a[p];r=q.options.labelMap[p]||q.getLang("labelMap."+p)||"";var s;if(o){s=
new f.Dialog(h.extend({iframeUrl:q.ui.mapUrl(o),editor:q,className:"edui-for-"+p,title:r,holdScroll:p==="insertimage",fullscreen:/charts|preview/.test(p),closeDialog:q.getLang("closeDialog")},d=="ok"?{buttons:[{className:"edui-okbutton",label:q.getLang("ok"),editor:q,onclick:function(){s.close(true)}},{className:"edui-cancelbutton",label:q.getLang("cancel"),editor:q,onclick:function(){s.close(false)}}]}:{}));q.ui._dialogs[p+"Dialog"]=s}var t=new f.Button({className:"edui-for-"+p,title:r,onclick:function(){if(s)switch(p){case "wordimage":var u=
q.execCommand("wordimage");if(u&&u.length){s.render();s.open()}break;case "scrawl":if(q.queryCommandState("scrawl")!=-1){s.render();s.open()}break;default:s.render();s.open()}},theme:q.options.theme,disabled:p=="scrawl"&&q.queryCommandState("scrawl")==-1||p=="charts"});f.buttons[p]=t;q.addListener("selectionchange",function(){if(!(p in{edittable:1})){var u=q.queryCommandState(p);if(t.getDom()){t.setDisabled(u==-1);t.setChecked(u)}}});return t}}(n.toLowerCase())})(e,b[e]);f.snapscreen=function(d,k,
j){j=d.options.labelMap.snapscreen||d.getLang("labelMap.snapscreen")||"";var n=new f.Button({className:"edui-for-snapscreen",title:j,onclick:function(){d.execCommand("snapscreen")},theme:d.options.theme});f.buttons.snapscreen=n;if(k=k||(d.options.iframeUrlMap||{}).snapscreen||a.snapscreen){var p=new f.Dialog({iframeUrl:d.ui.mapUrl(k),editor:d,className:"edui-for-snapscreen",title:j,buttons:[{className:"edui-okbutton",label:d.getLang("ok"),editor:d,onclick:function(){p.close(true)}},{className:"edui-cancelbutton",
label:d.getLang("cancel"),editor:d,onclick:function(){p.close(false)}}]});p.render();d.ui._dialogs.snapscreenDialog=p}d.addListener("selectionchange",function(){n.setDisabled(d.queryCommandState("snapscreen")==-1)});return n};f.insertcode=function(d,k,j){k=d.options.insertcode||[];j=d.options.labelMap.insertcode||d.getLang("labelMap.insertcode")||"";var n=[];h.each(k,function(q,o){n.push({label:q,value:o,theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||
"")+"</div>"}})});var p=new f.Combox({editor:d,items:n,onselect:function(q,o){d.execCommand("insertcode",this.items[o].value)},onbuttonclick:function(){this.showPopup()},title:j,initValue:j,className:"edui-for-insertcode",indexByValue:function(q){if(q)for(var o=0,r;r=this.items[o];o++)if(r.value.indexOf(q)!=-1)return o;return-1}});f.buttons.insertcode=p;d.addListener("selectionchange",function(q,o,r){if(!r)if(d.queryCommandState("insertcode")==-1)p.setDisabled(true);else{p.setDisabled(false);if(q=
d.queryCommandValue("insertcode")){q&&(q=q.replace(/['"]/g,"").split(",")[0]);p.setValue(q)}else p.setValue(j)}});return p};f.fontfamily=function(d,k,j){k=d.options.fontfamily||[];j=d.options.labelMap.fontfamily||d.getLang("labelMap.fontfamily")||"";if(k.length){for(var n=0,p,q=[];p=k[n];n++){var o=d.getLang("fontfamily")[p.name]||"";(function(s,t){q.push({label:s,value:t,theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+h.unhtml(this.value)+
'">'+(this.label||"")+"</div>"}})})(p.label||o,p.val)}var r=new f.Combox({editor:d,items:q,onselect:function(s,t){d.execCommand("FontFamily",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:j,initValue:j,className:"edui-for-fontfamily",indexByValue:function(s){if(s)for(var t=0,u;u=this.items[t];t++)if(u.value.indexOf(s)!=-1)return t;return-1}});f.buttons.fontfamily=r;d.addListener("selectionchange",function(s,t,u){if(!u)if(d.queryCommandState("FontFamily")==-1)r.setDisabled(true);
else{r.setDisabled(false);(s=d.queryCommandValue("FontFamily"))&&(s=s.replace(/['"]/g,"").split(",")[0]);r.setValue(s)}});return r}};f.fontsize=function(d,k,j){j=d.options.labelMap.fontsize||d.getLang("labelMap.fontsize")||"";k=k||d.options.fontsize||[];if(k.length){for(var n=[],p=0;p<k.length;p++){var q=k[p]+"px";n.push({label:q,value:q,theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var o=
new f.Combox({editor:d,items:n,title:j,initValue:j,onselect:function(r,s){d.execCommand("FontSize",this.items[s].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});f.buttons.fontsize=o;d.addListener("selectionchange",function(r,s,t){if(!t)if(d.queryCommandState("FontSize")==-1)o.setDisabled(true);else{o.setDisabled(false);o.setValue(d.queryCommandValue("FontSize"))}});return o}};f.paragraph=function(d,k,j){j=d.options.labelMap.paragraph||d.getLang("labelMap.paragraph")||
"";k=d.options.paragraph||[];if(!h.isEmptyObject(k)){var n=[];for(var p in k)n.push({value:p,label:k[p]||d.getLang("paragraph")[p],theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var q=new f.Combox({editor:d,items:n,title:j,initValue:j,className:"edui-for-paragraph",onselect:function(o,r){d.execCommand("Paragraph",this.items[r].value)},onbuttonclick:function(){this.showPopup()}});f.buttons.paragraph=
q;d.addListener("selectionchange",function(o,r,s){if(!s)if(d.queryCommandState("Paragraph")==-1)q.setDisabled(true);else{q.setDisabled(false);o=d.queryCommandValue("Paragraph");r=q.indexByValue(o);if(r!=-1){q.setValue(o);ueSetParagraphFoucs(r)}else q.setValue(q.initValue)}});return q}};f.customstyle=function(d){var k=d.options.customstyle||[],j=d.options.labelMap.customstyle||d.getLang("labelMap.customstyle")||"";if(k.length){for(var n=d.getLang("customstyle"),p=0,q=[],o;o=k[p++];)(function(s){var t=
{};t.label=s.label?s.label:n[s.name];t.style=s.style;t.className=s.className;t.tag=s.tag;q.push({label:t.label,value:t,theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+t.tag+" "+(t.className?' class="'+t.className+'"':"")+(t.style?' style="'+t.style+'"':"")+">"+t.label+"</"+t.tag+"></div>"}})})(o);var r=new f.Combox({editor:d,items:q,title:j,initValue:j,className:"edui-for-customstyle",onselect:function(s,t){d.execCommand("customstyle",this.items[t].value)},
onbuttonclick:function(){this.showPopup()},indexByValue:function(s){for(var t=0,u;u=this.items[t++];)if(u.label==s)return t-1;return-1}});f.buttons.customstyle=r;d.addListener("selectionchange",function(s,t,u){if(!u)if(d.queryCommandState("customstyle")==-1)r.setDisabled(true);else{r.setDisabled(false);s=d.queryCommandValue("customstyle");r.indexByValue(s)!=-1?r.setValue(s):r.setValue(r.initValue)}});return r}};f.inserttable=function(d,k,j){j=d.options.labelMap.inserttable||d.getLang("labelMap.inserttable")||
"";var n=new f.TableButton({editor:d,title:j,className:"edui-for-inserttable",onpicktable:function(p,q,o){d.execCommand("InsertTable",{numRows:o,numCols:q,border:1})},onbuttonclick:function(){this.showPopup()}});f.buttons.inserttable=n;d.addListener("selectionchange",function(){n.setDisabled(d.queryCommandState("inserttable")==-1)});return n};f.lineheight=function(d){var k=d.options.lineheight||[];if(k.length){for(var j=0,n,p=[];n=k[j++];)p.push({label:n,value:n,theme:d.options.theme,onclick:function(){d.execCommand("lineheight",
this.value)}});var q=new f.MenuButton({editor:d,className:"edui-for-lineheight",title:d.options.labelMap.lineheight||d.getLang("labelMap.lineheight")||"",items:p,onbuttonclick:function(){var o=d.queryCommandValue("LineHeight")||this.value;d.execCommand("LineHeight",o)}});f.buttons.lineheight=q;d.addListener("selectionchange",function(){var o=d.queryCommandState("LineHeight");if(o==-1)q.setDisabled(true);else{q.setDisabled(false);var r=d.queryCommandValue("LineHeight");r&&q.setValue((r+"").replace(/cm/,
""));q.setChecked(o)}});return q}};e=["top","bottom"];for(b=0;g=e[b++];)(function(d){f["rowspacing"+d]=function(k){var j=k.options["rowspacing"+d]||[];if(!j.length)return null;for(var n=0,p,q=[];p=j[n++];)q.push({label:p,value:p,theme:k.options.theme,onclick:function(){k.execCommand("rowspacing",this.value,d)}});var o=new f.MenuButton({editor:k,className:"edui-for-rowspacing"+d,title:k.options.labelMap["rowspacing"+d]||k.getLang("labelMap.rowspacing"+d)||"",items:q,onbuttonclick:function(){var r=
k.queryCommandValue("rowspacing",d)||this.value;k.execCommand("rowspacing",r,d)}});f.buttons[d]=o;k.addListener("selectionchange",function(){var r=k.queryCommandState("rowspacing",d);if(r==-1)o.setDisabled(true);else{o.setDisabled(false);var s=k.queryCommandValue("rowspacing",d);s&&o.setValue((s+"").replace(/%/,""));o.setChecked(r)}});return o}})(g);e=["insertorderedlist","insertunorderedlist"];for(b=0;g=e[b++];)(function(d){f[d]=function(k){var j=k.options[d],n=function(){k.execCommand(d,this.value)},
p=[];for(var q in j)p.push({label:j[q]||k.getLang()[d][q]||"",value:q,theme:k.options.theme,onclick:n});var o=new f.MenuButton({editor:k,className:"edui-for-"+d,title:k.getLang("labelMap."+d)||"",items:p,onbuttonclick:function(){var r=k.queryCommandValue(d)||this.value;k.execCommand(d,r)}});f.buttons[d]=o;k.addListener("selectionchange",function(){var r=k.queryCommandState(d);if(r==-1)o.setDisabled(true);else{o.setDisabled(false);var s=k.queryCommandValue(d);o.setValue(s);o.setChecked(r)}});return o}})(g);
f.fullscreen=function(d,k){k=d.options.labelMap.fullscreen||d.getLang("labelMap.fullscreen")||"";var j=new f.Button({className:"edui-for-fullscreen",title:k,theme:d.options.theme,onclick:function(){d.ui&&d.ui.setFullScreen(!d.ui.isFullScreen());this.setChecked(d.ui.isFullScreen())}});f.buttons.fullscreen=j;d.addListener("selectionchange",function(){var n=d.queryCommandState("fullscreen");j.setDisabled(n==-1);j.setChecked(d.ui.isFullScreen())});return j};f.emotion=function(d,k){var j=new f.MultiMenuPop({title:d.options.labelMap.emotion||
d.getLang("labelMap.emotion")||"",editor:d,className:"edui-for-emotion",iframeUrl:d.ui.mapUrl(k||(d.options.iframeUrlMap||{}).emotion||a.emotion)});f.buttons.emotion=j;d.addListener("selectionchange",function(){j.setDisabled(d.queryCommandState("emotion")==-1)});return j};f.autotypeset=function(d){var k=new f.AutoTypeSetButton({editor:d,title:d.options.labelMap.autotypeset||d.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){d.execCommand("autotypeset")}});
f.buttons.autotypeset=k;d.addListener("selectionchange",function(){k.setDisabled(d.queryCommandState("autotypeset")==-1)});return k};f.simpleupload=function(d){var k=new f.Button({className:"edui-for-simpleupload",title:d.options.labelMap.simpleupload||d.getLang("labelMap.simpleupload")||"",onclick:function(){},theme:d.options.theme,showText:false});f.buttons.simpleupload=k;d.addListener("ready",function(){var j=k.getDom("body").children[0];d.fireEvent("simpleuploadbtnready",j)});d.addListener("selectionchange",
function(j,n,p){j=d.queryCommandState("simpleupload");if(j==-1){k.setDisabled(true);k.setChecked(false)}else if(!p){k.setDisabled(false);k.setChecked(j)}});return k}})();(function(){function h(e){this.initOptions(e);this.initEditorUI()}var f=B.editor.utils,c=B.editor.ui.uiUtils,a=B.editor.ui.UIBase,b=B.editor.dom.domUtils,g=[];h.prototype={uiName:"editor",initEditorUI:function(){function e(o,r){o.setOpt({wordCount:true,maximumWords:1E4,wordCountMsg:o.options.wordCountMsg||o.getLang("wordCountMsg"),
wordOverFlowMsg:o.options.wordOverFlowMsg||o.getLang("wordOverFlowMsg")});var s=o.options,t=s.maximumWords,u=s.wordCountMsg,x=s.wordOverFlowMsg;r=r.getDom("wordcount");if(s.wordCount){s=o.getContentLength(true);if(s>t){r.innerHTML=x;o.fireEvent("wordcountoverflow")}else r.innerHTML=u.replace("{#leave}",t-s).replace("{#count}",s)}}this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var d=this.editor,k=this;d.addListener("ready",function(){d.getDialog=function(o){return d.ui._dialogs[o+
"Dialog"]};b.on(d.window,"scroll",function(o){B.editor.ui.Popup.postHide(o)});d.ui._actualFrameWidth=d.options.initialFrameWidth;UE.browser.ie&&UE.browser.version===6&&d.container.ownerDocument.execCommand("BackgroundImageCache",false,true);if(d.options.elementPathEnabled)d.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+d.getLang("elementPathTip")+":</div>";if(d.options.wordCount){b.on(d.document,"click",function(){e(d,k);b.un(d.document,"click",arguments.callee)});d.ui.getDom("wordcount").innerHTML=
d.getLang("wordCountTip")}d.ui._scale();if(d.options.scaleEnabled){d.autoHeightEnabled&&d.disableAutoHeight();k.enableScale()}else k.disableScale();if(!d.options.elementPathEnabled&&!d.options.wordCount&&!d.options.scaleEnabled){d.ui.getDom("elementpath").style.display="none";d.ui.getDom("wordcount").style.display="none";d.ui.getDom("scale").style.display="none"}d.selection.isFocus()&&d.fireEvent("selectionchange",false,true)});d.addListener("mousedown",function(o,r){B.editor.ui.Popup.postHide(r,
r.target||r.srcElement);B.editor.ui.ShortCutMenu.postHide(r)});d.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(d);d.getDialog("edittip").open()});var j,n=false,p;d.addListener("afterpaste",function(){if(!d.queryCommandState("pasteplain")){if(B.editor.ui.PastePicker){j=new B.editor.ui.Popup({content:new B.editor.ui.PastePicker({editor:d}),editor:d,className:"edui-wordpastepop"});j.render()}n=true}});d.addListener("afterinserthtml",function(){clearTimeout(p);p=setTimeout(function(){if(j&&
(n||d.ui._isTransfer)){if(j.isHidden()){var o=b.createElement(d.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"});d.selection.getRange().insertNode(o);var r=ra(o,"firstChild","previousSibling");r&&j.showAnchor(r.nodeType==3?r.parentNode:r);b.remove(o)}else j.show();delete d.ui._isTransfer;n=false}},200)});d.addListener("contextmenu",function(o,r){B.editor.ui.Popup.postHide(r)});d.addListener("keydown",function(o,r){j&&j.dispose(r);o=r.keyCode||r.which;r.altKey&&o==90&&UE.ui.buttons.fullscreen.onclick()});
d.addListener("wordcount",function(){e(this,k)});d.addListener("selectionchange",function(){if(d.options.elementPathEnabled)k[(d.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]();if(d.options.scaleEnabled)k[(d.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()});var q=new B.editor.ui.Popup({editor:d,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();d.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(o){this.hide();d.ui._dialogs[o]&&
d.ui._dialogs[o].open()},_onImgSetFloat:function(o){this.hide();d.execCommand("imagefloat",o)},_setIframeAlign:function(o){var r=q.anchorEl,s=r.cloneNode(true);switch(o){case -2:s.setAttribute("align","");break;case -1:s.setAttribute("align","left");break;case 1:s.setAttribute("align","right");break}r.parentNode.insertBefore(s,r);b.remove(r);q.anchorEl=s;q.showAnchor(q.anchorEl)},_updateIframe:function(){var o=d._iframe=q.anchorEl;if(b.hasClass(o,"ueditor_baidumap")){d.selection.getRange().selectNode(o).select();
d.ui._dialogs.mapDialog.open()}else d.ui._dialogs.insertframeDialog.open();q.hide()},_onRemoveButtonClick:function(o){d.execCommand(o);this.hide()},queryAutoHide:function(o){if(o&&o.ownerDocument==d.document)if(o.tagName.toLowerCase()=="img"||b.findParentByTagName(o,"a",true))return o!==q.anchorEl;return B.editor.ui.Popup.prototype.queryAutoHide.call(this,o)}});q.render();if(d.options.imagePopup){d.addListener("mouseover",function(o,r){r=r||window.event;o=r.target||r.srcElement;if(d.ui._dialogs.insertframeDialog&&
/iframe/ig.test(o.tagName))if(r=q.formatHtml("<nobr>"+d.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+d.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+d.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+d.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+d.getLang("modify")+"</span></nobr>")){q.getDom("content").innerHTML=
r;q.anchorEl=o;q.showAnchor(q.anchorEl)}else q.hide()});d.addListener("selectionchange",function(o,r){if(r){var s=o="";r=d.selection.getRange().getClosedNode();s=d.ui._dialogs;if(r&&r.tagName=="IMG"){var t="insertimageDialog";if(r.className.indexOf("edui-faked-video")!=-1||r.className.indexOf("edui-upload-video")!=-1)t="insertvideoDialog";if(r.className.indexOf("edui-faked-webapp")!=-1)t="webappDialog";if(r.src.indexOf("http://api.map.baidu.com")!=-1)t="mapDialog";if(r.className.indexOf("edui-faked-music")!=
-1)t="musicDialog";if(r.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1)t="gmapDialog";if(r.getAttribute("anchorname")){t="anchorDialog";o=q.formatHtml("<nobr>"+d.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+d.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+d.getLang("delete")+"</span></nobr>")}if(r.getAttribute("word_img")){d.word_img=[r.getAttribute("word_img")];
t="wordimageDialog"}if(b.hasClass(r,"loadingclass")||b.hasClass(r,"loaderrorclass"))t="";if(!s[t])return;s="<nobr>"+d.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+d.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+d.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+d.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+
d.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+t+'\');" class="edui-clickable">'+d.getLang("modify")+"</span></nobr>";!o&&(o=q.formatHtml(s))}if(d.ui._dialogs.linkDialog){var u=d.queryCommandValue("link"),x;if(u&&(x=u.getAttribute("_href")||u.getAttribute("href",2))){s=x;if(x.length>30)s=x.substring(0,20)+"...";if(o)o+='<div style="height:5px;"></div>';o+=q.formatHtml("<nobr>"+d.getLang("anthorMsg")+': <a target="_blank" href="'+x+'" title="'+x+'" >'+s+
'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+d.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+d.getLang("clear")+"</span></nobr>");q.showAnchor(u)}}if(o){q.getDom("content").innerHTML=o;q.anchorEl=r||u;q.showAnchor(q.anchorEl)}else q.hide()}})}},_initToolbars:function(){for(var e=this.editor,d=this.toolbars||[],k=[],j=0;j<d.length;j++){for(var n=d[j],p=new B.editor.ui.Toolbar({theme:e.options.theme}),q=0;q<n.length;q++){var o=
n[q],r=null;if(typeof o=="string"){o=o.toLowerCase();if(o=="|")o="Separator";if(o=="||")o="Breakline";if(B.editor.ui[o])r=new B.editor.ui[o](e);if(o=="fullscreen"){if(k&&k[0])k[0].items.splice(0,0,r);else r&&p.items.splice(0,0,r);continue}}else r=o;r&&r.id&&p.add(r)}k[j]=p}f.each(UE._customizeUI,function(s,t){if(s.id&&s.id!=e.key)return false;if(t=s.execFn.call(e,e,t)){s=s.index;if(s===undefined)s=p.items.length;p.add(t,s)}});this.toolbars=k},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+
(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div><div id="##_message_holder" class="%%-messageholder"></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},
showWordImageDialog:function(){this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var e=[],d=0;d<this.toolbars.length;d++)e.push(this.toolbars[d].renderHtml());return e.join("")},setFullScreen:function(e){var d=this.editor,k=d.container.parentNode.parentNode;if(this._fullscreen!=e){this._fullscreen=e;this.editor.fireEvent("beforefullscreenchange",e);if(B.editor.browser.gecko)var j=d.selection.getRange().createBookmark();if(e){for(;k.tagName!="BODY";){var n=B.editor.dom.domUtils.getComputedStyle(k,
"position");g.push(n);k.style.position="static";k=k.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);this._bakEditorContaninerWidth=d.iframe.parentNode.offsetWidth;if(this._bakAutoHeight){d.autoHeightEnabled=false;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";
window.scrollTo(0,window.scrollY);this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;d.iframe.parentNode.style.width="";this._updateFullScreen()}else{for(;k.tagName!="BODY";){k.style.position=g.shift();k=k.parentNode}this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){d.autoHeightEnabled=true;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;
document.body.style.overflow=this._bakBodyOverflow;d.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px";window.scrollTo(0,this._bakScrollTop)}if(y.gecko&&d.body.contentEditable==="true"){var p=document.createElement("input");document.body.appendChild(p);d.body.contentEditable=false;setTimeout(function(){p.focus();setTimeout(function(){d.body.contentEditable=true;d.fireEvent("fullscreenchanged",e);d.selection.getRange().moveToBookmark(j).select(true);B.editor.dom.domUtils.remove(p);
e&&window.scroll(0,0)},0)},0)}if(d.body.contentEditable==="true"){this.editor.fireEvent("fullscreenchanged",e);this.triggerLayout()}}},_updateFullScreen:function(){if(this._fullscreen){var e=c.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);c.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(e.height-
this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),true);if(y.gecko)try{window.onresize()}catch(d){}}},_updateElementPath:function(){var e=this.getDom("elementpath"),d;if(this.elementPathEnabled&&(d=this.editor.queryCommandValue("elementpath"))){for(var k=[],j=0,n;n=d[j];j++)k[j]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+j+'&quot;);">'+n+"</span>");e.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+
this.editor.getLang("elementPathTip")+": "+k.join(" &gt; ")+"</div>"}else e.style.display="none"},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="";e.style.display="none";this.elementPathEnabled=false},enableElementPath:function(){this.getDom("elementpath").style.display="";this.elementPathEnabled=true;this._updateElementPath()},_scale:function(){function e(){z=b.getXY(q);F||(F=p.options.minFrameHeight+r.offsetHeight+s.offsetHeight);u.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+
q.offsetWidth+"px;height:"+q.offsetHeight+"px;z-index:"+(p.options.zIndex+1);b.on(n,"mousemove",d);b.on(o,"mouseup",k);b.on(n,"mouseup",k)}function d(Z){j();Z=Z||window.event;M=Z.pageX||n.documentElement.scrollLeft+Z.clientX;L=Z.pageY||n.documentElement.scrollTop+Z.clientY;Q=M-z.x;S=L-z.y;if(Q>=D){x=true;u.style.width=Q+"px"}if(S>=F){x=true;u.style.height=S+"px"}}function k(){if(x){x=false;p.ui._actualFrameWidth=u.offsetWidth-2;q.style.width=p.ui._actualFrameWidth+"px";p.setHeight(u.offsetHeight-
s.offsetHeight-r.offsetHeight-2,true)}if(u)u.style.display="none";j();b.un(n,"mousemove",d);b.un(o,"mouseup",k);b.un(n,"mouseup",k)}function j(){y.ie?n.selection.clear():window.getSelection().removeAllRanges()}var n=document,p=this.editor,q=p.container,o=p.document,r=this.getDom("toolbarbox"),s=this.getDom("bottombar"),t=this.getDom("scale"),u=this.getDom("scalelayer"),x=false,z=null,F=0,D=p.options.minFrameWidth,M=0,L=0,Q=0,S=0,R=this;this.editor.addListener("fullscreenchanged",function(Z,Fa){if(Fa)R.disableScale();
else if(R.editor.options.scaleEnabled){R.enableScale();Z=R.editor.document.createElement("span");R.editor.body.appendChild(Z);R.editor.body.style.height=Math.max(b.getXY(Z).y,R.editor.iframe.offsetHeight-20)+"px";b.remove(Z)}});this.enableScale=function(){if(p.queryCommandState("source")!=1){t.style.display="";this.scaleEnabled=true;b.on(t,"mousedown",e)}};this.disableScale=function(){t.style.display="none";this.scaleEnabled=false;b.un(t,"mousedown",e)}},isFullScreen:function(){return this._fullscreen},
postRender:function(){a.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender();var d=this,k,j=B.editor.dom.domUtils,n=function(){clearTimeout(k);k=setTimeout(function(){d._updateFullScreen()})};j.on(window,"resize",n);d.addListener("destroy",function(){j.un(window,"resize",n);clearTimeout(k)})},showToolbarMsg:function(e,d){this.getDom("toolbarmsg_label").innerHTML=e;this.getDom("toolbarmsg").style.display="";if(!d)this.getDom("upload_dialog").style.display=
"none"},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();e.style.zoom=e.style.zoom=="1"?"100%":"1"}};f.inherits(h,B.editor.ui.UIBase);var l={};UE.ui.Editor=function(e){var d=new UE.Editor(e);d.options.editor=d;f.loadFile(document,{href:d.options.themePath+d.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var k=
d.render;d.render=function(j){if(j.constructor===String){d.key=j;l[j]=d}f.domReady(function(){function n(){d.setOpt({labelMap:d.options.labelMap||d.getLang("labelMap")});new h(d.options);if(j){if(j.constructor===String)j=document.getElementById(j);j&&j.getAttribute("name")&&(d.options.textarea=j.getAttribute("name"));if(j&&/script|textarea/ig.test(j.tagName)){var p=document.createElement("div");j.parentNode.insertBefore(p,j);var q=j.value||j.innerHTML;d.options.initialContent=/^[\t\r\n ]*$/.test(q)?
d.options.initialContent:q.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");j.className&&(p.className=j.className);j.style.cssText&&(p.style.cssText=j.style.cssText);if(/textarea/i.test(j.tagName)){d.textarea=j;d.textarea.style.display="none"}else j.parentNode.removeChild(j);if(j.id){p.id=j.id;b.removeAttributes(j,"id")}j=p;j.innerHTML=""}}b.addClass(j,"edui-"+d.options.theme);d.ui.render(j);p=d.options;d.container=d.ui.getDom();q=b.findParents(j,
true);for(var o=[],r=0,s;s=q[r];r++){o[r]=s.style.display;s.style.display="block"}if(p.initialFrameWidth)p.minFrameWidth=p.initialFrameWidth;else{p.minFrameWidth=p.initialFrameWidth=j.offsetWidth;r=j.style.width;if(/%$/.test(r))p.initialFrameWidth=r}if(p.initialFrameHeight)p.minFrameHeight=p.initialFrameHeight;else p.initialFrameHeight=p.minFrameHeight=j.offsetHeight;for(r=0;s=q[r];r++)s.style.display=o[r];if(j.style.height)j.style.height="";d.container.style.width=p.initialFrameWidth+(/%$/.test(p.initialFrameWidth)?
"":"px");d.container.style.zIndex=p.zIndex;k.call(d,d.ui.getDom("iframeholder"));d.fireEvent("afteruiready")}d.langIsReady?n():d.addListener("langReady",n)})};return d};UE.getEditor=function(e,d){var k=l[e];if(!k){k=l[e]=new UE.ui.Editor(d);k.render(e)}return k};UE.delEditor=function(e){var d;if(d=l[e]){d.key&&d.destroy();delete l[e]}};UE.registerUI=function(e,d,k,j){f.each(e.split(/\s+/),function(n){UE._customizeUI[n]={id:j,execFn:d,index:k}})}})();UE.registerUI("message",function(h){function f(){var l=
g.ui.getDom("toolbarbox");if(l)a.style.top=l.offsetHeight+3+"px";a.style.zIndex=Math.max(g.options.zIndex,g.iframe.style.zIndex)+1}var c=B.editor.ui.Message,a,b=[],g=h;g.addListener("ready",function(){a=document.getElementById(g.ui.id+"_message_holder");f();setTimeout(function(){f()},500)});g.addListener("showmessage",function(l,e){e=v.isString(e)?{content:e}:e;l=new c({timeout:e.timeout,type:e.type,content:e.content,keepshow:e.keepshow,editor:g});var d=e.id||"msg_"+(+new Date).toString(36);l.render(a);
b[d]=l;l.reset(e);f();return d});g.addListener("updatemessage",function(l,e,d){d=v.isString(d)?{content:d}:d;l=b[e];l.render(a);l&&l.reset(d)});g.addListener("hidemessage",function(l,e){(l=b[e])&&l.hide()})});UE.registerUI("autosave",function(h){var f=null,c=null;h.on("afterautosave",function(){clearTimeout(f);f=setTimeout(function(){c&&h.trigger("hidemessage",c);c=h.trigger("showmessage",{content:h.getLang("autosave.success"),timeout:2E3})},2E3)})})})();
